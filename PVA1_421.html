<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="NRES 421/621" />


<title>Guest lecture, PVA basics</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-1.1/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 52px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 57px;
  margin-top: -57px;
}

.section h2 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h3 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h4 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h5 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h6 {
  padding-top: 57px;
  margin-top: -57px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">NRES 470/670</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="schedule.html">Schedule</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="INTRO.html">Introduction to NRES 470</a>
    </li>
    <li>
      <a href="LECTURE1.html">A whole-systems approach to population ecology</a>
    </li>
    <li>
      <a href="LECTURE2.html">Introduction to population ecology</a>
    </li>
    <li>
      <a href="LECTURE3.html">Thomas Robert Malthus</a>
    </li>
    <li>
      <a href="LECTURE4.html">Population Regulation</a>
    </li>
    <li>
      <a href="LECTURE5.html">Passenger Pigeon</a>
    </li>
    <li>
      <a href="LECTURE6.html">Age-structured populations</a>
    </li>
    <li>
      <a href="LECTURE7.html">Matrix population models</a>
    </li>
    <li>
      <a href="LECTURE8.html">Stochastic population models</a>
    </li>
    <li>
      <a href="LECTURE9.html">Small population paradigm</a>
    </li>
    <li>
      <a href="LECTURE10.html">Individual-based models</a>
    </li>
    <li>
      <a href="LECTURE11.html">Declining population paradigm</a>
    </li>
    <li>
      <a href="LECTURE12.html">Population Viability Analysis</a>
    </li>
    <li>
      <a href="LECTURE13.html">Metapopulations</a>
    </li>
    <li>
      <a href="LECTURE14.html">PVA example: pdogs and ferrets</a>
    </li>
    <li>
      <a href="LECTURE15.html">Parameter estimation</a>
    </li>
    <li>
      <a href="LECTURE16.html">Species interactions: competition</a>
    </li>
    <li>
      <a href="LECTURE17.html">Species interactions: prey-predator</a>
    </li>
    <li>
      <a href="LECTURE18.html">Wrap-up</a>
    </li>
    <li>
      <a href="PVA1_421.html">NRES421: PVA basics</a>
    </li>
    <li>
      <a href="PVA2_421.html">NRES421: grizzly PVA</a>
    </li>
    <li>
      <a href="PVA3_421.html">NRES421: loggerhead PVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LAB1.html">Lab 1: exponential growth</a>
    </li>
    <li>
      <a href="LAB2.html">Lab 2: logistic growth</a>
    </li>
    <li>
      <a href="LAB3.html">Lab 3: age-structured population growth</a>
    </li>
    <li>
      <a href="LAB4.html">Lab 4: matrix population models</a>
    </li>
    <li>
      <a href="LAB5.html">Lab 5: stochasticity and uncertainty</a>
    </li>
    <li>
      <a href="LAB6.html">Lab 6: metapopulations</a>
    </li>
    <li>
      <a href="LAB7.html">Lab 7: capture-mark-recapture</a>
    </li>
    <li>
      <a href="Lab8_muledeer.docx">Lab 8: mule deer PVA</a>
    </li>
    <li>
      <a href="PDH_KnownFate.zip">Lab 8: mule deer MARK file</a>
    </li>
    <li>
      <a href="FINAL_PROJECTS.html">Final Projects!</a>
    </li>
    <li>
      <a href="EXTRA_CREDIT.html">Extra Credit!</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Guest lecture, PVA basics</h1>
<h4 class="author"><em>NRES 421/621</em></h4>
<h4 class="date"><em>Mar 27, 2017</em></h4>

</div>


<div id="population-viability-analysis-pva" class="section level2">
<h2>Population Viability Analysis (PVA)</h2>
<p>For the next three class periods, we will explore the use of <strong>population models</strong> to address conservation questions– a process known as <strong>population viability analysis (PVA)</strong></p>
<p>PVA is essentially a set of practical approaches to problem-solving in conservation, and wildlife management via creative application of <em>demographic theory</em>, <em>simulation models</em> and <em>statistics</em>.</p>
<p>As much as possible we will use hands-on activities to explore the fundamentals of PVA. We will use <a href="https://insightmaker.com/">InsightMaker- a free web-based systems modeling tool</a> for running simulation models.</p>
<p>First we will build a PVA for the grizzly bears of Yellowstone National Park!</p>
<div class="figure">
<img src="grizzly1.jpg" />

</div>
<p>We will end this mini-course by building a PVA for the loggerhead turtle, <em>Caretta caretta</em>, which is based on a paper by <a href="Crowder1994.pdf">Crowder et al 1994</a>.</p>
<div class="figure">
<img src="caretta1.jpg" />

</div>
<p><em>But even before any of that</em>, let’s review some basic population ecology theory and mathematics which are the foundation of PVA!</p>
</div>
<div id="what-is-a-population" class="section level2">
<h2>What is a population?</h2>
<p>From Krebs (1972):</p>
<blockquote>
<p>“A group of organisms of the same species occupying a particular space at a particular time, with the potential to breed with each other”</p>
</blockquote>
<p>From Cole (1957):</p>
<blockquote>
<p>“A biological unit at the level of ecological integration where it is meaningful to speak of birth rate, death rate, sex ratios, and age structure in describing properties or parameters of the unit.”</p>
</blockquote>
<p>From Gotelli (1998):</p>
<blockquote>
<p>“A group of plants, animals, or other organisms, all of the same species, that live together and reproduce.”</p>
</blockquote>
<p>From <a href="http://coris.noaa.gov/glossary/glossary_l_z.html">NOAA website</a>:</p>
<blockquote>
<p>“a group of individuals of the same species living in the same area at the same time and sharing a common gene pool; a group of potentially interbreeding organisms in a geographic area”</p>
</blockquote>
<p><em>Defining a population is not always straightforward…</em>. Spatial boundaries defining populations sometimes are easily defined, but more typically are vague and difficult to determine.</p>
<p>Population size, or abundance, is often represented as <span class="math inline">\(N\)</span>, and is the most basic measurement of a wild population.</p>
</div>
<div id="exponential-growth-the-fundamental-principle-of-population-ecology" class="section level2">
<h2>Exponential growth: the fundamental principle of population ecology</h2>
<div class="figure">
<img src="puffball1.png" />

</div>
<p>Giant puffballs produce 7 trillion offspring in one reproductive event.</p>
<p>… If all of those individuals reached adulthood, the descendants from just <em>two parent puffballs</em> would weigh more than the entire planet in two generations!</p>
<p>The reason? Populations grow <em>geometrically</em>, in a process called <strong>exponential growth</strong>. This is the foundational concept of population ecology, and this simple model has enormous resonance across all of ecology and evolution.</p>
</div>
<div id="mathematics-and-ecology" class="section level2">
<h2>Mathematics and Ecology</h2>
<p>“Mathematics seems to endow one with a new sense.”<br />
- Charles Darwin</p>
<p>“Like most mathematicians, he takes the hopeful biologist to the edge of the pond, points out that a good swim will help his work, and then pushes him in and leaves him to drown.”<br />
- Charles Elton, in reference to a work by Alfred Lotka</p>
<div class="figure">
<img src="1976_Elton.jpg" />

</div>
<p>“The importance of the method is this: if we know certain variables, mostly desired by ecologists and in some cases already determined by them, we can predict certain results which would not normally be predictable or even expected by ecologists. The stage of verification of these mathematical predictions has hardly begun; but their importance cannot be under-estimated.”<br />
- Charles Elton</p>
</div>
<div id="nomenclature-for-population-ecology" class="section level2">
<h2>Nomenclature for Population Ecology</h2>
<p>First of all, we need a symbol to represent population size, or <em>abundance</em>. This is <span class="math inline">\(N\)</span>, for the <span class="math inline">\(N\)</span>umber of individuals!</p>
<p><span class="math inline">\(\Delta N\)</span> represents the change in population size, <span class="math inline">\({N_{t+1}}-{N_t}\)</span></p>
<p>The famous “BIDE” equation is a way to break down <span class="math inline">\(\Delta N\)</span> into components.</p>
<div class="figure">
<img src="IM12.jpg" />

</div>
<p><span class="math inline">\(\Delta N = B + I - D - E \qquad \text{(Eq. 1)}\)</span></p>
<p>where <span class="math inline">\(B\)</span> represents the number of births, <span class="math inline">\(I\)</span> reprents the number of immigrants, <span class="math inline">\(D\)</span> represents the number of deaths, and <span class="math inline">\(E\)</span> represents the number of emigrants.</p>
<p>If we ignore immigration and emigration, then the BIDE equation simplifies to:</p>
<p><span class="math inline">\(\Delta N = B - D \qquad \text{(Eq. 2)}\)</span></p>
<p>Now let’s focus on <span class="math inline">\(B\)</span> and <span class="math inline">\(D\)</span>. The important thing to recognize is that the number of births and deaths in a population is not constant.</p>
<p>What does the number of births depend on?</p>
<p>What <strong>is</strong> more likely to be constant is the <strong>per-capita rate</strong> of producing offspring, or dying. Does this make sense? These per-capita rates are often expressed as lower case letters. So <span class="math inline">\(b\)</span> represents per-capita births, and <span class="math inline">\(d\)</span> represents per-capita deaths.</p>
<p><span class="math inline">\(b = \frac {B_t}{N_t} \qquad \text{(Eq. 3)}\)</span></p>
<p>–or–</p>
<p><span class="math inline">\(B_t = b \cdot N_t\)</span></p>
<p>The letter <span class="math inline">\(t\)</span> of course represents time, which could be years, or minutes, or decades, or whatever! So the above equation could be described as follows: “the number of births at a given time is equal to the per-capita birth rate times the total population size at that time”</p>
<p>Similarly,</p>
<p><span class="math inline">\(D_t = d \cdot N_t \qquad \text{(Eq. 4)}\)</span></p>
<p>Okay, we’re almost there.</p>
<p>If <span class="math inline">\(\Delta N = B - D \qquad \text{(Eq. 5)}\)</span></p>
<p>then</p>
<p><span class="math inline">\(\Delta N = b \cdot N_t - d \cdot N_t\qquad \text{(Eq. 6)}\)</span></p>
<p>which is equal to</p>
<p><span class="math inline">\(\Delta N = (b - d) \cdot N_t \qquad \text{(Eq. 7)}\)</span></p>
<p>which could also be written:</p>
<p><span class="math inline">\(\Delta N = r \cdot N_t\qquad \text{(Eq. 8)}\)</span></p>
<p>Where <span class="math inline">\(r\)</span> represents the difference between births and deaths. If <span class="math inline">\(r\)</span> is positive, then births are greater than deaths and the population grows. If <span class="math inline">\(r\)</span> is negative then deaths exceed births and the population declines.</p>
<p>We can use <em>calculus notation</em> to consider the instantaneous change in population size:</p>
<p><span class="math inline">\(\frac{\partial N}{\partial t} = r \cdot N \qquad \text{(Eq. 9)}\)</span></p>
<p>This simple formula represents <strong>exponential growth</strong> and is probably the <em>most fundamental equation of population ecology</em>.</p>
<p>We will have time to explore this model in a few minutes!</p>
<p>A couple more quick notes:</p>
<p>The greek symbol lambda (<span class="math inline">\(\lambda\)</span>), represents the <em>finite rate of growth</em>, or <span class="math inline">\(\frac {N_{t+1}}{N_t}\)</span>. Lambda is what you multiply the current population size by to compute the population size in the next time step.</p>
<p><span class="math inline">\(N_{t+1}=N_t + B - D \qquad \text{(Eq. 11)}\)</span></p>
<p><span class="math inline">\(N_{t+1}=N_t + b \cdot N_t - d \cdot N_t \qquad \text{(Eq. 12)}\)</span></p>
<p><span class="math inline">\(N_{t+1}=N_t + (b - d) \cdot N_t \qquad \text{(Eq. 13)}\)</span></p>
<p><span class="math inline">\(N_{t+1}=N_t + r \cdot N_t \qquad \text{(Eq. 14)}\)</span></p>
<p><span class="math inline">\(N_{t+1}=N_t \cdot (1 + r) \qquad \text{(Eq. 15)}\)</span></p>
<p><span class="math inline">\(N_{t+1}=\lambda \cdot N_t \qquad \text{(Eq. 16)}\)</span></p>
</div>
<div id="modeling" class="section level2">
<h2>Modeling!!</h2>
<div id="computer-programming-and-systems-thinking" class="section level3">
<h3>Computer programming and systems thinking</h3>
<p>Modern computers have reduced or eliminated many of the barriers to understanding how complex systems behave, and as a result <strong>specialized software and computer programming</strong> are a critical component to modern whole-systems analysis, including <strong>ecosystems</strong> analyses. Armed with basic facility with computer programming, ecologists and natural resource professionals can formalize their understanding of the natural systems in which they work, accounting for complex biological realities that may have been ignored if these tools were not available. <strong>In these three classes, we will learn to use computer simulations for understanding and managing natural populations</strong>.</p>
</div>
<div id="insightmaker-a-simulation-modeling-framework-for-dynamic-systems" class="section level3">
<h3><em>InsightMaker</em>: a simulation modeling framework for dynamic systems!</h3>
<p><a href="insightmaker.com">InsightMaker</a> is a web-based visual programming language for modeling the dynamics of inter-connected systems.</p>
<p>A <strong>dynamic system</strong> essentially consists of [Stocks] and [Flows].</p>
<p>A [Stock] represents a quantity of something. The [Stock] only changes over time ONLY via [Flows In] or [Flows Out].</p>
<p>A [Stock] of stuff increases over time via what [Flows] in. Imagine our stock represents <em>Moose</em>! <em>Moose Births</em> would then be the input [Flow] to the population of <em>Moose</em> over time.</p>
<p>A [Stock] of stuff decreases over time via what [Flows] out. For example, <em>Moose Deaths</em> could represent the [Flow] out of the population of <em>Moose</em>.</p>
<div class="figure">
<img src="IM13.jpg" />

</div>
<p>If the [Flow] in is larger than the [Flow] out then the [Stock] increases over time.</p>
<p>If the [Flow] out is larger than the [Flow] in then the [Stock] decreases over time.</p>
<p>If the [Flow] in equals the [Flow] out then the amount in the [Stock] will not change over time.</p>
</div>
</div>
<div id="in-class-activity-constructing-a-basic-population-simulation-model" class="section level2">
<h2>In-class activity: constructing a basic population simulation model</h2>
<div id="simple-stock-and-flow-model" class="section level3">
<h3>Simple stock and flow model!</h3>
<ol style="list-style-type: decimal">
<li><p>Open up <a href="https://insightmaker.com/">InsightMaker</a>. If you have never used it before you need to sign up first with a username and password. <em>InsightMaker is free!</em></p></li>
<li><p>Create a new “Insight” and clear the demo model.</p></li>
<li><p>Right click in the center of the screen and select <strong>Create Stock</strong> from the pop-up. Notice that the name is <em>New Stock</em> and is selected. Type in a name for what this is an accumulation of (e.g., “Moose”!). Note the <strong>Configuration Panel</strong> on the right - where you can alter the settings for your [Stock]. In the configuration panel, set the <em>Initial Value</em> to 50. That is, there will be 50 moose at the start of the simulation!</p></li>
<li><p>Select [Flow] in the upper left corner of your screen under [Connections]. Now notice that when you mouse over the [Stock] a small right-arrow displays. Click on the right-arrow and drag a couple inches to the left of the [Stock] and release. This is how you create a [Flow] out of a [Stock]. To create a [Flow] into a [Stock] click the <strong>Reverse</strong> button in the <strong>Connections</strong> menu. Please do that now. You can name the [Flow] as you wish (e.g., “Births”!). Also in the <strong>Configuration Panel</strong> set <strong>Flow Rate</strong> equal to 1.</p></li>
<li><p>Now click <strong>Run Simulation</strong> and you have just finished your first simulation model!!</p></li>
<li><p>Can you figure out how to change the settings to run the model for 50 years? Try this and click <strong>Run Simulation</strong>.</p></li>
<li><p>Use the same methods as <em>step 4</em> to create a [Flow Out], representing moose deaths. Set the death rate to 1 moose per year. Re-run the model. Is the population increasing or declining? Why?</p></li>
<li><p>Change the <strong>Configuration Panel</strong> for the [Stock] and for the [Flow In] and [Flow Out] so that “Show Value Slider” is set to “Yes”. You can change the model parameterization easily using these sliders. Try it a couple times, re-running the simulation after each change.</p></li>
</ol>
<p><strong>Q</strong>: Is this Moose model realistic? What is the first thing you would like to change to make the model more realistic?</p>
</div>
</div>
<div id="a-more-realistic-model" class="section level2">
<h2>A more realistic model!</h2>
<p>Now let’s consider <em>per-capita</em> rates of birth and death in the population. This way, if the population is bigger, the total births will increase!</p>
<ol start="9" style="list-style-type: decimal">
<li><p>To create a variable to store per-capita vital rates (per-capita birth and death rate), right-click on the canvas and select <strong>Variable</strong> from the drop-down. While the [Variable] is still selected rename it (per-capita) <em>birth rate</em>. Open the [Equation] window for <em>birth rate</em> and set it to 0.5 (if you mouse over <em>Stock</em> or <em>Flow</em> a small [<span class="math inline">\(=\)</span> Sign] will appear. If you click this it will open the <strong>Equation</strong> window where you can set values.</p></li>
<li><p>Now draw a [Link] from <em>birth rate</em> to the “Births” [Flow]. In InsightMaker, flow of information is represented by a [Link]. To create a [Link], click <strong>Link</strong> in the <strong>Connections</strong> part of the toolbar. When you mouse over the <em>birth rate</em> click on the right-arrow, drag to the [Flow] and release. You now have a [Link] on top of the [Flow]. Now hold the Shift Key and click in the middle of the [Link] and a little little green node will be created on the [Link]. You can select this node and drag it to make a visually pleasing curved line!</p></li>
</ol>
<p>Your model should look something like this:</p>
<div class="figure">
<img src="IM14.jpg" />

</div>
<ol start="11" style="list-style-type: decimal">
<li>Open the <em>Equation editor window</em> for the [Flow] and set it to [Moose] times [birth rate]. To make sure you don’t make any spelling errors, it’s best to click on the variables you want in the right-hand panel of the equation editor. The equation in the equation editor window should look like this:</li>
</ol>
<pre><code>[Moose]*[Birth rate]</code></pre>
<p>That is, the rate of inflow into the [Moose] stock is equal to the total number of moose multiplied by the per-capita birth rate.</p>
<ol start="12" style="list-style-type: decimal">
<li><p>For the [Moose], [Birth rate], and [Death rate], open the configuration panel and set “Show Value Slider” to “Yes”. Set the “Slider Max” to 100 for moose, and 1 for birth and death rate. Make sure the number of moose is set to 50, the birth rate is set to 0.5, and the death rate is set to 0.4.</p></li>
<li><p>Now click [Run Simulation]. How would you describe the results?</p></li>
</ol>
<p>NOTE: If you are running into difficulties, you can always use <a href="https://insightmaker.com/insight/76064/ICE-stocks-and-flows">this working model</a>. Click on this link and then click “Clone Insight” in the top right corner of your screen. This will create a copy of the Insight that you can change as you wish!</p>
<p><strong>Q</strong>: what happens if you set the birth rate equal to the death rate?</p>
<p><strong>Q</strong>: what happens if you set the birth rate less than the death rate?</p>
<p><strong>Q</strong>: is this model realistic? What is the next thing you would like to change in this model?</p>
</div>
<div id="an-even-more-realistic-model" class="section level2">
<h2>An even more realistic model!!</h2>
<div id="uncertainty" class="section level3">
<h3>Uncertainty!</h3>
<p>Which one of these figures is most likely to be from a real wildlife population??</p>
<div class="figure">
<img src="fluct1.jpg" />

</div>
<p>OR</p>
<div class="figure">
<img src="nofluct1.jpg" />

</div>
</div>
<div id="wildlife-populations-fluctuate-over-time" class="section level3">
<h3>Wildlife populations fluctuate over time!</h3>
<p>… And these fluctuations are often difficult to predict!</p>
<p>That is to say…</p>
</div>
<div id="the-future-is-uncertain" class="section level3">
<h3>The future is uncertain!</h3>
<p>All ecological systems are full of uncertainty. We all know it intuitively. But what <em>exactly</em> do we mean by that? And how can we deal with it? How can we incorporate it into our models?</p>
<p><strong>Q</strong>: if you were to re-run the basic population model you just made in InsightMaker ten times, how many different results would you get?</p>
<p>When a model outcome is the same every time (when starting with the same input values) we say that the model is <strong>deterministic</strong>.</p>
<p>BUT… ecological systems (e.g., dynamic populations) have inherent variability that is often <em>not predictable</em>.</p>
<p>We can’t predict with certainty whether or not an individual will mate, or die.</p>
<p>We can’t be certain whether next year or the year after that will be a good year or a bad year for offspring production or mortality!</p>
<p>The key is to <strong>embrace uncertainty</strong>. As population ecologists, we have some tricks to help us manage and account for unpredictable variation in our study systems:</p>
</div>
<div id="how-to-model-uncertainty" class="section level3">
<h3>How to model uncertainty</h3>
<p>When we incorporate <strong>random processes</strong> into models, the result can be different each time we run the model!</p>
<p>These are called <strong>stochastic models</strong>.</p>
<p>When we use stochastic models, we often want to run lots of <strong>replicates</strong>. Each replicate represents a possible future.</p>
<p>We can then interpret the <em>cloud of possible futures</em> rather than just the results from a single model run!</p>
<div class="figure">
<img src="IM15.jpg" />

</div>
<p>Here we see that the population went extinct in three replicates, out of a total of 50 replicates.</p>
<p><strong>Q</strong>: What is the extinction risk for this population?</p>
<div id="demographic-stochasticity" class="section level4">
<h4>Demographic stochasticity</h4>
<p>When it comes to projecting who lives and dies, who gives birth and who doesn’t, how many females are born to each individual in the population, we <em>just can’t know that for sure</em>.</p>
<p>In other words, we can’t know whether an <em>individual</em> will be “lucky” or “unlucky” so to speak!</p>
<p>In population ecology this is called <strong>demographic stochasticity</strong>.</p>
</div>
<div id="environmental-stochasticity" class="section level4">
<h4>Environmental Stochasticity</h4>
<p>We usually can’t predict whether next year or the year after will be a good one or a bad one for a <em>population</em>- that is, we don’t know whether the per-capita vital rates (e.g., <span class="math inline">\(b\)</span>, or <span class="math inline">\(d\)</span>) will be more or less optimal year-to-year</p>
<p>In other words, we can’t know whether a <em>population</em> will be “lucky” or “unlucky”, so to speak!</p>
<p>In population ecology this is called <strong>environmental stochasticity</strong>.</p>
<div class="figure">
<img src="dice1.png" />

</div>
</div>
</div>
</div>
<div id="random-number-generation" class="section level2">
<h2>Random number generation</h2>
<p>To ensure that each model run (replicate) – or each year of each model run – is different from one another, we can include at least one <strong>random number generator</strong> in our models!</p>
<p>A random number generator is like a box of (potentially infinite) possible numbers – a lottery ball machine for example! Each time we want a new number we reach in and pull one out, record the number, put it back in and shake it up again.</p>
<div class="figure">
<img src="lottery1.png" />

</div>
<p>Every random-number generator has a <strong>distribution</strong>. This is a way of defining what exactly is in the box. For example, the box might have 10 “ones”, 5 “twos”, and 2 “threes”. In this case the distribution looks like this (<em>probability</em> of each <em>possibility</em>):</p>
<p><img src="PVA1_421_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>A probability distribution can be pretty much anything you want it to be. However, there are several key distributions that come up again and again in nature, and we should know them, because they end up being major building blocks of PVA!</p>
<div id="common-probability-distributions" class="section level3">
<h3>Common probability distributions</h3>
<div id="binomial-distribution" class="section level4">
<h4>Binomial distribution</h4>
<p>Consider the probability of flipping a coin 10 times and getting 4 heads. This quantity would follow a <em>binomial distribution</em></p>
<p><img src="PVA1_421_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
<div id="poisson-distribution" class="section level4">
<h4>Poisson distribution</h4>
<p>Another discrete distribution we will use in this PVA mini-course is the <em>Poisson distribution</em>:</p>
<p><img src="PVA1_421_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p><strong>Q</strong> What population parameter might this distribution be useful for modeling?</p>
</div>
<div id="uniform-distribution" class="section level4">
<h4>Uniform distribution</h4>
<p>In <em>continuous distributions</em>, there is an infinite set of possibilities in our random-number box between any upper and lower bound.</p>
<p>Let’s consider the <em>uniform distribution</em>:</p>
<pre class="r"><code>lower = 0
upper = 10

curve(dunif(x,lower,upper),0,10,ylab=&quot;Probability (density)&quot;,xlab=&quot;Possibilities&quot;,main=&quot;Uniform distribution (continuous)&quot;,ylim=c(0,1))   # probability density</code></pre>
<p><img src="PVA1_421_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>This isn’t a very intersting looking distribution. All possible numbers from 0 to 10 are equally probable.</p>
</div>
<div id="normal-distribution" class="section level4">
<h4>Normal distribution</h4>
<p>Another continuous distribution you should know is called the <em>Normal distribution</em>. This distribution has a lower bound of <span class="math inline">\(-\infty\)</span> and an upper bound of <span class="math inline">\(\infty\)</span>.</p>
<p><strong>Q</strong> What population parameter might this distribution be useful for modeling?</p>
<pre class="r"><code>mean = 7.1
stdev = 1.9

curve(dnorm(x,mean,stdev),0,15,ylab=&quot;Probability (density)&quot;,xlab=&quot;Possibilities&quot;,main=&quot;Normal distribution (continuous)&quot;)   # probability density</code></pre>
<p><img src="PVA1_421_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
</div>
<div id="return-to-insightmaker" class="section level3">
<h3>Return to InsightMaker!</h3>
<ol style="list-style-type: decimal">
<li>Return to your Moose model (hopefully you saved it from last time!). Set <em>Birth rate</em> back to 0.5 and <em>Death rate</em> back to 0.4. Set initial abundance back to 50. Under the “Settings” menu set the model to run for 10 years.</li>
</ol>
<p>Make sure your <em>Population</em> stock can NOT go negative (this is a setting in the configurations panel: Allow Negatives = “No”). Hit “Simulate”- you should see <em>exponential growth</em>!</p>
<div id="add-demographic-stochasticity" class="section level4">
<h4>Add <em>Demographic Stochasticity</em></h4>
<ol start="2" style="list-style-type: decimal">
<li>We will use a <em>Binomial distribution</em> to represent the number of mortalities. That is, we <em>flip a coin the same number of times as there are individuals in the population</em>. If the coin comes up heads, then the individual dies. In this case we are using a biased coin- it only comes up heads 40% of the time! Each random draw from the <em>Binomial distribution</em> essentially represents the number of times heads came up (or the number of times mortality occurred).</li>
</ol>
<p>To do this in InsightMaker, open the equation window for the <em>Deaths</em> flow, and use the following formula to define the total number of deaths in the population each year:</p>
<pre><code>RandBinomial([Population], [Death rate])</code></pre>
<p>For the total births, <span class="math inline">\(B\)</span> we will use the <em>Poisson</em> distribution. The Poisson distribution is often use to represent births, because there could feasibly be more births than there are individuals currently in the population (e.g., if all individuals have two offspring!). This would not be possible with a binomial distribution! That is, the maximum number of “heads” (you can always think of binomial distributions as coin-flipping!) is the total number of individuals, period.</p>
<p>To do this in InsightMaker, use the following formula for the <em>Births</em> flow:</p>
<pre><code>RandPoisson([Population]*[Birth rate])</code></pre>
<p>If you’re having trouble, you can clone a working model <a href="https://insightmaker.com/insight/76072/ICE-demographic-stochasticity">here</a></p>
<ol start="3" style="list-style-type: decimal">
<li><p>Run the simulation. What does it look like?</p></li>
<li><p>Use the “Sensitivity Testing” tool (in the “Tools” menu, upper right corner) to run the model 50 times. Choose [Population] as the “Monitored Primitive”. View the results!</p></li>
<li><p>Change the initial abundance to 500 and re-run the “Sensitivity Testing” tool.</p></li>
<li><p>Change the initial abundance to 10 and re-run the “Sensitivity Testing” tool.</p></li>
</ol>
<p><strong>Q</strong> Is the effect of <em>demographic stochasticity</em> bigger at low or high abundances?</p>
<p><strong>Q</strong> Is there any risk of extinction in this population?</p>
<p><strong>Q</strong> In this model, did the <em>population vital rates</em> change at all? If not, why does it look different each time we run the model?</p>
</div>
<div id="add-environmental-stochasticity" class="section level4">
<h4>Add <em>Environmental Stochasticity</em></h4>
<ol style="list-style-type: decimal">
<li>For now, set <em>Births</em> back to what it was before:</li>
</ol>
<pre><code>[Moose]*[Birth rate]</code></pre>
<p>And do the same for <em>Deaths</em>!</p>
<pre><code>[Moose]*[Death rate]</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>We will use a <em>Normal distribution</em> to represent how the birth rate changes each year. This could represent climatic variablity – “good years” and “bad years”. The <em>Normal distribution</em> is commonly used for this type of variability- it is characterized by an average value (<strong>mean</strong>) and a variability measure (<strong>standard deviation</strong>). To do this in InsightMaker, use the following formula for the <em>Birth Rate</em> variable:</li>
</ol>
<pre><code>RandNormal(0.4, 0.4)</code></pre>
<p>Similarly, use the following formula for the <em>Death Rate</em> variable:</p>
<pre><code>RandNormal(0.3, 0.3)</code></pre>
<ol start="3" style="list-style-type: decimal">
<li><p>Use the “Sensitivity Testing” tool (in the “Tools” menu, upper right corner) to run the model 50 times. Choose [Population] as the “Monitored Primitive”.</p></li>
<li><p>Change the initial abundance to 500 and re-run the “Sensitivity Testing” tool.</p></li>
<li><p>Note that the normal distribution CAN go below zero or above 1, which is often NOT biologically realistic! Let’s <strong>truncate</strong> the normal distribution to behave more realistically. That is, if the random number you draw comes out less than zero, just set it to zero!</p></li>
</ol>
<p>For <em>birth rate</em>, this can be done like this:</p>
<pre><code>Max(0,RandNormal(0.4, 0.4))</code></pre>
<p>This forces birth rates to always be greater than or equal to zero.</p>
<p>For <em>death rate</em>, this can be done like this:</p>
<pre><code>Min(1,Max(0,RandNormal(0.3, 0.3)))</code></pre>
<p>This forces death rates to always be greater than or equal to zero.</p>
<p>Re-run the model with the modified/constrained random vital rates.</p>
<p>If you’re having trouble, you can clone a working model <a href="https://insightmaker.com/insight/77054/ICE-environmental-stochasticity">here</a></p>
<p><strong>Q</strong> Is the effect of <em>environmental stochasticity</em> bigger at low or high abundances?</p>
<p><strong>Q</strong> Under what circumstances can you envision small populations being more vulnerable to environmental stochasticity than large populations?</p>
</div>
</div>
</div>
<div id="population-viability-analysis-pva-1" class="section level2">
<h2>Population Viability Analysis (PVA)</h2>
<p>Before we move on do run some real PVA analysis, let’s return to the topic of this mini-course: PVA.</p>
<p>Population Viability Analysis (PVA) is the <em>process of building and running a formal predictive population models for the purpose of gaining insight about present and future conservation status, or ranking alternative management options</em>.</p>
<div id="what-are-some-questions-you-can-address-with-pva" class="section level3">
<h3>What are some questions you can address with PVA?</h3>
<p>In general, we are interested in evaluating population-level risk under various <strong>scenarios</strong>. These scenarios could involve population size, different vital rates, or specific sources of mortality.</p>
<p>We are often interested in evaluating the factors that threaten the present or future viability of a population.</p>
<p>Just like population models, population threats can be classified as either deterministic or stochastic.</p>
</div>
<div id="deterministic-threats" class="section level3">
<h3>Deterministic threats</h3>
<p><img src="Fragmentation1.jpg" /> <img src="harvest1.jpg" /></p>
<p>What is the population-level impact of the following?</p>
<ul>
<li>Habitat fragmentation?</li>
<li>Habitat degradation or loss?</li>
<li>Direct Harvest?</li>
<li>Exotic invasive species?</li>
<li>Environmental toxins?</li>
</ul>
</div>
<div id="stochastic-threats" class="section level3">
<h3>Stochastic threats</h3>
<p>What is the population-level impact of the following?</p>
<ul>
<li>Demographic stochasticity?</li>
<li>Environmental stochasticity?</li>
<li>Catastrophes?</li>
<li>Loss of genetic diversity?</li>
</ul>
<p><strong>Q</strong>: which is more likely to cause a large population to become small: stochastic threas or deterministic threats?</p>
<p><strong>Q</strong>: can you match the above concepts with the two paradigms of conservation biology: the <em>small-population paradigm</em> and the <em>declining-population paradigm</em>?</p>
</div>
</div>
<div id="the-pva-process-recipe-for-pva" class="section level2">
<h2>The PVA process (recipe for PVA!)</h2>
<div class="figure">
<img src="PVAschematic1.png" />

</div>
<p>NOTE: The process of building a PVA model is <strong>iterative</strong> and <strong>non-linear</strong>.</p>
<p>For example – after running your model (step 4) you might realize that your results (step 5) are totally unrealistic. This might prompt you to go back and change your conceptual model of the life history (step 1), and re-parameterize your model (step 2).</p>
<div id="step-1-life-history" class="section level3">
<h3>Step 1: Life history</h3>
<p><em>How does your population work?</em></p>
<p>The first step is to conceptualize the life history for your species of interest. This can be done by visualized in a <em>life history diagram</em> (essentially and stock-and-flow diagram just like we have already been doing!), and think about the following questions:</p>
<ul>
<li>What is the maximum age?</li>
<li>At what age do individuals start reproducing?</li>
<li>Is it important to include males??</li>
</ul>
<p><strong>Q</strong>: Why do most population models ignore males??</p>
</div>
<div id="step-2-parameterize-the-demographic-model" class="section level3">
<h3>Step 2: Parameterize the demographic model!</h3>
<p>This is where you attach <em>real numbers</em> to the stocks and flows in your conceptual life history diagram!</p>
</div>
<div id="step-3-spatial-structure" class="section level3">
<h3>Step 3: Spatial structure!</h3>
<p>If you want to ask spatial questions, your model needs to be spatially explicit, or at least consider spatial structure in some way. The kinds of questions you might think about include:</p>
<ul>
<li>How many discrete populations?</li>
<li>At what rate do individuals move among these populations?</li>
</ul>
<p>For the grizzly bear and loggerhead examples, we will not consider spatial structure!</p>
</div>
<div id="step-4-simulate" class="section level3">
<h3>Step 4: Simulate!</h3>
<p>You have already simulated simple population dynamics!</p>
<p>There are lots of options for simulation software- R, <a href="https://insightmaker.com/">InsightMaker</a>, <a href="http://www.vortex10.org/Vortex10.aspx">Vortex</a>, <a href="http://www.ramas.com/metapop">Ramas</a>, and much more!</p>
<p>What <em>scenarios</em> do you want to test in order to test your original questions?</p>
</div>
<div id="step-5-results" class="section level3">
<h3>Step 5: Results</h3>
<p>Finally, you need to make sense of all the simulations you just ran!</p>
<p>There are two types of data analysis tools that you will need to be able to use the simulation results to answer your questions: <strong>graphical visualization</strong> and <strong>statistical analysis</strong>.</p>
<p>Before we get into the PVA examples, let’s just step back and look at the final stage of the PVA process- visualizing results and making conclusions.</p>
<p>This is, after all, why we do PVA in the first place!!</p>
</div>
</div>
<div id="a-simple-demonstration-pva" class="section level2">
<h2>A Simple Demonstration PVA</h2>
<p>To illustrate some of these concepts, let’s build ourselves a very simple PVA model in R.</p>
<p>For this demo I’m using the <em>“R” programming language</em> because of its flexible and powerful visualization tools. You can download R for yourself from <a href="https://cran.r-project.org/">this website</a>:</p>
<p>For simplicity, let’s ignore age structure - that is, let’s build a <em>scalar</em> PVA model.</p>
<p>Also let’s ignore parameter uncertainty for now.</p>
<p>Here is the basic model parameterization:</p>
<pre class="r"><code>####
# Basic simulation parameters
####

nyears &lt;- 100     # number of years
nreps &lt;- 500      # number of replicates

####
# Basic life history parameters
####

R_max &lt;- 1.03       # Maximum rate of growth (max lambda)
Init_N &lt;- 51        # Initial abundance
K &lt;- 175            # Carrying capacity

####
# Environmental stochasticity
####

SD_lambda &lt;- 0.11  # standard deviation of lambda

####
# Density-dependence (Ricker model)
####

Ricker &lt;- function(prev_abund){       # this is a function for computing next-year abundance -- includes env stochasticity
  prev_abund * exp(log(rnorm(1,R_max,SD_lambda))*(1-(prev_abund/K)))
}

####
# Catastrophe
####

Flood_prob &lt;- 0.0     # 0% chance of major flood
Flood_lambda &lt;- 0.25    # 25% of population can survive a flood, should it occur!</code></pre>
<p>Now we can use these parameters to build a simple PVA model:</p>
<pre class="r"><code>## Set up data structures to store simulation results!

PVAdemo &lt;- function(nreps,nyears,Init_N,R_max,K,Flood_prob,Flood_lambda){
  #browser()
  PopArray2 &lt;- array(0,dim=c((nyears+1),nreps))
  
  ## start looping through replicates
  
  for(rep in 1:nreps){
    
    # set initial abundance
    PopArray2[1,rep] &lt;- Init_N     # initial abundance
    
    ### loop through years
    for(y in 2:(nyears+1)){
      ### stochasticity and d-d
      nextyear &lt;- max(0,trunc(Ricker(PopArray2[y-1,rep])))
      
      ### catastrophe
      if(runif(1)&lt;Flood_prob) nextyear &lt;- nextyear*Flood_lambda
      PopArray2[y,rep] &lt;- nextyear 
    }
  }
  
  return(PopArray2)
}

### Run the PVA!

Default &lt;- PVAdemo(nreps,nyears,Init_N,R_max,K,Flood_prob,Flood_lambda)</code></pre>
<div id="graphical-visualization" class="section level3">
<h3>Graphical visualization</h3>
<p>There are several types of visualizations that you might want to use for your PVA models:</p>
<p>The first is to look at the “cloud” of abundance trajectories. This is the same type of figure we have seen in InsightMaker using the “Sensitivity testing” tool.</p>
<pre class="r"><code>PlotCloud &lt;- function(simdata){
  plot(c(1:101),simdata[,1],col=gray(0.7),type=&quot;l&quot;,ylim=c(0,max(simdata)),xlab=&quot;Years&quot;,ylab=&quot;Abundance&quot;)
  
  for(r in 2:ncol(simdata)){
    lines(c(1:101),simdata[,r],col=gray(0.7),type=&quot;l&quot;)
  }
}

PlotCloud(Default)</code></pre>
<p><img src="PVA1_421_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Okay, what do we learn from this? Really, it’s a mess!!!</p>
<p>If our question is about extinction risk, maybe we want to plot extinction risk by time…</p>
<pre class="r"><code>Extinction_byyear &lt;- function(simdata){
  apply(simdata,1,function(t)  length(which(t==0)))/ncol(simdata)
}

plot(c(1:101),Extinction_byyear(Default),type=&quot;l&quot;,lwd=2,xlab=&quot;year&quot;,ylab=&quot;extinction risk&quot;)
abline(h=0.05,col=&quot;red&quot;,lwd=2)</code></pre>
<p><img src="PVA1_421_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Maybe our question is about the probability of decline over 100 years …</p>
<p>In that case maybe we should present a histogram of final abundances…</p>
<pre class="r"><code>hist(Default[nrow(Default),],xlab=&quot;Final abundance after 100 years&quot;,ylab=&quot;Number of replicates&quot;,main=&quot;&quot;)
abline(v=Init_N,col=&quot;green&quot;,lwd=2)</code></pre>
<p><img src="PVA1_421_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>We could compute the probability of decline by computing <span class="math inline">\(\frac{number.declined}{total.simulations}\)</span></p>
<pre class="r"><code>prob_decline &lt;- round(length(which(Default[nrow(Default),]&lt;Init_N))/ncol(Default),2)
cat(&quot;the probability of decline is: &quot;, prob_decline)</code></pre>
<pre><code>## the probability of decline is:  0.15</code></pre>
<p>What if our question is about the effect of flooding on extinction risk?</p>
<p>Let’s imagine that the probability of flooding is not expected to change with climate change, but that the intensity of the flood damage is likely to increase substantially!</p>
<p>Currently, floods generally result in a 10% population reduction. But climate change could increase this number to as much as 90%. Let’s look at how much this could increase extinction risk!</p>
<pre class="r"><code>Flood_prob &lt;- 0.1     # 10% chance of major flood

Exctinction_risk &lt;- function(simdata){
  length(which(simdata[nrow(simdata),]==0))/ncol(simdata)
}

flood_lambdas &lt;- seq(0.9,0.1,by=-0.05)

all_scenarios &lt;- numeric(length(flood_lambdas))
for(scenario in 1:length(flood_lambdas)){
  PVA &lt;- PVAdemo(nreps,nyears,Init_N,R_max,K,Flood_prob,flood_lambdas[scenario])
  all_scenarios[scenario] &lt;- Exctinction_risk(PVA)
}

plot(flood_lambdas,all_scenarios,type=&quot;p&quot;,cex=2,xlab=&quot;flood impact (lambda in flood year)&quot;,ylab=&quot;extinction risk&quot;)
abline(h=0.05,col=&quot;red&quot;,lwd=2)</code></pre>
<p><img src="PVA1_421_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
</div>
<div id="aside-matrix-population-models" class="section level2">
<h2>ASIDE: matrix population models:</h2>
<p>We can present yearly fecundity and survival probabilities compactly in a <strong>projection matrix</strong> [A] which we use to project the population size year to year.</p>
<p>We all remember the finite-population-growth equation:</p>
<p><span class="math inline">\(N_{t+1}=\lambda \cdot N_t \qquad \text{(Eq. 1)}\)</span>,</p>
<p>where <span class="math inline">\(N\)</span> is abundance (as always), <span class="math inline">\(t\)</span> is time, often in years but could be any time units, and <span class="math inline">\(\lambda\)</span> is the multipicative growth rate over the time period <span class="math inline">\(t \rightarrow t+1\)</span></p>
<p>The matrix population growth equation looks pretty much the same!</p>
<p><span class="math inline">\(\mathbf{N}_{t+1} = \mathbf{A} \cdot \mathbf{N}_{t} \qquad \text{(Eq. 2)}\)</span>,</p>
<p>where <span class="math inline">\(\mathbf{N}\)</span> is a <strong>vector</strong> of abundances (abundance for all stages), and <span class="math inline">\(\mathbf{A}\)</span> is the <strong>transition matrix</strong>, which we have seen before.</p>
<p>We can be more explicit about this if we re-write the above equation this way:</p>
<p><span class="math inline">\(\begin{bmatrix}N_1\\ N_2\\N_3 \end{bmatrix}_{t+1}=\begin{bmatrix}0 &amp; F_2 &amp; F_3\\ P_{1 \rightarrow 2} &amp; P_{2 \rightarrow 2} &amp; 0\\ 0 &amp; P_{2 \rightarrow 3} &amp; P_{3 \rightarrow 3}\end{bmatrix} \cdot \begin{bmatrix}N_1\\ N_2\\N_3 \end{bmatrix}_{t} \qquad \text{(Eq. 3)}\)</span></p>
<p>Where <span class="math inline">\(P_{1 \rightarrow 2}\)</span> is the probability of advancing from stage 1 to 2, and <span class="math inline">\(F_2\)</span> is the <strong>fecundity</strong> of stage 2.</p>
<p>There are three important types of transitions.</p>
<ul>
<li><span class="math inline">\(F_i\)</span> = Fecundities, or the number of new turtles (hatchlings) produced by an average individual of size-class <em>i</em> per year. This is the top row of the transition matrix.</li>
<li><span class="math inline">\(S_i\)</span> = Stage Survival, or fraction of size <em>i</em> turtles surviving and staying in the same size-class per year. These are the diagonal elements of the matrix</li>
<li><span class="math inline">\(G_i\)</span> = fraction of size <em>i</em> turtles surviving and growing to size-class <em>i + 1</em> per year. These are the subdiagonal elements of the matrix.</li>
</ul>
<p>NOTE: <em>fecundity is NOT the same thing as birth rate</em>, <span class="math inline">\(b\)</span>. What’s the difference?</p>
<p>Birth rate, <span class="math inline">\(b_t\)</span>, is the <em>per-capita rate of offspring production</em> for stage <span class="math inline">\(t\)</span></p>
<p>Fecundity, <span class="math inline">\(F_t\)</span>, is the _per-capita rate by which an individual of stage <span class="math inline">\(t\)</span> contributes new offspring to the population at time <span class="math inline">\(t+1\)</span>. Sounds pretty similar, right? What’s the difference??</p>
<p>Fecundity also takes into account the survival rate from <span class="math inline">\(t\)</span> to <span class="math inline">\(t+1\)</span>!! For an adult of stage <span class="math inline">\(t\)</span> to contribute to the next generation, <em>it must both survive and reproduce</em>!.</p>
<p><span class="math inline">\(F_t = P_{1 \rightarrow 2} \cdot b_{t+1} \qquad \text{(Eq. 4)}\)</span></p>
<p>There is a lot we can do with matrix population models. The most obvious one is <em>projection</em>:</p>
<div id="projection" class="section level3">
<h3>Projection:</h3>
<p>We have already seen the projection equation (<em>Eq. 2</em>, above). Here is how we can implement this in R:</p>
<pre class="r"><code>Year1 &lt;- projection_matrix %*% Abundance_year0  # matrix multiplication!</code></pre>
<p>Let’s try it!:</p>
<p>First, let’s build a <em>projection matrix</em>:</p>
<pre class="r"><code>projection_matrix &lt;- matrix(
  c(
    0,     1.2,   3.1,
    0.4,   0,     0,
    0,     0.75,   0
  )
  ,nrow=3,ncol=3,byrow=T
)

projection_matrix</code></pre>
<pre><code>##      [,1] [,2] [,3]
## [1,]  0.0 1.20  3.1
## [2,]  0.4 0.00  0.0
## [3,]  0.0 0.75  0.0</code></pre>
<p>Next, let’s build an initial abundance vector:</p>
<pre class="r"><code>Abundance_year0 &lt;- c(1000,0,0)
Abundance_year0</code></pre>
<pre><code>## [1] 1000    0    0</code></pre>
<p>Now we can run the code for real!</p>
<pre class="r"><code>Year1 &lt;- projection_matrix %*% Abundance_year0  # matrix multiplication!
Year1</code></pre>
<pre><code>##      [,1]
## [1,]    0
## [2,]  400
## [3,]    0</code></pre>
<p>Now we have 300 individuals in stage 2!</p>
<p>Let’s project one more year:</p>
<pre class="r"><code>Year2 &lt;- projection_matrix %*% Year1  # matrix multiplication!
Year2</code></pre>
<pre><code>##      [,1]
## [1,]  480
## [2,]    0
## [3,]  300</code></pre>
<p>Here is some R code to project many years into the future!</p>
<pre class="r"><code>nYears &lt;- 20                                            # set the number of years to project
TMat &lt;- projection_matrix                               # define the projection matrix
InitAbund &lt;- Abundance_year0                            # define the initial abundance

  ## NOTE: the code below can be re-used without modification:
allYears &lt;- matrix(0,nrow=nrow(TMat),ncol=nYears+1)     # build a storage array for all abundances!
allYears[,1] &lt;- InitAbund  # set the year 0 abundance                                    
for(t in 2:(nYears+1)){   # loop through all years
  allYears[,t] &lt;-  TMat %*% allYears[,t-1]
}
plot(1,1,pch=&quot;&quot;,ylim=c(0,max(allYears)),xlim=c(0,nYears+1),xlab=&quot;Years&quot;,ylab=&quot;Abundance&quot;,xaxt=&quot;n&quot;)  # set up blank plot
cols &lt;- rainbow(3)    # set up colors to use
for(s in 1:3){
  points(allYears[s,],col=cols[s],type=&quot;l&quot;,lwd=2)     # plot out each life stage abundance, one at a time
}
axis(1,at=seq(1,nYears+1),labels = seq(0,nYears))   # label the axis
legend(&quot;topleft&quot;,col=cols,lwd=rep(2,3),legend=paste(&quot;Stage &quot;,seq(1:nrow(TMat))))  # put a legend on the plot</code></pre>
<p><img src="PVA1_421_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p><a href="PVA2_421.html">–go to grizzly PVA!–</a></p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
