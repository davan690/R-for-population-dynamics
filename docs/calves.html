<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Calving interval example | Introduction to R for Population dynamics</title>
  <meta name="description" content="This is a first course in R programming for natural resource scientists. It was developed and has been primarily instructed at Auburn University." />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Calving interval example | Introduction to R for Population dynamics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a first course in R programming for natural resource scientists. It was developed and has been primarily instructed at Auburn University." />
  <meta name="github-repo" content="bstaton1/au-r-workshop" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Calving interval example | Introduction to R for Population dynamics" />
  
  <meta name="twitter:description" content="This is a first course in R programming for natural resource scientists. It was developed and has been primarily instructed at Auburn University." />
  

<meta name="author" content="Anthony Davidson" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch4.html"/>
<link rel="next" href="ch6.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Intro to R for Nat. Res. Sci.</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-is-covered"><i class="fa fa-check"></i>What is Covered?</a></li>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#external-resources"><i class="fa fa-check"></i><b>0.1</b> External Resources</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="ch4.html"><a href="ch4.html"><i class="fa fa-check"></i><b>1</b> Monte Carlo Methods</a><ul>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#chapter-overview"><i class="fa fa-check"></i>Chapter Overview</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#before-you-begin"><i class="fa fa-check"></i>Before You Begin</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#layout-of-this-chapter"><i class="fa fa-check"></i>Layout of This Chapter</a></li>
<li class="chapter" data-level="1.1" data-path="ch4.html"><a href="ch4.html#randomness"><i class="fa fa-check"></i><b>1.1</b> Introducing Randomness</a><ul>
<li class="chapter" data-level="1.1.1" data-path="ch4.html"><a href="ch4.html#random-deviates"><i class="fa fa-check"></i><b>1.1.1</b> Random deviates</a></li>
<li class="chapter" data-level="1.1.2" data-path="ch4.html"><a href="ch4.html#resampling"><i class="fa fa-check"></i><b>1.1.2</b> Resampling</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="ch4.html"><a href="ch4.html#reproducing-randomness"><i class="fa fa-check"></i><b>1.2</b> Reproducing Randomness</a></li>
<li class="chapter" data-level="1.3" data-path="ch4.html"><a href="ch4.html#replication"><i class="fa fa-check"></i><b>1.3</b> Replication</a><ul>
<li class="chapter" data-level="1.3.1" data-path="ch4.html"><a href="ch4.html#replicate"><i class="fa fa-check"></i><b>1.3.1</b> <code>replicate()</code></a></li>
<li class="chapter" data-level="1.3.2" data-path="ch4.html"><a href="ch4.html#for-loops"><i class="fa fa-check"></i><b>1.3.2</b> The <code>for()</code> loop</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="ch4.html"><a href="ch4.html#adv-funcs"><i class="fa fa-check"></i><b>1.4</b> Function Writing</a></li>
<li class="chapter" data-level="1.5" data-path="ch4.html"><a href="ch4.html#mc-summaries"><i class="fa fa-check"></i><b>1.5</b> Summarization</a><ul>
<li class="chapter" data-level="1.5.1" data-path="ch4.html"><a href="ch4.html#central-tendency"><i class="fa fa-check"></i><b>1.5.1</b> Central Tendency</a></li>
<li class="chapter" data-level="1.5.2" data-path="ch4.html"><a href="ch4.html#variability"><i class="fa fa-check"></i><b>1.5.2</b> Variability</a></li>
<li class="chapter" data-level="1.5.3" data-path="ch4.html"><a href="ch4.html#frequencies"><i class="fa fa-check"></i><b>1.5.3</b> Frequencies</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="ch4.html"><a href="ch4.html#sim-examples"><i class="fa fa-check"></i><b>1.6</b> Simulation-Based Examples</a><ul>
<li class="chapter" data-level="1.6.1" data-path="ch4.html"><a href="ch4.html#rnorm-ex"><i class="fa fa-check"></i><b>1.6.1</b> Test <code>rnorm</code></a></li>
<li class="chapter" data-level="1.6.2" data-path="ch4.html"><a href="ch4.html#power-ex"><i class="fa fa-check"></i><b>1.6.2</b> Stochastic Power Analysis</a></li>
<li class="chapter" data-level="1.6.3" data-path="ch4.html"><a href="ch4.html#harv-ex"><i class="fa fa-check"></i><b>1.6.3</b> Harvest Policy Analysis</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="ch4.html"><a href="ch4.html#resample-examples"><i class="fa fa-check"></i><b>1.7</b> Resampling-Based Examples</a><ul>
<li class="chapter" data-level="1.7.1" data-path="ch4.html"><a href="ch4.html#boot-test-ex"><i class="fa fa-check"></i><b>1.7.1</b> The Bootstrap</a></li>
<li class="chapter" data-level="1.7.2" data-path="ch4.html"><a href="ch4.html#perm-test-ex"><i class="fa fa-check"></i><b>1.7.2</b> Permutation Test</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="ch4.html"><a href="ch4.html#population-dynamics"><i class="fa fa-check"></i><b>1.8</b> Population dynamics</a><ul>
<li class="chapter" data-level="1.8.1" data-path="ch4.html"><a href="ch4.html#plot-steps"><i class="fa fa-check"></i><b>1.8.1</b> Plot steps</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="ch4.html"><a href="ch4.html#exercise-4"><i class="fa fa-check"></i><b>1.9</b> Exercise 4</a><ul>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#exercise-4a-required-material-only"><i class="fa fa-check"></i>Exercise 4A: Required Material Only</a></li>
<li><a href="ch4.html#exercise-4b-test-rnorm">Exercise 4B: Test <code>rnorm</code></a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#exercise-4c-stochastic-power-analysis"><i class="fa fa-check"></i>Exercise 4C: Stochastic Power Analysis</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#exercise-4d-harvest-policy-analysis"><i class="fa fa-check"></i>Exercise 4D: Harvest Policy Analysis</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#exercise-4e-the-bootstrap"><i class="fa fa-check"></i>Exercise 4E: The Bootstrap</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#exercise-4f-permutation-tests"><i class="fa fa-check"></i>Exercise 4F: Permutation Tests</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="calves.html"><a href="calves.html"><i class="fa fa-check"></i><b>2</b> Calving interval example</a><ul>
<li class="chapter" data-level="2.0.1" data-path="calves.html"><a href="calves.html#plot-steps-1"><i class="fa fa-check"></i><b>2.0.1</b> Plot steps</a></li>
<li class="chapter" data-level="2.1" data-path="calves.html"><a href="calves.html#exercise-4-1"><i class="fa fa-check"></i><b>2.1</b> Exercise 4</a><ul>
<li class="chapter" data-level="" data-path="calves.html"><a href="calves.html#exercise-4a-required-material-only-1"><i class="fa fa-check"></i>Exercise 4A: Required Material Only</a></li>
<li><a href="calves.html#exercise-4b-test-rnorm-1">Exercise 4B: Test <code>rnorm</code></a></li>
<li class="chapter" data-level="" data-path="calves.html"><a href="calves.html#exercise-4c-stochastic-power-analysis-1"><i class="fa fa-check"></i>Exercise 4C: Stochastic Power Analysis</a></li>
<li class="chapter" data-level="" data-path="calves.html"><a href="calves.html#exercise-4d-harvest-policy-analysis-1"><i class="fa fa-check"></i>Exercise 4D: Harvest Policy Analysis</a></li>
<li class="chapter" data-level="" data-path="calves.html"><a href="calves.html#exercise-4e-the-bootstrap-1"><i class="fa fa-check"></i>Exercise 4E: The Bootstrap</a></li>
<li class="chapter" data-level="" data-path="calves.html"><a href="calves.html#exercise-4f-permutation-tests-1"><i class="fa fa-check"></i>Exercise 4F: Permutation Tests</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ch6.html"><a href="ch6.html"><i class="fa fa-check"></i><b>3</b> Matrix population models</a></li>
<li class="chapter" data-level="4" data-path="ch4.html"><a href="ch4.html#sim-examples"><i class="fa fa-check"></i><b>4</b> Simulation-Based Examples</a><ul>
<li class="chapter" data-level="4.0.1" data-path="ch4.html"><a href="ch4.html#rnorm-ex"><i class="fa fa-check"></i><b>4.0.1</b> Test <code>rnorm</code></a></li>
<li class="chapter" data-level="4.0.2" data-path="ch4.html"><a href="ch4.html#power-ex"><i class="fa fa-check"></i><b>4.0.2</b> Stochastic Power Analysis</a></li>
<li class="chapter" data-level="4.0.3" data-path="ch4.html"><a href="ch4.html#harv-ex"><i class="fa fa-check"></i><b>4.0.3</b> Harvest Policy Analysis</a></li>
<li class="chapter" data-level="4.1" data-path="ch4.html"><a href="ch4.html#resample-examples"><i class="fa fa-check"></i><b>4.1</b> Resampling-Based Examples</a><ul>
<li class="chapter" data-level="4.1.1" data-path="ch4.html"><a href="ch4.html#boot-test-ex"><i class="fa fa-check"></i><b>4.1.1</b> The Bootstrap</a></li>
<li class="chapter" data-level="4.1.2" data-path="ch4.html"><a href="ch4.html#perm-test-ex"><i class="fa fa-check"></i><b>4.1.2</b> Permutation Test</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="sim-examples.html"><a href="sim-examples.html"><i class="fa fa-check"></i><b>4.2</b> Population dynamics</a><ul>
<li class="chapter" data-level="4.2.1" data-path="sim-examples.html"><a href="sim-examples.html#plot-steps-2"><i class="fa fa-check"></i><b>4.2.1</b> Plot steps</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="sim-examples.html"><a href="sim-examples.html#exercise-4-2"><i class="fa fa-check"></i><b>4.3</b> Exercise 4</a><ul>
<li class="chapter" data-level="" data-path="sim-examples.html"><a href="sim-examples.html#exercise-4a-required-material-only-2"><i class="fa fa-check"></i>Exercise 4A: Required Material Only</a></li>
<li><a href="sim-examples.html#exercise-4b-test-rnorm-2">Exercise 4B: Test <code>rnorm</code></a></li>
<li class="chapter" data-level="" data-path="sim-examples.html"><a href="sim-examples.html#exercise-4c-stochastic-power-analysis-2"><i class="fa fa-check"></i>Exercise 4C: Stochastic Power Analysis</a></li>
<li class="chapter" data-level="" data-path="sim-examples.html"><a href="sim-examples.html#exercise-4d-harvest-policy-analysis-2"><i class="fa fa-check"></i>Exercise 4D: Harvest Policy Analysis</a></li>
<li class="chapter" data-level="" data-path="sim-examples.html"><a href="sim-examples.html#exercise-4e-the-bootstrap-2"><i class="fa fa-check"></i>Exercise 4E: The Bootstrap</a></li>
<li class="chapter" data-level="" data-path="sim-examples.html"><a href="sim-examples.html#exercise-4f-permutation-tests-2"><i class="fa fa-check"></i>Exercise 4F: Permutation Tests</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/davan690/au-r-workshop" target="blank">Get the Data</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to R for Population dynamics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="calves" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Calving interval example</h1>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="calves.html#cb134-1"></a><span class="kw">source</span>(<span class="st">&quot;./R/Rcode/Final_report_Davidson2017.R&quot;</span>, <span class="dt">echo =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## 
## &gt; library(boot)
## 
## &gt; library(tidyverse)
## 
## &gt; library(dplyr)
## 
## &gt; library(ggplot2)
## 
## &gt; library(qpcR)
## 
## &gt; library(pwr)
## 
## &gt; library(ggthemes)
## 
## &gt; library(gridExtra)
## 
## &gt; Data &lt;- read.csv(&quot;./R/Data/RawCI.csv&quot;, header = T, 
## +     quote = &quot;\&quot;&quot;)
## 
## &gt; Year &lt;- unique(Data$Calves.1)
## 
## &gt; year2010a &lt;- c(3, 3, 2)
## 
## &gt; year2010 &lt;- filter(Data, Calves.1 &lt; 2011)
## 
## &gt; year2010 &lt;- year2010$Interval.1[!is.na(year2010$Interval.1)]
## 
## &gt; year2011a &lt;- c(3, 3, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 
## +     3, 3, 2)
## 
## &gt; year2011 &lt;- filter(Data, Calves.1 &lt; 2012)
## 
## &gt; year2011 &lt;- year2011$Interval.1[!is.na(year2011$Interval.1)]
## 
## &gt; year2012a &lt;- c(3, 3, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 
## +     3, 3, 2, 6, 4, 4, 4, 4, 4, 3, 3, 3, 3)
## 
## &gt; year2012 &lt;- filter(Data, Calves.1 &lt; 2013)
## 
## &gt; year2012 &lt;- year2012$Interval.1[!is.na(year2012$Interval.1)]
## 
## &gt; year2013a &lt;- c(3, 3, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 
## +     3, 3, 2, 6, 4, 4, 4, 4, 4, 3, 3, 3, 3, 6, 5, 4, 4, 4, 4, 
## +     4, 3, 3, 3, 3, 3, 3, 3, 3, .... [TRUNCATED] 
## 
## &gt; full &lt;- c(Data$Interval.1, Data$Interval.2)
## 
## &gt; year2013 &lt;- full[!is.na(unlist(full))]
## 
## &gt; mean2010 &lt;- sum(year2010)/length(year2010)
## 
## &gt; s2010 &lt;- sd(year2010)
## 
## &gt; SE2010 &lt;- s2010/(sqrt(length(year2010)))
## 
## &gt; n2010 &lt;- (length(year2010))
## 
## &gt; low.qt2010 &lt;- mean2010 - (qt(0.975, length(year2010)) * 
## +     SE2010)
## 
## &gt; high.qt2010 &lt;- mean2010 + (qt(0.975, length(year2010)) * 
## +     SE2010)
## 
## &gt; mean2011 &lt;- sum(year2011)/length(year2011)
## 
## &gt; s2011 &lt;- sd(year2011)
## 
## &gt; SE2011 &lt;- s2011/(sqrt(length(year2011)))
## 
## &gt; n2011 &lt;- (length(year2011))
## 
## &gt; low.qt2011 &lt;- mean2011 - (qt(0.975, length(year2011)) * 
## +     SE2011)
## 
## &gt; high.qt2011 &lt;- mean2011 + (qt(0.975, length(year2011)) * 
## +     SE2011)
## 
## &gt; mean2012 &lt;- sum(year2012)/length(year2012)
## 
## &gt; s2012 &lt;- sd(year2012)
## 
## &gt; SE2012 &lt;- s2012/(sqrt(length(year2012)))
## 
## &gt; n2012 &lt;- (length(year2012))
## 
## &gt; low.qt2012 &lt;- mean2012 - (qt(0.975, length(year2012)) * 
## +     SE2012)
## 
## &gt; high.qt2012 &lt;- mean2012 + (qt(0.975, length(year2012)) * 
## +     SE2012)
## 
## &gt; mean2013 &lt;- sum(year2013)/length(year2013)
## 
## &gt; s2013 &lt;- sd(year2013)
## 
## &gt; SE2013 &lt;- s2013/(sqrt(length(year2013)))
## 
## &gt; n2013 &lt;- (length(year2013))
## 
## &gt; low.qt2013 &lt;- mean2013 - (qt(0.975, length(year2013)) * 
## +     SE2013)
## 
## &gt; high.qt2013 &lt;- mean2013 + (qt(0.975, length(year2013)) * 
## +     SE2013)
## 
## &gt; n &lt;- c(length(year2010), length(year2011), length(year2012), 
## +     length(year2013))
## 
## &gt; mY &lt;- c(mean(year2010), mean(year2011), mean(year2012), 
## +     mean(year2013))
## 
## &gt; year &lt;- Year
## 
## &gt; low.qt &lt;- c(low.qt2010, low.qt2011, low.qt2012, low.qt2013)
## 
## &gt; high.qt &lt;- c(high.qt2010, high.qt2011, high.qt2012, 
## +     high.qt2013)
## 
## &gt; sd &lt;- c(s2010, s2011, s2012, s2013)
## 
## &gt; sum.dat &lt;- cbind(year, n, mY, low.qt, high.qt, sd)
## 
## &gt; sum.dat &lt;- as.data.frame(sum.dat)
## 
## &gt; library(knitr)
## 
## &gt; kable(sum.dat, format = &quot;markdown&quot;)
## 
## 
## | year|  n|       mY|   low.qt|  high.qt|        sd|
## |----:|--:|--------:|--------:|--------:|---------:|
## | 2010|  3| 2.666667| 1.605851| 3.727482| 0.5773503|
## | 2011| 15| 2.866667| 2.673022| 3.060312| 0.3518658|
## | 2012| 25| 3.240000| 2.919170| 3.560830| 0.7788881|
## | 2013| 45| 3.311111| 3.056488| 3.565734| 0.8480518|
## 
## &gt; ggplot(sum.dat, aes(y = mY, x = year)) + geom_point() + 
## +     geom_line() + geom_errorbar(aes(ymin = low.qt, ymax = high.qt), 
## +     width = 0.1) + .... [TRUNCATED]</code></pre>
<p><img src="A-beginners-guide-to-population-dynamics_files/figure-html/unnamed-chunk-81-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## &gt; par(mfrow = c(2, 2))
## 
## &gt; plot(factor(year2010), xlim = c(0, 6), ylim = c(0, 
## +     40))</code></pre>
<pre><code>## 
## &gt; title(main = &quot;a)&quot;, sub = &quot;Sample size 3&quot;, ylab = &quot;Frequency&quot;, 
## +     xlab = &quot;Calving interval&quot;, cex.main = 1.5, font.main = 4, 
## +     col.main = &quot;bl ...&quot; ... [TRUNCATED] 
## 
## &gt; box()
## 
## &gt; plot(factor(year2011), xlim = c(0, 6), ylim = c(0, 
## +     40))</code></pre>
<pre><code>## 
## &gt; title(main = &quot;b)&quot;, sub = &quot;Sample size 15&quot;, ylab = &quot;Frequency&quot;, 
## +     xlab = &quot;Calving interval&quot;, col.main = 4, cex.main = 1.5, 
## +     font.main = 4, .... [TRUNCATED] 
## 
## &gt; box()
## 
## &gt; plot(factor(year2012), xlim = c(0, 6), ylim = c(0, 
## +     40))</code></pre>
<pre><code>## 
## &gt; title(main = &quot;c)&quot;, sub = &quot;Sample size 25&quot;, ylab = &quot;Frequency&quot;, 
## +     xlab = &quot;Calving interval&quot;, col.main = 4, cex.main = 1.5, 
## +     font.main = 4, .... [TRUNCATED] 
## 
## &gt; box()
## 
## &gt; plot(factor(year2013), xlim = c(0, 6), ylim = c(0, 
## +     40))</code></pre>
<p><img src="A-beginners-guide-to-population-dynamics_files/figure-html/unnamed-chunk-81-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## &gt; title(main = &quot;d)&quot;, sub = &quot;Sample size 45&quot;, ylab = &quot;Frequency&quot;, 
## +     xlab = &quot;Calving interval&quot;, col.main = 4, cex.main = 1.5, 
## +     font.main = 4, .... [TRUNCATED] 
## 
## &gt; box()
## 
## &gt; library(qpcR)
## 
## &gt; rawdata &lt;- qpcR:::cbind.na(year2010, year2011, year2012, 
## +     year2013)
## 
## &gt; rawdata &lt;- as.data.frame(rawdata)
## 
## &gt; year2010 &lt;- data.frame(year2010, year = c(&quot;2010&quot;))
## 
## &gt; year2010 &lt;- rename(year2010, interval = year2010, 
## +     year = year)
## 
## &gt; year2011 &lt;- data.frame(year2011, year = c(&quot;2011&quot;))
## 
## &gt; year2011 &lt;- rename(year2011, interval = year2011, 
## +     year = year)
## 
## &gt; year2012 &lt;- data.frame(year2012, year = c(&quot;2012&quot;))
## 
## &gt; year2012 &lt;- rename(year2012, interval = year2012, 
## +     year = year)
## 
## &gt; year2013 &lt;- data.frame(year2013, year = c(&quot;2013&quot;))
## 
## &gt; year2013 &lt;- rename(year2013, interval = year2013, 
## +     year = year)
## 
## &gt; ggplotraw &lt;- rbind(year2010, year2011, year2012, year2013)
## 
## &gt; ggplotraw$interval &lt;- as.numeric(as.character(ggplotraw$interval))
## 
## &gt; ggplot(year2013, aes(x = interval)) + geom_bar(alpha = 1, 
## +     width = 0.9, fill = &quot;black&quot;) + xlab(expression(&quot;Calving&quot; ~ 
## +     &quot;interval&quot; ~ (ita .... [TRUNCATED]</code></pre>
<p><img src="A-beginners-guide-to-population-dynamics_files/figure-html/unnamed-chunk-81-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## &gt; RealCI &lt;- as.numeric(year2013$interval)
## 
## &gt; xlong &lt;- RealCI
## 
## &gt; meanlong &lt;- sum(xlong)/length(xlong)
## 
## &gt; slong &lt;- sd(xlong)
## 
## &gt; SElong &lt;- slong/(sqrt(length(xlong)))
## 
## &gt; nlong &lt;- (length(xlong))
## 
## &gt; lowqtlong &lt;- meanlong - (qt(0.975, nlong) * SElong)
## 
## &gt; highqtlong &lt;- meanlong + (qt(0.975, nlong) * SElong)
## 
## &gt; MedCI &lt;- c(RealCI[RealCI &lt; 5], 3, 3, 3, 3, 2, 3)
## 
## &gt; xmed &lt;- MedCI
## 
## &gt; meanmed &lt;- sum(xmed)/length(xmed)
## 
## &gt; smed &lt;- sd(xmed)
## 
## &gt; SEmed &lt;- smed/(sqrt(length(xmed)))
## 
## &gt; nmed &lt;- (length(xmed))
## 
## &gt; lowqtmed &lt;- meanmed - (qt(0.975, length(xmed)) * SEmed)
## 
## &gt; highqtmed &lt;- meanmed + (qt(0.975, length(xmed)) * 
## +     SEmed)
## 
## &gt; LowCI &lt;- c(RealCI[RealCI &lt; 4], 3, 3, 3, 3, 3, 2, 2, 
## +     2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2)
## 
## &gt; xshort &lt;- LowCI
## 
## &gt; meanshort &lt;- mean(xshort)
## 
## &gt; sshort &lt;- sd(xshort)
## 
## &gt; SEshort &lt;- sshort/(sqrt(length(xshort)))
## 
## &gt; lowqtshort &lt;- meanshort - (qt(0.975, length(xshort)) * 
## +     SEshort)
## 
## &gt; highqtshort &lt;- meanshort + (qt(0.975, length(xshort)) * 
## +     SEshort)
## 
## &gt; bdata &lt;- qpcR:::cbind.na(RealCI, MedCI, LowCI)
## 
## &gt; bdata &lt;- as.data.frame(bdata)
## 
## &gt; par(mfrow = c(1, 3))
## 
## &gt; plot(factor(bdata$LowCI), main = &quot;Lowest possible interval&quot;)</code></pre>
<pre><code>## 
## &gt; plot(factor(bdata$MedCI), main = &quot;Medium possible interval&quot;)</code></pre>
<pre><code>## 
## &gt; plot(factor(bdata$RealCI), main = &quot;Observed interval&quot;)</code></pre>
<p><img src="A-beginners-guide-to-population-dynamics_files/figure-html/unnamed-chunk-81-4.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## &gt; par(mfrow = c(3, 1))
## 
## &gt; plot(density(as.numeric(as.character(LowCI)), bw = 0.5), 
## +     main = &quot;Lowest possible interval&quot;)</code></pre>
<pre><code>## 
## &gt; plot(density(as.numeric(as.character(MedCI)), bw = 0.5), 
## +     main = &quot;Medium possible interval&quot;)</code></pre>
<pre><code>## 
## &gt; plot(density(as.numeric(as.character(RealCI)), bw = 0.5), 
## +     main = &quot;Observed interval&quot;)</code></pre>
<p><img src="A-beginners-guide-to-population-dynamics_files/figure-html/unnamed-chunk-81-5.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## &gt; Sumtable &lt;- data.frame(variable = c(&quot;low.qt&quot;, &quot;mean&quot;, 
## +     &quot;high.qt&quot;, &quot;sd&quot;, &quot;SE&quot;), short = c(lowqtshort, meanshort, 
## +     highqtshort, sshort, SE .... [TRUNCATED] 
## 
## &gt; n &lt;- c(length(LowCI), length(MedCI), length(year2013$interval))
## 
## &gt; mY &lt;- c(mean(LowCI), mean(MedCI), mean(year2013$interval))
## 
## &gt; interval &lt;- c(&quot;Low&quot;, &quot;Medium&quot;, &quot;Observed&quot;)
## 
## &gt; low.qt &lt;- c(lowqtshort, lowqtmed, low.qt2013)
## 
## &gt; high.qt &lt;- c(highqtshort, highqtmed, high.qt2013)
## 
## &gt; sd &lt;- c(sshort, smed, s2013)
## 
## &gt; Sumtable &lt;- cbind(interval, n, mY, low.qt, high.qt, 
## +     sd)
## 
## &gt; Sumtable &lt;- as.data.frame(Sumtable)
## 
## &gt; Sumtable$n &lt;- as.numeric(as.character(Sumtable$n))
## 
## &gt; Sumtable$mY &lt;- as.numeric(as.character(Sumtable$mY))
## 
## &gt; Sumtable$low.qt &lt;- as.numeric(as.character(Sumtable$low.qt))
## 
## &gt; Sumtable$high.qt &lt;- as.numeric(as.character(Sumtable$high.qt))
## 
## &gt; Sumtable$sd &lt;- as.numeric(as.character(Sumtable$sd))
## 
## &gt; Sumtable$interval &lt;- as.character(Sumtable$interval)
## 
## &gt; ggplot(Sumtable, aes(y = mY, x = interval)) + geom_point(size = 5) + 
## +     geom_errorbar(aes(ymin = low.qt, ymax = high.qt), width = 0.05, 
## +       .... [TRUNCATED]</code></pre>
<p><img src="A-beginners-guide-to-population-dynamics_files/figure-html/unnamed-chunk-81-6.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## &gt; library(knitr)
## 
## &gt; kable(Sumtable, format = &quot;markdown&quot;, col.names = c(&quot;Interval&quot;, 
## +     &quot;Sample size&quot;, &quot;Mean&quot;, &quot;Lower limit&quot;, &quot;Higher limit&quot;, &quot;SD&quot;))
## 
## 
## |Interval | Sample size|     Mean| Lower limit| Higher limit|        SD|
## |:--------|-----------:|--------:|-----------:|------------:|---------:|
## |Low      |          58| 2.568966|    2.437666|     2.700265| 0.4995461|
## |Medium   |          48| 3.104167|    2.943089|     3.265244| 0.5550382|
## |Observed |          45| 3.311111|    3.056488|     3.565734| 0.8480518|
## 
## &gt; library(knitr)
## 
## &gt; srwdat &lt;- read.csv(file = &quot;./R/Data/srw_data.csv&quot;)
## 
## &gt; kable(srwdat, format = &quot;markdown&quot;, col.names = c(&quot;Sample size&quot;, 
## +     &quot;Mean&quot;, &quot;Lower limit&quot;, &quot;Higher limit&quot;, &quot;SE&quot;, &quot;Author&quot;, &quot;Location&quot;))
## 
## 
## | Sample size| Mean| Lower limit| Higher limit|   SE|Author             |Location                          |
## |-----------:|----:|-----------:|------------:|----:|:------------------|:---------------------------------|
## |          NA| 3.12|        3.07|         3.17|   NA|Best et al. 2001   |South Africa                      |
## |        1504| 3.15|        3.11|         3.18|   NA|Best et al. 2005   |South Africa (1971-2003 Updated)  |
## |          NA| 3.16|        3.13|         3.19|   NA|Brandao et al 2010 |South Africa ( 1971-2006 Updated) |
## |          NA| 3.35|          NA|           NA| 0.05|Cooke et al. 2001  |Argentina                         |
## |         749| 3.42|          NA|           NA| 0.11|Cooke et al. 2003  |Argentina                         |
## |          NA| 3.63|          NA|           NA| 0.13|Burnell 2001       |Australia                         |
## 
## &gt; SAreps &lt;- 1500
## 
## &gt; ARreps &lt;- 800
## 
## &gt; Aussiereps &lt;- 2000
## 
## &gt; low &lt;- 1000
## 
## &gt; verylow &lt;- 100
## 
## &gt; lowest &lt;- 10
## 
## &gt; par(mfrow = c(2, 3))
## 
## &gt; plot(factor(sample(year2013$interval, lowest, replace = T)), 
## +     main = &quot;3 intervals&quot;)</code></pre>
<pre><code>## 
## &gt; plot(factor(sample(year2013$interval, verylow, replace = T)), 
## +     main = &quot;10 intervals&quot;)</code></pre>
<pre><code>## 
## &gt; plot(factor(sample(year2013$interval, low, replace = T)), 
## +     main = &quot;30 intervals&quot;)</code></pre>
<pre><code>## 
## &gt; plot(factor(sample(year2013$interval, Aussiereps, 
## +     replace = T)), main = &quot;500 intervals&quot;)</code></pre>
<pre><code>## 
## &gt; plot(factor(sample(year2013$interval, ARreps, replace = T)), 
## +     main = &quot;800 intervals&quot;)</code></pre>
<pre><code>## 
## &gt; plot(factor(sample(year2013$interval, SAreps, replace = T)), 
## +     main = &quot;1500 intervals&quot;)</code></pre>
<p><img src="A-beginners-guide-to-population-dynamics_files/figure-html/unnamed-chunk-81-7.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## &gt; boots &lt;- 1000
## 
## &gt; n &lt;- c(1:1000)
## 
## &gt; var10 &lt;- paste0(&quot;n_&quot;, 1:10)
## 
## &gt; sample10 &lt;- matrix(data = NA, ncol = lowest, nrow = boots)
## 
## &gt; colnames(sample10) &lt;- as.list(var10)
## 
## &gt; for (i in 1:boots) {
## +     sample10[i, ] &lt;- sample(year2013$interval, lowest, replace = T)
## + }
## 
## &gt; sample10 &lt;- as.data.frame(sample10)
## 
## &gt; sample10 &lt;- sample10 %&gt;% mutate(mean10 = rowMeans(sample10))
## 
## &gt; sample10t &lt;- as.matrix(sample10)
## 
## &gt; sample10t &lt;- t(sample10t)
## 
## &gt; var100 &lt;- paste0(&quot;n_&quot;, 1:100)
## 
## &gt; sample100 &lt;- matrix(data = NA, ncol = verylow, nrow = boots)
## 
## &gt; colnames(sample100) &lt;- as.list(var100)
## 
## &gt; for (i in 1:boots) {
## +     sample100[i, ] &lt;- sample(year2013$interval, verylow, replace = T)
## + }
## 
## &gt; sample100 &lt;- as.data.frame(sample100)
## 
## &gt; sample100 &lt;- sample100 %&gt;% mutate(mean100 = rowMeans(sample100))
## 
## &gt; var500 &lt;- paste0(&quot;n_&quot;, 1:500)
## 
## &gt; sample500 &lt;- matrix(data = NA, ncol = 500, nrow = boots)
## 
## &gt; colnames(sample500) &lt;- as.list(var500)
## 
## &gt; for (i in 1:boots) {
## +     sample500[i, ] &lt;- sample(year2013$interval, 500, replace = T)
## + }
## 
## &gt; sample500 &lt;- as.data.frame(sample500)
## 
## &gt; sample500 &lt;- sample500 %&gt;% mutate(mean500 = rowMeans(sample500))
## 
## &gt; var1000 &lt;- paste0(&quot;n_&quot;, 1:1000)
## 
## &gt; sample1000 &lt;- matrix(data = NA, ncol = low, nrow = boots)
## 
## &gt; colnames(sample1000) &lt;- as.list(var1000)
## 
## &gt; for (i in 1:boots) {
## +     sample1000[i, ] &lt;- sample(year2013$interval, low, replace = T)
## + }
## 
## &gt; sample1000 &lt;- as.data.frame(sample1000)
## 
## &gt; sample1000 &lt;- sample1000 %&gt;% mutate(mean1000 = rowMeans(sample1000))
## 
## &gt; varA &lt;- paste0(&quot;n_&quot;, 1:2000)
## 
## &gt; sampleA &lt;- matrix(data = NA, ncol = Aussiereps, nrow = boots)
## 
## &gt; colnames(sampleA) &lt;- as.list(varA)
## 
## &gt; for (i in 1:boots) {
## +     sampleA[i, ] &lt;- sample(year2013$interval, Aussiereps, replace = T)
## + }
## 
## &gt; sampleA &lt;- as.data.frame(sampleA)
## 
## &gt; sampleA &lt;- sampleA %&gt;% mutate(meanA = rowMeans(sampleA))
## 
## &gt; sampleAt &lt;- t(sampleA)
## 
## &gt; for (i in c(1:ncol(sampleA))) {
## +     sampleA[, i] &lt;- as.numeric(as.character(sampleA[, i]))
## + }
## 
## &gt; ab &lt;- sort(sampleA$meanA)
## 
## &gt; nab &lt;- length(ab)
## 
## &gt; ab2.5 &lt;- ab[25]
## 
## &gt; ab0.97.5 &lt;- ab[975]
## 
## &gt; ab &lt;- sort(sampleA$meanA)
## 
## &gt; nab &lt;- length(ab)
## 
## &gt; ab2.5 &lt;- ab[25]
## 
## &gt; ab0.97.5 &lt;- ab[975]
## 
## &gt; par(mfrow = c(1, 1))
## 
## &gt; plot(density(sample10$mean10, bw = 0.05), col = &quot;black&quot;, 
## +     lty = 1, main = &quot;&quot;, lwd = 5, ylim = c(0, 8), xlim = c(2, 
## +         4.5), axes = FAL .... [TRUNCATED]</code></pre>
<p><img src="A-beginners-guide-to-population-dynamics_files/figure-html/unnamed-chunk-81-8.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## &gt; lines(density(sample100$mean100, bw = 0.05), col = &quot;black&quot;, 
## +     lty = 2, lwd = 4)
## 
## &gt; lines(density(sample500$mean500, bw = 0.05), col = &quot;black&quot;, 
## +     lty = 3, lwd = 3)
## 
## &gt; lines(density(sample1000$mean1000, bw = 0.05), col = &quot;black&quot;, 
## +     lty = 4, lwd = 2)
## 
## &gt; lines(density(sampleA$meanA, bw = 0.05), col = &quot;black&quot;, 
## +     lty = 5, lwd = 1)
## 
## &gt; legend(&quot;topright&quot;, title = &quot;Legend&quot;, c(&quot;n=10, cv=8.12 &quot;, 
## +     &quot;n=100, cv=2.43&quot;, &quot;n=500, c.v=1.15&quot;, &quot;n=1000, cv=0.79&quot;, &quot;n=2000, cv=0.56&quot;), 
## +     b .... [TRUNCATED] 
## 
## &gt; axis(1, lwd = 2)
## 
## &gt; axis(2, lwd = 2)
## 
## &gt; plot(density(sample10$mean10, bw = 0.05), col = &quot;black&quot;, 
## +     lty = 3, main = &quot;&quot;, lwd = 1, ylim = c(0, 8), xlim = c(2.5, 
## +         4.5), axes = F .... [TRUNCATED]</code></pre>
<p><img src="A-beginners-guide-to-population-dynamics_files/figure-html/unnamed-chunk-81-9.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## &gt; lines(density(sample100$mean100, bw = 0.05), col = &quot;black&quot;, 
## +     lty = 4, lwd = 1)
## 
## &gt; lines(density(sample500$mean500, bw = 0.05), col = &quot;black&quot;, 
## +     lty = 5, lwd = 1)
## 
## &gt; lines(density(sample1000$mean1000, bw = 0.05), col = &quot;black&quot;, 
## +     lty = 2, lwd = 1)
## 
## &gt; lines(density(sampleA$meanA, bw = 0.05), col = &quot;black&quot;, 
## +     lty = 1, lwd = 2)
## 
## &gt; legend(y = 8, x = 3.9, title = expression(bold(&quot;Sample size (n)&quot;)), 
## +     c(expression(italic(&quot;n&quot;) ~ &quot;=&quot; ~ &quot;10&quot;), expression(italic(&quot;n&quot;) ~ 
## +       .... [TRUNCATED] 
## 
## &gt; axis(1, lwd = 2)
## 
## &gt; axis(2, lwd = 2)
## 
## &gt; rev.one &lt;- bdata$RealCI[1:45]
## 
## &gt; sample.true &lt;- year2013$interval
## 
## &gt; pwr.test.results &lt;- power.t.test(n = 45, delta = seq(0, 
## +     0.99, 0.001), sd = sd(sample.true), alternative = &quot;one.sided&quot;, 
## +     sig.level = 0.0 .... [TRUNCATED] 
## 
## &gt; pwr.analysis &lt;- as.data.frame(cbind(pwr.test.results$power, 
## +     pwr.test.results$delta))
## 
## &gt; colnames(pwr.analysis) &lt;- c(&quot;Power&quot;, &quot;Mean.difference&quot;)
## 
## &gt; pwr.analysis.1 &lt;- pwr.analysis %&gt;% mutate(Alpha = 1 - 
## +     Power, Mean.estimate = 3.31 + Mean.difference)
## 
## &gt; a &lt;- filter(pwr.analysis.1, Alpha &lt; 0.05)
## 
## &gt; a[1, ]
##       Power Mean.difference      Alpha Mean.estimate
## 1 0.9501505           0.593 0.04984946         3.903
## 
## &gt; ggplot(data = pwr.analysis.1, aes(x = Mean.estimate, 
## +     y = Alpha)) + geom_line(size = 1.5) + geom_vline(xintercept = 3.903, 
## +     col = &quot;blue&quot; .... [TRUNCATED]</code></pre>
<pre><code>## 
## &gt; rev.one &lt;- bdata$RealCI[1:45]
## 
## &gt; sample.true &lt;- year2013$interval
## 
## &gt; diff &lt;- 3.63 - 3.31
## 
## &gt; pwr.test.results &lt;- power.t.test(n = seq(1, 200, 1), 
## +     delta = diff, sd = sd(sample.true), alternative = &quot;one.sided&quot;, 
## +     sig.level = 0.05)</code></pre>
<pre><code>## Warning in qt(sig.level/tside, nu, lower.tail = FALSE): NaNs produced</code></pre>
<p><img src="A-beginners-guide-to-population-dynamics_files/figure-html/unnamed-chunk-81-10.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## &gt; pwr.analysis &lt;- as.data.frame(cbind(pwr.test.results$power, 
## +     pwr.test.results$n))
## 
## &gt; colnames(pwr.analysis) &lt;- c(&quot;Power&quot;, &quot;Sample.size&quot;)
## 
## &gt; pwr.analysis.1 &lt;- pwr.analysis %&gt;% mutate(Alpha = 1 - 
## +     Power)
## 
## &gt; a &lt;- filter(pwr.analysis.1, Alpha &lt; 0.05)
## 
## &gt; a[1, ]
##       Power Sample.size     Alpha
## 1 0.9503366         153 0.0496634
## 
## &gt; ggplot(data = pwr.analysis.1, aes(x = Sample.size, 
## +     y = Alpha)) + geom_line(size = 1.5) + geom_vline(xintercept = 45, 
## +     col = &quot;red&quot;) + ge .... [TRUNCATED]</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_path).</code></pre>
<pre><code>## 
## &gt; dat &lt;- read.csv(&quot;./R/Data/raw_observations_2012.csv&quot;)
## 
## &gt; glimpse(dat)
## Observations: 180
## Variables: 10
## $ ID          &lt;fct&gt; AI06006, AI06007, AI06015, AI06022, AI06038, AI100...
## $ X2006       &lt;int&gt; 1, 2, 2, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
## $ X2007       &lt;int&gt; 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
## $ X2008       &lt;int&gt; 1, 0, 1, 0, 2, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,...
## $ X2009       &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
## $ X2010       &lt;int&gt; 0, 0, 2, 0, 0, 6, 6, 5, 5, 3, 4, 2, 5, 4, 5, 3, 2,...
## $ X2011       &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
## $ X2012       &lt;int&gt; 0, 1, 2, 4, 0, 0, 0, 0, 0, 0, 5, 0, 0, 12, 0, 0, 0...
## $ total       &lt;int&gt; 2, 4, 8, 5, 3, 6, 7, 5, 5, 3, 9, 2, 5, 16, 6, 3, 2...
## $ X..yrs.seen &lt;int&gt; 2, 3, 5, 2, 2, 1, 2, 1, 1, 1, 2, 1, 1, 2, 2, 1, 1,...
## 
## &gt; head(dat)
##        ID X2006 X2007 X2008 X2009 X2010 X2011 X2012 total X..yrs.seen
## 1 AI06006     1     0     1     0     0     0     0     2           2
## 2 AI06007     2     1     0     0     0     0     1     4           3
## 3 AI06015     2     1     1     0     2     0     2     8           5
## 4 AI06022     1     0     0     0     0     0     4     5           2
## 5 AI06038     1     0     2     0     0     0     0     3           2
## 6 AI10040     0     0     0     0     6     0     0     6           1
## 
## &gt; dat1 &lt;- read.csv(&quot;./R/Data/RawCI.csv&quot;, header = T, 
## +     quote = &quot;\&quot;&quot;)
## 
## &gt; glimpse(dat1)
## Observations: 41
## Variables: 8
## $ ID            &lt;fct&gt; AI10124, AI10070, AI10086, AI08340, AI08341, AI0...
## $ Yr.first.seen &lt;int&gt; 2007, 2008, 2007, 2008, 2008, 2008, 2008, 2008, ...
## $ Calves        &lt;int&gt; 2007, 2008, 2007, 2008, 2008, 2008, 2008, 2008, ...
## $ Calves.1      &lt;int&gt; 2010, 2010, 2010, 2011, 2011, 2011, 2011, 2011, ...
## $ Calves.2      &lt;int&gt; 2013, 2013, 2013, NA, NA, NA, NA, NA, NA, NA, NA...
## $ Interval.1    &lt;int&gt; 3, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 6, ...
## $ Interval.2    &lt;int&gt; 3, 3, 3, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,...
## $ X             &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ...
## 
## &gt; dat3 &lt;- dplyr::select(dat, ID, X2006:X2012) %&gt;% gather(year, 
## +     count, X2006:X2012)
## 
## &gt; dat4 &lt;- full_join(dat3, dat1, by = &quot;ID&quot;)</code></pre>
<pre><code>## Warning: Column `ID` joining factors with different levels, coercing to
## character vector</code></pre>
<p><img src="A-beginners-guide-to-population-dynamics_files/figure-html/unnamed-chunk-81-11.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## &gt; dat5 &lt;- dplyr::select(dat4, ID, year, count, Yr.first.seen, 
## +     Calves, Calves.1, Calves.2)
## 
## &gt; dat6 &lt;- filter(dat5, count &gt; 0)
## 
## &gt; glimpse(dat6)
## Observations: 237
## Variables: 7
## $ ID            &lt;chr&gt; &quot;AI06006&quot;, &quot;AI06007&quot;, &quot;AI06015&quot;, &quot;AI06022&quot;, &quot;AI0...
## $ year          &lt;chr&gt; &quot;X2006&quot;, &quot;X2006&quot;, &quot;X2006&quot;, &quot;X2006&quot;, &quot;X2006&quot;, &quot;X2...
## $ count         &lt;int&gt; 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
## $ Yr.first.seen &lt;int&gt; NA, NA, NA, 2006, NA, NA, NA, 2007, 2007, NA, NA...
## $ Calves        &lt;int&gt; NA, NA, NA, 2006, NA, NA, NA, 2007, 2007, NA, NA...
## $ Calves.1      &lt;int&gt; NA, NA, NA, 2012, NA, NA, NA, 2013, 2010, NA, NA...
## $ Calves.2      &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, 2013, NA, NA, 20...
## 
## &gt; dat7 &lt;- mutate(dat6, year = ifelse(year == &quot;X2006&quot;, 
## +     &quot;2006&quot;, year), year = ifelse(year == &quot;X2007&quot;, &quot;2007&quot;, year), 
## +     year = ifelse(year == .... [TRUNCATED] 
## 
## &gt; a &lt;- group_by(dat7, ID, Yr.first.seen) %&gt;% mutate(mother = ifelse(Yr.first.seen &gt; 
## +     0, 1, 0)) %&gt;% filter(mother == 1) %&gt;% ungroup() %&gt;% dplyr:: .... [TRUNCATED] 
## 
## &gt; a
## # A tibble: 1 x 4
##   ID      year  Calves Calves.1
##   &lt;chr&gt;   &lt;chr&gt;  &lt;int&gt;    &lt;int&gt;
## 1 AI09216 2007    2009     2011
## 
## &gt; greater.than.2 &lt;- sample.true[sample.true &gt; 2]
## 
## &gt; mean.2 &lt;- sum(greater.than.2)/length(greater.than.2)
## 
## &gt; s.2 &lt;- sd(greater.than.2)
## 
## &gt; SE.2 &lt;- s2013/(sqrt(length(greater.than.2)))
## 
## &gt; n.2 &lt;- length(greater.than.2)
## 
## &gt; low.qt.2 &lt;- mean.2 - (qt(0.975, length(greater.than.2)) * 
## +     SE.2)
## 
## &gt; high.qt.2 &lt;- mean.2 + (qt(0.975, length(greater.than.2)) * 
## +     SE.2)
## 
## &gt; Sumtable[4, ] &lt;- c(&quot;miss2year&quot;, n.2, mean.2, low.qt.2, 
## +     high.qt.2, sd(greater.than.2))
## 
## &gt; boots &lt;- 1000
## 
## &gt; n &lt;- c(1:1000)
## 
## &gt; detect1 &lt;- 44
## 
## &gt; detect2 &lt;- 42
## 
## &gt; detect3 &lt;- 40
## 
## &gt; sample2 &lt;- rep(NA, 1000)
## 
## &gt; sample5 &lt;- rep(NA, 1000)
## 
## &gt; sample10 &lt;- rep(NA, 1000)
## 
## &gt; for (i in 1:boots) {
## +     sample2[i] &lt;- mean(sample(year2013$interval, detect1, replace = T))
## +     sample5[i] &lt;- mean(sample(year2013$interval, de .... [TRUNCATED] 
## 
## &gt; sample2 &lt;- sort(sample2)
## 
## &gt; sample2.2.5 &lt;- sample2[25]
## 
## &gt; sample2.50 &lt;- sample2[500]
## 
## &gt; sample2.975 &lt;- sample2[975]
## 
## &gt; sample5 &lt;- sort(sample5)
## 
## &gt; sample5.2.5 &lt;- sample5[25]
## 
## &gt; sample5.50 &lt;- sample5[500]
## 
## &gt; sample5.975 &lt;- sample5[975]
## 
## &gt; sample10 &lt;- sort(sample10)
## 
## &gt; sample10.2.5 &lt;- sample10[25]
## 
## &gt; sample10.50 &lt;- sample10[500]
## 
## &gt; sample10.975 &lt;- sample10[975]
## 
## &gt; Sumtable[5, ] &lt;- c(&quot;detect1&quot;, detect1, sample2.50, 
## +     sample2.2.5, sample2.975, NA)
## 
## &gt; Sumtable[6, ] &lt;- c(&quot;detect2&quot;, detect2, sample5.50, 
## +     sample5.2.5, sample5.975, NA)
## 
## &gt; Sumtable[7, ] &lt;- c(&quot;detect5&quot;, detect3, sample10.50, 
## +     sample10.2.5, sample10.975, NA)
## 
## &gt; length(Data$ID)
## [1] 41
## 
## &gt; length(dat$ID)
## [1] 180
## 
## &gt; glimpse(Data)
## Observations: 41
## Variables: 8
## $ ID            &lt;fct&gt; AI10124, AI10070, AI10086, AI08340, AI08341, AI0...
## $ Yr.first.seen &lt;int&gt; 2007, 2008, 2007, 2008, 2008, 2008, 2008, 2008, ...
## $ Calves        &lt;int&gt; 2007, 2008, 2007, 2008, 2008, 2008, 2008, 2008, ...
## $ Calves.1      &lt;int&gt; 2010, 2010, 2010, 2011, 2011, 2011, 2011, 2011, ...
## $ Calves.2      &lt;int&gt; 2013, 2013, 2013, NA, NA, NA, NA, NA, NA, NA, NA...
## $ Interval.1    &lt;int&gt; 3, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 6, ...
## $ Interval.2    &lt;int&gt; 3, 3, 3, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,...
## $ X             &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ...
## 
## &gt; dat.detect &lt;- dplyr::select(Data, ID, Calves, Calves.1, 
## +     Calves.2) %&gt;% mutate(Calves = factor(Calves), Calves.1 = factor(Calves.1), 
## +     Cal .... [TRUNCATED] 
## 
## &gt; a &lt;- as.data.frame.matrix(table(Data$ID, Data$Calves))
## 
## &gt; head(a)
##         2006 2007 2008 2009 2010 2011
## AI06022    1    0    0    0    0    0
## AI08340    0    0    1    0    0    0
## AI08341    0    0    1    0    0    0
## AI08343    0    0    1    0    0    0
## AI08355    0    0    1    0    0    0
## AI08362    0    0    1    0    0    0
## 
## &gt; a[, 7] &lt;- row.names(a)
## 
## &gt; colnames(a)[1] &lt;- &quot;y2006&quot;
## 
## &gt; colnames(a)[2] &lt;- &quot;y2007&quot;
## 
## &gt; colnames(a)[3] &lt;- &quot;y2008&quot;
## 
## &gt; colnames(a)[4] &lt;- &quot;y2009&quot;
## 
## &gt; colnames(a)[5] &lt;- &quot;y2010&quot;
## 
## &gt; colnames(a)[6] &lt;- &quot;y2011&quot;
## 
## &gt; colnames(a)[7] &lt;- &quot;ID&quot;
## 
## &gt; a[, 8] &lt;- 0
## 
## &gt; colnames(a)[8] &lt;- &quot;y2012&quot;
## 
## &gt; a[, 9] &lt;- 0
## 
## &gt; colnames(a)[9] &lt;- &quot;y2013&quot;
## 
## &gt; a &lt;- dplyr::select(a, ID, y2006, y2007, y2008, y2009, 
## +     y2010, y2011, y2012, y2013)
## 
## &gt; b &lt;- as.data.frame.matrix(table(Data$ID, Data$Calves.1))
## 
## &gt; head(b)
##         2010 2011 2012 2013
## AI06022    0    0    1    0
## AI08340    0    1    0    0
## AI08341    0    1    0    0
## AI08343    0    0    0    1
## AI08355    0    1    0    0
## AI08362    0    1    0    0
## 
## &gt; b[, 5] &lt;- row.names(b)
## 
## &gt; colnames(b)[5] &lt;- &quot;ID&quot;
## 
## &gt; b[, 6] &lt;- 0
## 
## &gt; colnames(b)[6] &lt;- &quot;y2006&quot;
## 
## &gt; b[, 7] &lt;- 0
## 
## &gt; colnames(b)[7] &lt;- &quot;y2007&quot;
## 
## &gt; b[, 8] &lt;- 0
## 
## &gt; colnames(b)[8] &lt;- &quot;y2008&quot;
## 
## &gt; b[, 9] &lt;- 0
## 
## &gt; colnames(b)[9] &lt;- &quot;y2009&quot;
## 
## &gt; colnames(b)[1] &lt;- &quot;y2010&quot;
## 
## &gt; colnames(b)[2] &lt;- &quot;y2011&quot;
## 
## &gt; colnames(b)[3] &lt;- &quot;y2012&quot;
## 
## &gt; colnames(b)[4] &lt;- &quot;y2013&quot;
## 
## &gt; b &lt;- dplyr::select(b, ID, y2006, y2007, y2008, y2009, 
## +     y2010, y2011, y2012, y2013)
## 
## &gt; c &lt;- as.data.frame.matrix(table(Data$ID, Data$Calves.2))
## 
## &gt; head(c)
##         2013
## AI06022    0
## AI08340    0
## AI08341    0
## AI08343    0
## AI08355    0
## AI08362    0
## 
## &gt; colnames(c)[1] &lt;- &quot;y2013&quot;
## 
## &gt; c[, 2] &lt;- row.names(c)
## 
## &gt; colnames(c)[2] &lt;- &quot;ID&quot;
## 
## &gt; c[, 3] &lt;- 0
## 
## &gt; colnames(c)[3] &lt;- &quot;y2006&quot;
## 
## &gt; c[, 4] &lt;- 0
## 
## &gt; colnames(c)[4] &lt;- &quot;y2007&quot;
## 
## &gt; c[, 5] &lt;- 0
## 
## &gt; colnames(c)[5] &lt;- &quot;y2008&quot;
## 
## &gt; c[, 6] &lt;- 0
## 
## &gt; colnames(c)[6] &lt;- &quot;y2009&quot;
## 
## &gt; c[, 7] &lt;- 0
## 
## &gt; colnames(c)[7] &lt;- &quot;y2010&quot;
## 
## &gt; c[, 8] &lt;- 0
## 
## &gt; colnames(c)[8] &lt;- &quot;y2011&quot;
## 
## &gt; c[, 9] &lt;- 0
## 
## &gt; colnames(c)[9] &lt;- &quot;y2012&quot;
## 
## &gt; c &lt;- dplyr::select(c, ID, y2006, y2007, y2008, y2009, 
## +     y2010, y2011, y2012, y2013)
## 
## &gt; countdat &lt;- rbind(a, b, c)
## 
## &gt; glimpse(countdat)
## Observations: 123
## Variables: 9
## $ ID    &lt;chr&gt; &quot;AI06022&quot;, &quot;AI08340&quot;, &quot;AI08341&quot;, &quot;AI08343&quot;, &quot;AI08355&quot;, &quot;...
## $ y2006 &lt;dbl&gt; 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
## $ y2007 &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
## $ y2008 &lt;dbl&gt; 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0,...
## $ y2009 &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1,...
## $ y2010 &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
## $ y2011 &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
## $ y2012 &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
## $ y2013 &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
## 
## &gt; full.dat &lt;- group_by(countdat, ID) %&gt;% summarise(y2006 = sum(y2006), 
## +     y2007 = sum(y2007), y2008 = sum(y2008), y2009 = sum(y2009), 
## +     y2010 .... [TRUNCATED] 
## 
## &gt; 2012 - 2006
## [1] 6
## 
## &gt; sort(Data$ID)
##  [1] AI06022 AI08340 AI08341 AI08343 AI08355 AI08362 AI08364 AI08365
##  [9] AI08372 AI08378 AI08379 AI08383 AI08386 AI08387 AI08390 AI08395
## [17] AI08403 AI09216 AI09217 AI09221 AI09224 AI09225 AI09247 AI09249
## [25] AI09259 AI09265 AI09289 AI10043 AI10056 AI10070 AI10085 AI10086
## [33] AI10102 AI10124 AI10144 AI10160 AI10167 AI10170 AI10177 AI11408
## [41] AI11430
## 41 Levels: AI06022 AI08340 AI08341 AI08343 AI08355 AI08362 ... AI11430
## 
## &gt; filter(Data, ID == &quot;AI06022&quot;)
##        ID Yr.first.seen Calves Calves.1 Calves.2 Interval.1 Interval.2  X
## 1 AI06022          2006   2006     2012       NA          6         NA NA
## 
## &gt; filter(Data, ID == &quot;AI08340&quot;)
##        ID Yr.first.seen Calves Calves.1 Calves.2 Interval.1 Interval.2  X
## 1 AI08340          2008   2008     2011       NA          3         NA NA
## 
## &gt; filter(Data, ID == &quot;AI08343&quot;)
##        ID Yr.first.seen Calves Calves.1 Calves.2 Interval.1 Interval.2  X
## 1 AI08343          2008   2008     2013       NA          5         NA NA
## 
## &gt; head(Data)
##        ID Yr.first.seen Calves Calves.1 Calves.2 Interval.1 Interval.2  X
## 1 AI10124          2007   2007     2010     2013          3          3 NA
## 2 AI10070          2008   2008     2010     2013          2          3 NA
## 3 AI10086          2007   2007     2010     2013          3          3 NA
## 4 AI08340          2008   2008     2011       NA          3         NA NA
## 5 AI08341          2008   2008     2011       NA          3         NA NA
## 6 AI08355          2008   2008     2011       NA          3         NA NA
## 
## &gt; longer5.6 &lt;- c(sample.true, 5, 6, 6)
## 
## &gt; mean.56 &lt;- sum(longer5.6)/length(longer5.6)
## 
## &gt; s.56 &lt;- sd(longer5.6)
## 
## &gt; SE.56 &lt;- s.56/(sqrt(length(longer5.6)))
## 
## &gt; n.56 &lt;- (length(longer5.6))
## 
## &gt; low.qt.56 &lt;- mean.56 - (qt(0.975, length(longer5.6)) * 
## +     SE.56)
## 
## &gt; high.qt.56 &lt;- mean.56 + (qt(0.975, length(longer5.6)) * 
## +     SE.56)
## 
## &gt; Sumtable[8, ] &lt;- c(&quot;longer.56&quot;, n.56, mean.56, low.qt.56, 
## +     high.qt.56, sd(longer5.6))
## 
## &gt; Sumtable &lt;- as.data.frame(Sumtable)
## 
## &gt; Sumtable$n &lt;- as.numeric(as.character(Sumtable$n))
## 
## &gt; Sumtable$mY &lt;- as.numeric(as.character(Sumtable$mY))
## 
## &gt; Sumtable$low.qt &lt;- as.numeric(as.character(Sumtable$low.qt))
## 
## &gt; Sumtable$high.qt &lt;- as.numeric(as.character(Sumtable$high.qt))
## 
## &gt; Sumtable$sd &lt;- as.numeric(as.character(Sumtable$sd))
## 
## &gt; Sumtable$interval &lt;- as.character(Sumtable$interval)
## 
## &gt; library(knitr)
## 
## &gt; kable(Sumtable, format = &quot;markdown&quot;, col.names = c(&quot;Interval&quot;, 
## +     &quot;Sample size&quot;, &quot;Mean&quot;, &quot;Lower limit&quot;, &quot;Higher limit&quot;, &quot;SD&quot;))
## 
## 
## |Interval  | Sample size|     Mean| Lower limit| Higher limit|        SD|
## |:---------|-----------:|--------:|-----------:|------------:|---------:|
## |Low       |          58| 2.568966|    2.437666|     2.700265| 0.4995461|
## |Medium    |          48| 3.104167|    2.943089|     3.265244| 0.5550382|
## |Observed  |          45| 3.311111|    3.056488|     3.565734| 0.8480518|
## |miss2year |          41| 3.439024|    3.171549|     3.706499| 0.7761695|
## |detect1   |          44| 3.318182|    3.068182|     3.568182|        NA|
## |detect2   |          42| 3.285714|    3.071429|     3.571429|        NA|
## |detect5   |          40| 3.325000|    3.050000|     3.600000|        NA|
## |longer.56 |          48| 3.458333|    3.165307|     3.751360| 1.0097047|
## 
## &gt; ggplot(Sumtable, aes(y = mY, x = interval)) + geom_point(size = 5) + 
## +     geom_errorbar(aes(ymin = low.qt, ymax = high.qt), width = 0.05, 
## +       .... [TRUNCATED]</code></pre>
<p><img src="A-beginners-guide-to-population-dynamics_files/figure-html/unnamed-chunk-81-12.png" width="672" style="display: block; margin: auto;" /></p>
<div id="plot-steps-1" class="section level3">
<h3><span class="header-section-number">2.0.1</span> Plot steps</h3>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="calves.html#cb164-1"></a><span class="co">## ----raw graph, echo=FALSE, message=FALSE, warning=FALSE-----------------</span></span>
<span id="cb164-2"><a href="calves.html#cb164-2"></a><span class="co">#plot data</span></span>
<span id="cb164-3"><a href="calves.html#cb164-3"></a><span class="kw">ggplot</span>(sum.dat, <span class="kw">aes</span>(<span class="dt">y =</span> mY, <span class="dt">x =</span> year)) <span class="op">+</span></span>
<span id="cb164-4"><a href="calves.html#cb164-4"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb164-5"><a href="calves.html#cb164-5"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb164-6"><a href="calves.html#cb164-6"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> low.qt, <span class="dt">ymax =</span> high.qt), <span class="dt">width =</span> <span class="fl">0.1</span>) <span class="op">+</span></span>
<span id="cb164-7"><a href="calves.html#cb164-7"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="A-beginners-guide-to-population-dynamics_files/figure-html/unnamed-chunk-82-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="calves.html#cb165-1"></a><span class="co"># ## ----raw graph 2, echo=FALSE, fig.height=6, fig.width=6, message=FALSE, warning=FALSE----</span></span>
<span id="cb165-2"><a href="calves.html#cb165-2"></a><span class="co"># </span></span>
<span id="cb165-3"><a href="calves.html#cb165-3"></a><span class="co"># #PLOTS</span></span>
<span id="cb165-4"><a href="calves.html#cb165-4"></a><span class="co"># par(mfrow=c(2,2))</span></span>
<span id="cb165-5"><a href="calves.html#cb165-5"></a><span class="co"># </span></span>
<span id="cb165-6"><a href="calves.html#cb165-6"></a><span class="co"># plot(factor(year2010),xlim=c(0,6),ylim=c(0,40))</span></span>
<span id="cb165-7"><a href="calves.html#cb165-7"></a><span class="co"># title(main=&quot;a)&quot;,sub=&quot;Sample size 3&quot;, ylab=&quot;Frequency&quot;,xlab=&quot;Calving interval&quot;,</span></span>
<span id="cb165-8"><a href="calves.html#cb165-8"></a><span class="co">#       cex.main = 1.5,   font.main= 4, col.main= &quot;blue&quot;,</span></span>
<span id="cb165-9"><a href="calves.html#cb165-9"></a><span class="co">#       cex.sub = 1, font.sub = 3, col.sub = &quot;red&quot;)</span></span>
<span id="cb165-10"><a href="calves.html#cb165-10"></a><span class="co"># box()</span></span>
<span id="cb165-11"><a href="calves.html#cb165-11"></a><span class="co"># </span></span>
<span id="cb165-12"><a href="calves.html#cb165-12"></a><span class="co"># plot(factor(year2011),xlim=c(0,6),ylim=c(0,40))</span></span>
<span id="cb165-13"><a href="calves.html#cb165-13"></a><span class="co"># title(main=&quot;b)&quot;,sub=&quot;Sample size 15&quot;, ylab=&quot;Frequency&quot;,xlab=&quot;Calving interval&quot;,col.main=4,cex.main = 1.5,   font.main= 4, col.main= &quot;blue&quot;,</span></span>
<span id="cb165-14"><a href="calves.html#cb165-14"></a><span class="co">#       cex.sub = 1, font.sub = 3, col.sub = &quot;red&quot;)</span></span>
<span id="cb165-15"><a href="calves.html#cb165-15"></a><span class="co"># box()</span></span>
<span id="cb165-16"><a href="calves.html#cb165-16"></a><span class="co"># </span></span>
<span id="cb165-17"><a href="calves.html#cb165-17"></a><span class="co"># plot(factor(year2012),xlim=c(0,6),ylim=c(0,40))</span></span>
<span id="cb165-18"><a href="calves.html#cb165-18"></a><span class="co"># title(main=&quot;c)&quot;,sub=&quot;Sample size 25&quot;, ylab=&quot;Frequency&quot;,xlab=&quot;Calving interval&quot;,col.main=4,cex.main = 1.5,   font.main= 4, col.main= &quot;blue&quot;,</span></span>
<span id="cb165-19"><a href="calves.html#cb165-19"></a><span class="co">#       cex.sub = 1, font.sub = 3, col.sub = &quot;red&quot;)</span></span>
<span id="cb165-20"><a href="calves.html#cb165-20"></a><span class="co"># box()</span></span>
<span id="cb165-21"><a href="calves.html#cb165-21"></a><span class="co"># </span></span>
<span id="cb165-22"><a href="calves.html#cb165-22"></a><span class="co"># plot(factor(year2013),xlim=c(0,6),ylim=c(0,40))</span></span>
<span id="cb165-23"><a href="calves.html#cb165-23"></a><span class="co"># title(main=&quot;d)&quot;,sub=&quot;Sample size 45&quot;, ylab=&quot;Frequency&quot;,xlab=&quot;Calving interval&quot;,col.main=4,cex.main = 1.5,   font.main= 4, col.main= &quot;blue&quot;,</span></span>
<span id="cb165-24"><a href="calves.html#cb165-24"></a><span class="co">#       cex.sub = 1, font.sub = 3, col.sub = &quot;red&quot;)</span></span>
<span id="cb165-25"><a href="calves.html#cb165-25"></a><span class="co"># box()</span></span>
<span id="cb165-26"><a href="calves.html#cb165-26"></a><span class="co"># </span></span>
<span id="cb165-27"><a href="calves.html#cb165-27"></a><span class="co"># </span></span>
<span id="cb165-28"><a href="calves.html#cb165-28"></a><span class="co"># </span></span>
<span id="cb165-29"><a href="calves.html#cb165-29"></a><span class="co"># ## ----raw graph 3, echo=FALSE, fig.height=6, fig.width=6, message=TRUE, warning=TRUE----</span></span>
<span id="cb165-30"><a href="calves.html#cb165-30"></a><span class="co"># library(qpcR)</span></span>
<span id="cb165-31"><a href="calves.html#cb165-31"></a><span class="co"># #data in one way for plot</span></span>
<span id="cb165-32"><a href="calves.html#cb165-32"></a><span class="co"># rawdata &lt;- qpcR:::cbind.na(year2010,year2011,year2012,year2013)</span></span>
<span id="cb165-33"><a href="calves.html#cb165-33"></a><span class="co"># rawdata &lt;- as.data.frame(rawdata)</span></span>
<span id="cb165-34"><a href="calves.html#cb165-34"></a><span class="co"># </span></span>
<span id="cb165-35"><a href="calves.html#cb165-35"></a><span class="co"># #in correct format for ggplot2</span></span>
<span id="cb165-36"><a href="calves.html#cb165-36"></a><span class="co"># year2010 &lt;- data.frame(year2010,year = c(&quot;2010&quot;))</span></span>
<span id="cb165-37"><a href="calves.html#cb165-37"></a><span class="co"># year2010 &lt;- rename(year2010, interval = year2010, year = year )</span></span>
<span id="cb165-38"><a href="calves.html#cb165-38"></a><span class="co"># year2011 &lt;- data.frame(year2011,year = c(&quot;2011&quot;))</span></span>
<span id="cb165-39"><a href="calves.html#cb165-39"></a><span class="co"># year2011 &lt;- rename(year2011, interval = year2011, year = year )</span></span>
<span id="cb165-40"><a href="calves.html#cb165-40"></a><span class="co"># year2012 &lt;- data.frame(year2012,year = c(&quot;2012&quot;))</span></span>
<span id="cb165-41"><a href="calves.html#cb165-41"></a><span class="co"># year2012 &lt;- rename(year2012, interval = year2012, year = year )</span></span>
<span id="cb165-42"><a href="calves.html#cb165-42"></a><span class="co"># year2013 &lt;- data.frame(year2013,year = c(&quot;2013&quot;))</span></span>
<span id="cb165-43"><a href="calves.html#cb165-43"></a><span class="co"># year2013 &lt;- rename(year2013, interval = year2013, year = year )</span></span>
<span id="cb165-44"><a href="calves.html#cb165-44"></a><span class="co"># ggplotraw &lt;- rbind(year2010,year2011,year2012, year2013)</span></span>
<span id="cb165-45"><a href="calves.html#cb165-45"></a><span class="co"># ggplotraw$interval &lt;- as.numeric(as.character(ggplotraw$interval))</span></span>
<span id="cb165-46"><a href="calves.html#cb165-46"></a><span class="co"># </span></span>
<span id="cb165-47"><a href="calves.html#cb165-47"></a><span class="co"># #sort(year2013$interval) - sort(sample.true)</span></span>
<span id="cb165-48"><a href="calves.html#cb165-48"></a><span class="co"># </span></span>
<span id="cb165-49"><a href="calves.html#cb165-49"></a><span class="co"># </span></span>
<span id="cb165-50"><a href="calves.html#cb165-50"></a><span class="co"># ggplot(year2013,aes(x = interval)) +</span></span>
<span id="cb165-51"><a href="calves.html#cb165-51"></a><span class="co">#     geom_bar(alpha = 1, width = 0.9,fill = &quot;black&quot;) +</span></span>
<span id="cb165-52"><a href="calves.html#cb165-52"></a><span class="co">#     xlab(expression(&quot;Calving&quot;~&quot;interval&quot;~(italic(&quot;years&quot;)))) +</span></span>
<span id="cb165-53"><a href="calves.html#cb165-53"></a><span class="co">#     ylab(expression(&quot;Total&quot;~&quot;number&quot;~&quot;of&quot;~&quot;observations&quot;~(italic(&quot;n&quot;)))) +</span></span>
<span id="cb165-54"><a href="calves.html#cb165-54"></a><span class="co">#     scale_y_continuous(breaks = c(0,5,10,15,20,25,30), limits = c(0,30)) +</span></span>
<span id="cb165-55"><a href="calves.html#cb165-55"></a><span class="co">#     theme(axis.line = element_line(colour = &#39;black&#39;, size = 0.65),</span></span>
<span id="cb165-56"><a href="calves.html#cb165-56"></a><span class="co">#           axis.ticks = element_line(colour = &quot;black&quot;, size = 0.65),</span></span>
<span id="cb165-57"><a href="calves.html#cb165-57"></a><span class="co">#           panel.border = element_blank(),</span></span>
<span id="cb165-58"><a href="calves.html#cb165-58"></a><span class="co">#           panel.grid.major = element_blank(),</span></span>
<span id="cb165-59"><a href="calves.html#cb165-59"></a><span class="co">#           panel.grid.minor = element_blank(),</span></span>
<span id="cb165-60"><a href="calves.html#cb165-60"></a><span class="co">#           legend.key = element_blank(),</span></span>
<span id="cb165-61"><a href="calves.html#cb165-61"></a><span class="co">#           strip.background = element_rect(fill = &quot;white&quot;, colour = &quot;black&quot;, size = 1),</span></span>
<span id="cb165-62"><a href="calves.html#cb165-62"></a><span class="co">#           panel.background = element_rect(fill = &quot;white&quot;,</span></span>
<span id="cb165-63"><a href="calves.html#cb165-63"></a><span class="co">#             colour = NA),</span></span>
<span id="cb165-64"><a href="calves.html#cb165-64"></a><span class="co">#           axis.text = element_text(size = rel(0.8),</span></span>
<span id="cb165-65"><a href="calves.html#cb165-65"></a><span class="co">#             colour = &quot;black&quot;))</span></span>
<span id="cb165-66"><a href="calves.html#cb165-66"></a><span class="co"># #PLOTS</span></span>
<span id="cb165-67"><a href="calves.html#cb165-67"></a><span class="co"># #code to store figure</span></span>
<span id="cb165-68"><a href="calves.html#cb165-68"></a><span class="co"># # png(&quot;Figure_2_NZSRW_calving_interval_2017_highres.png&quot;, width = 12, height = 14.8, units = &#39;cm&#39;, res = 1200)</span></span>
<span id="cb165-69"><a href="calves.html#cb165-69"></a><span class="co"># # dev.off()</span></span>
<span id="cb165-70"><a href="calves.html#cb165-70"></a><span class="co"># </span></span>
<span id="cb165-71"><a href="calves.html#cb165-71"></a><span class="co"># </span></span>
<span id="cb165-72"><a href="calves.html#cb165-72"></a><span class="co"># ## ----missing intervals, echo=FALSE, fig.height=10, message=FALSE, warning=FALSE----</span></span>
<span id="cb165-73"><a href="calves.html#cb165-73"></a><span class="co"># #################################Missing calving intervals################</span></span>
<span id="cb165-74"><a href="calves.html#cb165-74"></a><span class="co"># #Intervals modified by accounting for missed intervals</span></span>
<span id="cb165-75"><a href="calves.html#cb165-75"></a><span class="co"># #Bradford et al. 2008</span></span>
<span id="cb165-76"><a href="calves.html#cb165-76"></a><span class="co"># </span></span>
<span id="cb165-77"><a href="calves.html#cb165-77"></a><span class="co"># #Raw Data</span></span>
<span id="cb165-78"><a href="calves.html#cb165-78"></a><span class="co"># RealCI &lt;- as.numeric(year2013$interval)</span></span>
<span id="cb165-79"><a href="calves.html#cb165-79"></a><span class="co"># </span></span>
<span id="cb165-80"><a href="calves.html#cb165-80"></a><span class="co"># #Confidence interval</span></span>
<span id="cb165-81"><a href="calves.html#cb165-81"></a><span class="co"># xlong &lt;- RealCI</span></span>
<span id="cb165-82"><a href="calves.html#cb165-82"></a><span class="co"># meanlong&lt;-sum(xlong)/length(xlong)</span></span>
<span id="cb165-83"><a href="calves.html#cb165-83"></a><span class="co"># slong&lt;-sd(xlong)</span></span>
<span id="cb165-84"><a href="calves.html#cb165-84"></a><span class="co"># SElong&lt;-slong/(sqrt(length(xlong)))</span></span>
<span id="cb165-85"><a href="calves.html#cb165-85"></a><span class="co"># nlong&lt;-(length(xlong))</span></span>
<span id="cb165-86"><a href="calves.html#cb165-86"></a><span class="co"># #Standard error and confidence intervals</span></span>
<span id="cb165-87"><a href="calves.html#cb165-87"></a><span class="co"># #2 sided t value at the 95% level = 2.093</span></span>
<span id="cb165-88"><a href="calves.html#cb165-88"></a><span class="co"># lowqtlong &lt;- meanlong-(qt(0.975,nlong)*SElong)</span></span>
<span id="cb165-89"><a href="calves.html#cb165-89"></a><span class="co"># highqtlong &lt;- meanlong+(qt(0.975,nlong)*SElong)</span></span>
<span id="cb165-90"><a href="calves.html#cb165-90"></a><span class="co"># </span></span>
<span id="cb165-91"><a href="calves.html#cb165-91"></a><span class="co"># ####################MED CI########################################</span></span>
<span id="cb165-92"><a href="calves.html#cb165-92"></a><span class="co"># # 2x 6&#39;s and 1x 5 replaced with 3threes</span></span>
<span id="cb165-93"><a href="calves.html#cb165-93"></a><span class="co"># MedCI &lt;- c(RealCI[RealCI &lt; 5],3,3,3,3,2,3)</span></span>
<span id="cb165-94"><a href="calves.html#cb165-94"></a><span class="co"># #sort(MedCI)</span></span>
<span id="cb165-95"><a href="calves.html#cb165-95"></a><span class="co"># xmed&lt;-MedCI</span></span>
<span id="cb165-96"><a href="calves.html#cb165-96"></a><span class="co"># meanmed&lt;-sum(xmed)/length(xmed)</span></span>
<span id="cb165-97"><a href="calves.html#cb165-97"></a><span class="co"># smed&lt;-sd(xmed)</span></span>
<span id="cb165-98"><a href="calves.html#cb165-98"></a><span class="co"># SEmed&lt;-smed/(sqrt(length(xmed)))</span></span>
<span id="cb165-99"><a href="calves.html#cb165-99"></a><span class="co"># nmed&lt;-(length(xmed))</span></span>
<span id="cb165-100"><a href="calves.html#cb165-100"></a><span class="co"># </span></span>
<span id="cb165-101"><a href="calves.html#cb165-101"></a><span class="co"># #Standard error and confidence intervals</span></span>
<span id="cb165-102"><a href="calves.html#cb165-102"></a><span class="co"># lowqtmed &lt;- meanmed-(qt(0.975,length(xmed))*SEmed)</span></span>
<span id="cb165-103"><a href="calves.html#cb165-103"></a><span class="co"># highqtmed &lt;- meanmed+(qt(0.975,length(xmed))*SEmed)</span></span>
<span id="cb165-104"><a href="calves.html#cb165-104"></a><span class="co"># </span></span>
<span id="cb165-105"><a href="calves.html#cb165-105"></a><span class="co"># </span></span>
<span id="cb165-106"><a href="calves.html#cb165-106"></a><span class="co"># ############################SHORT CI##################################</span></span>
<span id="cb165-107"><a href="calves.html#cb165-107"></a><span class="co"># #6,5 replaced with 2 year intervals</span></span>
<span id="cb165-108"><a href="calves.html#cb165-108"></a><span class="co"># </span></span>
<span id="cb165-109"><a href="calves.html#cb165-109"></a><span class="co"># LowCI &lt;- c(RealCI[RealCI &lt; 4],3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2)</span></span>
<span id="cb165-110"><a href="calves.html#cb165-110"></a><span class="co"># xshort&lt;-LowCI</span></span>
<span id="cb165-111"><a href="calves.html#cb165-111"></a><span class="co"># meanshort&lt;-mean(xshort)</span></span>
<span id="cb165-112"><a href="calves.html#cb165-112"></a><span class="co"># sshort&lt;-sd(xshort)</span></span>
<span id="cb165-113"><a href="calves.html#cb165-113"></a><span class="co"># SEshort&lt;-sshort/(sqrt(length(xshort)))</span></span>
<span id="cb165-114"><a href="calves.html#cb165-114"></a><span class="co"># </span></span>
<span id="cb165-115"><a href="calves.html#cb165-115"></a><span class="co"># #Standard error and confidence intervals</span></span>
<span id="cb165-116"><a href="calves.html#cb165-116"></a><span class="co"># lowqtshort &lt;- meanshort-(qt(0.975,length(xshort))*SEshort)</span></span>
<span id="cb165-117"><a href="calves.html#cb165-117"></a><span class="co"># highqtshort &lt;- meanshort+(qt(0.975,length(xshort))*SEshort)</span></span>
<span id="cb165-118"><a href="calves.html#cb165-118"></a><span class="co"># </span></span>
<span id="cb165-119"><a href="calves.html#cb165-119"></a><span class="co"># bdata &lt;-qpcR:::cbind.na(RealCI,MedCI,LowCI)</span></span>
<span id="cb165-120"><a href="calves.html#cb165-120"></a><span class="co"># bdata &lt;- as.data.frame(bdata)</span></span>
<span id="cb165-121"><a href="calves.html#cb165-121"></a><span class="co"># </span></span>
<span id="cb165-122"><a href="calves.html#cb165-122"></a><span class="co"># #Structure of data set</span></span>
<span id="cb165-123"><a href="calves.html#cb165-123"></a><span class="co"># #str(bdata)</span></span>
<span id="cb165-124"><a href="calves.html#cb165-124"></a><span class="co"># </span></span>
<span id="cb165-125"><a href="calves.html#cb165-125"></a><span class="co"># </span></span>
<span id="cb165-126"><a href="calves.html#cb165-126"></a><span class="co"># ## ----missing intervals plot, echo=FALSE, fig.height=3.5, fig.width=5.5, message=FALSE, warning=FALSE----</span></span>
<span id="cb165-127"><a href="calves.html#cb165-127"></a><span class="co"># #Basic plots</span></span>
<span id="cb165-128"><a href="calves.html#cb165-128"></a><span class="co"># par(mfrow=c(1,3))</span></span>
<span id="cb165-129"><a href="calves.html#cb165-129"></a><span class="co"># plot(factor(bdata$LowCI),main=&quot;Lowest possible interval&quot;)</span></span>
<span id="cb165-130"><a href="calves.html#cb165-130"></a><span class="co"># plot(factor(bdata$MedCI), main=&quot;Medium possible interval&quot;)</span></span>
<span id="cb165-131"><a href="calves.html#cb165-131"></a><span class="co"># plot(factor(bdata$RealCI),main=&quot;Observed interval&quot;)</span></span>
<span id="cb165-132"><a href="calves.html#cb165-132"></a><span class="co"># </span></span>
<span id="cb165-133"><a href="calves.html#cb165-133"></a><span class="co"># </span></span>
<span id="cb165-134"><a href="calves.html#cb165-134"></a><span class="co"># ## ----missing intervals plot2, fig.height=5.5, fig.width=4.5, message=FALSE, warning=FALSE, include=FALSE----</span></span>
<span id="cb165-135"><a href="calves.html#cb165-135"></a><span class="co"># #Density basic plots</span></span>
<span id="cb165-136"><a href="calves.html#cb165-136"></a><span class="co"># par(mfrow=c(3,1))</span></span>
<span id="cb165-137"><a href="calves.html#cb165-137"></a><span class="co"># plot(density(as.numeric(as.character(LowCI)),bw=.5), main=&quot;Lowest possible interval&quot;)</span></span>
<span id="cb165-138"><a href="calves.html#cb165-138"></a><span class="co"># plot(density(as.numeric(as.character(MedCI)),bw= 0.5), main=&quot;Medium possible interval&quot;)</span></span>
<span id="cb165-139"><a href="calves.html#cb165-139"></a><span class="co"># plot(density(as.numeric(as.character(RealCI)),bw = 0.5),main=&quot;Observed interval&quot;)</span></span>
<span id="cb165-140"><a href="calves.html#cb165-140"></a><span class="co"># </span></span>
<span id="cb165-141"><a href="calves.html#cb165-141"></a><span class="co"># </span></span>
<span id="cb165-142"><a href="calves.html#cb165-142"></a><span class="co"># ## ----missing intervals table, fig.height=8, message=FALSE, warning=FALSE, include=FALSE----</span></span>
<span id="cb165-143"><a href="calves.html#cb165-143"></a><span class="co"># </span></span>
<span id="cb165-144"><a href="calves.html#cb165-144"></a><span class="co"># ###################################SUMMARY############################</span></span>
<span id="cb165-145"><a href="calves.html#cb165-145"></a><span class="co"># #Pull out important information</span></span>
<span id="cb165-146"><a href="calves.html#cb165-146"></a><span class="co"># Sumtable&lt;-data.frame(variable = c(&quot;low.qt&quot;,&quot;mean&quot;,&quot;high.qt&quot;,&quot;sd&quot;, &quot;SE&quot;),                 short=c(lowqtshort,meanshort,highqtshort,sshort,SEshort),</span></span>
<span id="cb165-147"><a href="calves.html#cb165-147"></a><span class="co">#                      medium=c(lowqtmed,meanmed,highqtmed,smed,SEmed),</span></span>
<span id="cb165-148"><a href="calves.html#cb165-148"></a><span class="co">#                      real=c(lowqtlong,meanlong,highqtlong,slong,SElong))</span></span>
<span id="cb165-149"><a href="calves.html#cb165-149"></a><span class="co"># </span></span>
<span id="cb165-150"><a href="calves.html#cb165-150"></a><span class="co"># #Make dataframe to plot</span></span>
<span id="cb165-151"><a href="calves.html#cb165-151"></a><span class="co"># n &lt;- c(length(LowCI),length(MedCI),length(year2013$interval))</span></span>
<span id="cb165-152"><a href="calves.html#cb165-152"></a><span class="co"># mY &lt;- c(mean(LowCI),mean(MedCI),mean(year2013$interval))</span></span>
<span id="cb165-153"><a href="calves.html#cb165-153"></a><span class="co"># interval &lt;-c(&quot;Low&quot;, &quot;Medium&quot;,&quot;Observed&quot;)</span></span>
<span id="cb165-154"><a href="calves.html#cb165-154"></a><span class="co"># low.qt &lt;- c(lowqtshort,lowqtmed,low.qt2013)</span></span>
<span id="cb165-155"><a href="calves.html#cb165-155"></a><span class="co"># high.qt &lt;- c(highqtshort,highqtmed,high.qt2013)</span></span>
<span id="cb165-156"><a href="calves.html#cb165-156"></a><span class="co"># sd &lt;- c(sshort,smed,s2013)</span></span>
<span id="cb165-157"><a href="calves.html#cb165-157"></a><span class="co"># Sumtable &lt;- cbind(interval,n,mY,low.qt,high.qt,sd)</span></span>
<span id="cb165-158"><a href="calves.html#cb165-158"></a><span class="co"># Sumtable &lt;-  as.data.frame(Sumtable)</span></span>
<span id="cb165-159"><a href="calves.html#cb165-159"></a><span class="co"># </span></span>
<span id="cb165-160"><a href="calves.html#cb165-160"></a><span class="co">#  Sumtable$n &lt;- as.numeric(as.character(Sumtable$n))</span></span>
<span id="cb165-161"><a href="calves.html#cb165-161"></a><span class="co">#  Sumtable$mY &lt;- as.numeric(as.character(Sumtable$mY))</span></span>
<span id="cb165-162"><a href="calves.html#cb165-162"></a><span class="co">#  Sumtable$low.qt &lt;- as.numeric(as.character(Sumtable$low.qt))</span></span>
<span id="cb165-163"><a href="calves.html#cb165-163"></a><span class="co">#  Sumtable$high.qt &lt;- as.numeric(as.character(Sumtable$high.qt))</span></span>
<span id="cb165-164"><a href="calves.html#cb165-164"></a><span class="co">#  Sumtable$sd &lt;- as.numeric(as.character(Sumtable$sd))</span></span>
<span id="cb165-165"><a href="calves.html#cb165-165"></a><span class="co">#  Sumtable$interval &lt;- as.character(Sumtable$interval)</span></span>
<span id="cb165-166"><a href="calves.html#cb165-166"></a><span class="co"># </span></span>
<span id="cb165-167"><a href="calves.html#cb165-167"></a><span class="co"># </span></span>
<span id="cb165-168"><a href="calves.html#cb165-168"></a><span class="co"># ## ----missing intervals plot3, echo=FALSE, fig.height=4, message=FALSE, warning=FALSE----</span></span>
<span id="cb165-169"><a href="calves.html#cb165-169"></a><span class="co"># ggplot(Sumtable, aes(y = mY, x = interval)) +</span></span>
<span id="cb165-170"><a href="calves.html#cb165-170"></a><span class="co">#   geom_point(size = 5) +</span></span>
<span id="cb165-171"><a href="calves.html#cb165-171"></a><span class="co">#   geom_errorbar(aes(ymin = low.qt, ymax = high.qt), width = 0.05,size = 1, alpha = 0.5) +</span></span>
<span id="cb165-172"><a href="calves.html#cb165-172"></a><span class="co">#   scale_y_continuous(breaks = round(seq(2.3, 3.6, by = 0.2),1)) +</span></span>
<span id="cb165-173"><a href="calves.html#cb165-173"></a><span class="co">#   labs(y = &quot;Mean calving interval&quot;,x = &quot;Calving interval modification&quot; ) +</span></span>
<span id="cb165-174"><a href="calves.html#cb165-174"></a><span class="co">#   geom_point(size = 3) +</span></span>
<span id="cb165-175"><a href="calves.html#cb165-175"></a><span class="co">#   theme_classic() +</span></span>
<span id="cb165-176"><a href="calves.html#cb165-176"></a><span class="co">#   theme_hc() +</span></span>
<span id="cb165-177"><a href="calves.html#cb165-177"></a><span class="co">#   theme(legend.position=&quot;none&quot;)</span></span>
<span id="cb165-178"><a href="calves.html#cb165-178"></a><span class="co"># </span></span>
<span id="cb165-179"><a href="calves.html#cb165-179"></a><span class="co"># </span></span>
<span id="cb165-180"><a href="calves.html#cb165-180"></a><span class="co"># ## ----missing_data_table, echo=FALSE--------------------------------------</span></span>
<span id="cb165-181"><a href="calves.html#cb165-181"></a><span class="co"># library(knitr)</span></span>
<span id="cb165-182"><a href="calves.html#cb165-182"></a><span class="co"># </span></span>
<span id="cb165-183"><a href="calves.html#cb165-183"></a><span class="co"># kable(Sumtable, format = &quot;markdown&quot;,col.names = c(&quot;Interval&quot;,&quot;Sample size&quot;, &quot;Mean&quot;, &quot;Lower limit&quot;, &quot;Higher limit&quot;, &quot;SD&quot;))</span></span>
<span id="cb165-184"><a href="calves.html#cb165-184"></a><span class="co"># </span></span>
<span id="cb165-185"><a href="calves.html#cb165-185"></a><span class="co"># </span></span>
<span id="cb165-186"><a href="calves.html#cb165-186"></a><span class="co"># </span></span>
<span id="cb165-187"><a href="calves.html#cb165-187"></a><span class="co"># ## ----srw_data_table, echo=FALSE------------------------------------------</span></span>
<span id="cb165-188"><a href="calves.html#cb165-188"></a><span class="co"># library(knitr)</span></span>
<span id="cb165-189"><a href="calves.html#cb165-189"></a><span class="co"># setwd(&quot;C:/Users/s435389/R_packages/Davidson_2017_SRWrepro/Data&quot;)</span></span>
<span id="cb165-190"><a href="calves.html#cb165-190"></a><span class="co"># srwdat &lt;- read.csv(file = &quot;srw_data.csv&quot;)</span></span>
<span id="cb165-191"><a href="calves.html#cb165-191"></a><span class="co"># </span></span>
<span id="cb165-192"><a href="calves.html#cb165-192"></a><span class="co"># #str(srwdat)</span></span>
<span id="cb165-193"><a href="calves.html#cb165-193"></a><span class="co"># kable(srwdat, format = &quot;markdown&quot;,col.names = c(&quot;Sample size&quot;,&quot;Mean&quot;, &quot;Lower limit&quot;, &quot;Higher limit&quot;, &quot;SE&quot;,&quot;Author&quot;, &quot;Location&quot;))</span></span>
<span id="cb165-194"><a href="calves.html#cb165-194"></a><span class="co"># </span></span>
<span id="cb165-195"><a href="calves.html#cb165-195"></a><span class="co"># </span></span>
<span id="cb165-196"><a href="calves.html#cb165-196"></a><span class="co"># </span></span>
<span id="cb165-197"><a href="calves.html#cb165-197"></a><span class="co"># ## ----bootstrap single, echo=FALSE, fig.height=5--------------------------</span></span>
<span id="cb165-198"><a href="calves.html#cb165-198"></a><span class="co"># ############################NZ Simple sample##############################</span></span>
<span id="cb165-199"><a href="calves.html#cb165-199"></a><span class="co"># #WITH replacement</span></span>
<span id="cb165-200"><a href="calves.html#cb165-200"></a><span class="co"># </span></span>
<span id="cb165-201"><a href="calves.html#cb165-201"></a><span class="co"># # to try and match number of intervals observed in other populations</span></span>
<span id="cb165-202"><a href="calves.html#cb165-202"></a><span class="co"># # find references</span></span>
<span id="cb165-203"><a href="calves.html#cb165-203"></a><span class="co"># SAreps &lt;- 1500</span></span>
<span id="cb165-204"><a href="calves.html#cb165-204"></a><span class="co"># ARreps &lt;- 800</span></span>
<span id="cb165-205"><a href="calves.html#cb165-205"></a><span class="co"># Aussiereps &lt;- 2000</span></span>
<span id="cb165-206"><a href="calves.html#cb165-206"></a><span class="co"># low &lt;- 1000</span></span>
<span id="cb165-207"><a href="calves.html#cb165-207"></a><span class="co"># verylow &lt;- 100</span></span>
<span id="cb165-208"><a href="calves.html#cb165-208"></a><span class="co"># lowest &lt;- 10</span></span>
<span id="cb165-209"><a href="calves.html#cb165-209"></a><span class="co"># </span></span>
<span id="cb165-210"><a href="calves.html#cb165-210"></a><span class="co"># #Very raw plots</span></span>
<span id="cb165-211"><a href="calves.html#cb165-211"></a><span class="co"># par(mfrow=c(2,3))</span></span>
<span id="cb165-212"><a href="calves.html#cb165-212"></a><span class="co"># plot(factor(sample(year2013$interval,lowest,replace=T)),main = &quot;3 intervals&quot;)</span></span>
<span id="cb165-213"><a href="calves.html#cb165-213"></a><span class="co"># plot(factor(sample(year2013$interval,verylow,replace=T)),main = &quot;10 intervals&quot;)</span></span>
<span id="cb165-214"><a href="calves.html#cb165-214"></a><span class="co"># plot(factor(sample(year2013$interval,low,replace=T)),main = &quot;30 intervals&quot;)</span></span>
<span id="cb165-215"><a href="calves.html#cb165-215"></a><span class="co"># plot(factor(sample(year2013$interval,Aussiereps,replace=T)),main = &quot;500 intervals&quot;)</span></span>
<span id="cb165-216"><a href="calves.html#cb165-216"></a><span class="co"># plot(factor(sample(year2013$interval,ARreps,replace=T)),main = &quot;800 intervals&quot;)</span></span>
<span id="cb165-217"><a href="calves.html#cb165-217"></a><span class="co"># plot(factor(sample(year2013$interval,SAreps,replace=T)),main = &quot;1500 intervals&quot;)</span></span>
<span id="cb165-218"><a href="calves.html#cb165-218"></a><span class="co"># </span></span>
<span id="cb165-219"><a href="calves.html#cb165-219"></a><span class="co"># </span></span>
<span id="cb165-220"><a href="calves.html#cb165-220"></a><span class="co"># ## ----bootstrap_multiple, echo=FALSE--------------------------------------</span></span>
<span id="cb165-221"><a href="calves.html#cb165-221"></a><span class="co"># #do each one 1000 times</span></span>
<span id="cb165-222"><a href="calves.html#cb165-222"></a><span class="co"># boots &lt;- 1000</span></span>
<span id="cb165-223"><a href="calves.html#cb165-223"></a><span class="co"># n &lt;- c(1:1000)</span></span>
<span id="cb165-224"><a href="calves.html#cb165-224"></a><span class="co"># </span></span>
<span id="cb165-225"><a href="calves.html#cb165-225"></a><span class="co"># </span></span>
<span id="cb165-226"><a href="calves.html#cb165-226"></a><span class="co"># ###########################n10</span></span>
<span id="cb165-227"><a href="calves.html#cb165-227"></a><span class="co"># var10 &lt;- paste0(&quot;n_&quot;, 1:10)</span></span>
<span id="cb165-228"><a href="calves.html#cb165-228"></a><span class="co"># sample10 &lt;-matrix(data = NA, ncol = lowest, nrow = boots)</span></span>
<span id="cb165-229"><a href="calves.html#cb165-229"></a><span class="co"># colnames(sample10) &lt;- as.list(var10)</span></span>
<span id="cb165-230"><a href="calves.html#cb165-230"></a><span class="co"># </span></span>
<span id="cb165-231"><a href="calves.html#cb165-231"></a><span class="co"># for (i in 1:boots) {</span></span>
<span id="cb165-232"><a href="calves.html#cb165-232"></a><span class="co">#                     sample10 [i, ] &lt;- sample(year2013$interval,lowest,replace=T)</span></span>
<span id="cb165-233"><a href="calves.html#cb165-233"></a><span class="co">#                         }  #i</span></span>
<span id="cb165-234"><a href="calves.html#cb165-234"></a><span class="co"># </span></span>
<span id="cb165-235"><a href="calves.html#cb165-235"></a><span class="co"># sample10 &lt;- as.data.frame(sample10)</span></span>
<span id="cb165-236"><a href="calves.html#cb165-236"></a><span class="co"># sample10 &lt;- sample10 %&gt;%</span></span>
<span id="cb165-237"><a href="calves.html#cb165-237"></a><span class="co">#             mutate(mean10 = rowMeans(sample10))</span></span>
<span id="cb165-238"><a href="calves.html#cb165-238"></a><span class="co"># </span></span>
<span id="cb165-239"><a href="calves.html#cb165-239"></a><span class="co"># sample10t &lt;- as.matrix(sample10)</span></span>
<span id="cb165-240"><a href="calves.html#cb165-240"></a><span class="co"># sample10t &lt;-t(sample10t)</span></span>
<span id="cb165-241"><a href="calves.html#cb165-241"></a><span class="co"># </span></span>
<span id="cb165-242"><a href="calves.html#cb165-242"></a><span class="co"># #########################verylow sample size</span></span>
<span id="cb165-243"><a href="calves.html#cb165-243"></a><span class="co"># #set up variable names</span></span>
<span id="cb165-244"><a href="calves.html#cb165-244"></a><span class="co"># var100 &lt;- paste0(&quot;n_&quot;, 1:100)</span></span>
<span id="cb165-245"><a href="calves.html#cb165-245"></a><span class="co"># </span></span>
<span id="cb165-246"><a href="calves.html#cb165-246"></a><span class="co"># sample100 &lt;-matrix(data = NA, ncol = verylow, nrow = boots)</span></span>
<span id="cb165-247"><a href="calves.html#cb165-247"></a><span class="co"># colnames(sample100) &lt;- as.list(var100)</span></span>
<span id="cb165-248"><a href="calves.html#cb165-248"></a><span class="co"># </span></span>
<span id="cb165-249"><a href="calves.html#cb165-249"></a><span class="co"># for (i in 1:boots) {</span></span>
<span id="cb165-250"><a href="calves.html#cb165-250"></a><span class="co">#                     sample100 [i, ] &lt;- sample(year2013$interval,verylow,replace=T)</span></span>
<span id="cb165-251"><a href="calves.html#cb165-251"></a><span class="co">#                         }  #i</span></span>
<span id="cb165-252"><a href="calves.html#cb165-252"></a><span class="co"># </span></span>
<span id="cb165-253"><a href="calves.html#cb165-253"></a><span class="co"># sample100 &lt;- as.data.frame(sample100)</span></span>
<span id="cb165-254"><a href="calves.html#cb165-254"></a><span class="co"># sample100 &lt;- sample100 %&gt;%</span></span>
<span id="cb165-255"><a href="calves.html#cb165-255"></a><span class="co">#             mutate(mean100 = rowMeans(sample100))</span></span>
<span id="cb165-256"><a href="calves.html#cb165-256"></a><span class="co"># </span></span>
<span id="cb165-257"><a href="calves.html#cb165-257"></a><span class="co"># #########################middle one</span></span>
<span id="cb165-258"><a href="calves.html#cb165-258"></a><span class="co"># #set up variable names</span></span>
<span id="cb165-259"><a href="calves.html#cb165-259"></a><span class="co"># var500 &lt;- paste0(&quot;n_&quot;, 1:500)</span></span>
<span id="cb165-260"><a href="calves.html#cb165-260"></a><span class="co"># </span></span>
<span id="cb165-261"><a href="calves.html#cb165-261"></a><span class="co"># sample500 &lt;-matrix(data = NA, ncol = 500, nrow = boots)</span></span>
<span id="cb165-262"><a href="calves.html#cb165-262"></a><span class="co"># colnames(sample500) &lt;- as.list(var500)</span></span>
<span id="cb165-263"><a href="calves.html#cb165-263"></a><span class="co"># </span></span>
<span id="cb165-264"><a href="calves.html#cb165-264"></a><span class="co"># for (i in 1:boots) {</span></span>
<span id="cb165-265"><a href="calves.html#cb165-265"></a><span class="co">#                     sample500 [i, ] &lt;- sample(year2013$interval,500,replace=T)</span></span>
<span id="cb165-266"><a href="calves.html#cb165-266"></a><span class="co">#                         }  #i</span></span>
<span id="cb165-267"><a href="calves.html#cb165-267"></a><span class="co"># </span></span>
<span id="cb165-268"><a href="calves.html#cb165-268"></a><span class="co"># sample500 &lt;- as.data.frame(sample500)</span></span>
<span id="cb165-269"><a href="calves.html#cb165-269"></a><span class="co"># sample500 &lt;- sample500 %&gt;%</span></span>
<span id="cb165-270"><a href="calves.html#cb165-270"></a><span class="co">#             mutate(mean500 = rowMeans(sample500))</span></span>
<span id="cb165-271"><a href="calves.html#cb165-271"></a><span class="co"># </span></span>
<span id="cb165-272"><a href="calves.html#cb165-272"></a><span class="co"># </span></span>
<span id="cb165-273"><a href="calves.html#cb165-273"></a><span class="co"># #########################low sample size</span></span>
<span id="cb165-274"><a href="calves.html#cb165-274"></a><span class="co"># #set up variable names</span></span>
<span id="cb165-275"><a href="calves.html#cb165-275"></a><span class="co"># var1000 &lt;- paste0(&quot;n_&quot;, 1:1000)</span></span>
<span id="cb165-276"><a href="calves.html#cb165-276"></a><span class="co"># </span></span>
<span id="cb165-277"><a href="calves.html#cb165-277"></a><span class="co"># sample1000 &lt;-matrix(data = NA, ncol = low, nrow = boots)</span></span>
<span id="cb165-278"><a href="calves.html#cb165-278"></a><span class="co"># colnames(sample1000) &lt;- as.list(var1000)</span></span>
<span id="cb165-279"><a href="calves.html#cb165-279"></a><span class="co"># </span></span>
<span id="cb165-280"><a href="calves.html#cb165-280"></a><span class="co"># for (i in 1:boots) {</span></span>
<span id="cb165-281"><a href="calves.html#cb165-281"></a><span class="co">#                     sample1000 [i, ] &lt;- sample(year2013$interval,low,replace=T)</span></span>
<span id="cb165-282"><a href="calves.html#cb165-282"></a><span class="co">#                         }  #i</span></span>
<span id="cb165-283"><a href="calves.html#cb165-283"></a><span class="co"># </span></span>
<span id="cb165-284"><a href="calves.html#cb165-284"></a><span class="co"># sample1000 &lt;- as.data.frame(sample1000)</span></span>
<span id="cb165-285"><a href="calves.html#cb165-285"></a><span class="co"># sample1000 &lt;- sample1000 %&gt;%</span></span>
<span id="cb165-286"><a href="calves.html#cb165-286"></a><span class="co">#             mutate(mean1000 = rowMeans(sample1000))</span></span>
<span id="cb165-287"><a href="calves.html#cb165-287"></a><span class="co"># </span></span>
<span id="cb165-288"><a href="calves.html#cb165-288"></a><span class="co"># #########################AUS sample size</span></span>
<span id="cb165-289"><a href="calves.html#cb165-289"></a><span class="co"># #set up variable names</span></span>
<span id="cb165-290"><a href="calves.html#cb165-290"></a><span class="co"># varA &lt;- paste0(&quot;n_&quot;, 1:2000)</span></span>
<span id="cb165-291"><a href="calves.html#cb165-291"></a><span class="co"># </span></span>
<span id="cb165-292"><a href="calves.html#cb165-292"></a><span class="co"># sampleA &lt;-matrix(data = NA, ncol = Aussiereps, nrow =  boots)</span></span>
<span id="cb165-293"><a href="calves.html#cb165-293"></a><span class="co"># colnames(sampleA) &lt;- as.list(varA)</span></span>
<span id="cb165-294"><a href="calves.html#cb165-294"></a><span class="co"># </span></span>
<span id="cb165-295"><a href="calves.html#cb165-295"></a><span class="co"># for (i in 1:boots) {</span></span>
<span id="cb165-296"><a href="calves.html#cb165-296"></a><span class="co">#                     sampleA [i, ] &lt;- sample(year2013$interval,Aussiereps,replace=T)</span></span>
<span id="cb165-297"><a href="calves.html#cb165-297"></a><span class="co">#                         }  #i</span></span>
<span id="cb165-298"><a href="calves.html#cb165-298"></a><span class="co"># </span></span>
<span id="cb165-299"><a href="calves.html#cb165-299"></a><span class="co"># sampleA &lt;- as.data.frame(sampleA)</span></span>
<span id="cb165-300"><a href="calves.html#cb165-300"></a><span class="co"># sampleA &lt;- sampleA %&gt;%</span></span>
<span id="cb165-301"><a href="calves.html#cb165-301"></a><span class="co">#             mutate(meanA = rowMeans(sampleA))</span></span>
<span id="cb165-302"><a href="calves.html#cb165-302"></a><span class="co"># </span></span>
<span id="cb165-303"><a href="calves.html#cb165-303"></a><span class="co"># sampleAt &lt;- t(sampleA)</span></span>
<span id="cb165-304"><a href="calves.html#cb165-304"></a><span class="co"># </span></span>
<span id="cb165-305"><a href="calves.html#cb165-305"></a><span class="co"># for(i in c(1:ncol(sampleA))) {</span></span>
<span id="cb165-306"><a href="calves.html#cb165-306"></a><span class="co">#     sampleA[,i] &lt;- as.numeric(as.character(sampleA[,i]))</span></span>
<span id="cb165-307"><a href="calves.html#cb165-307"></a><span class="co"># }</span></span>
<span id="cb165-308"><a href="calves.html#cb165-308"></a><span class="co"># </span></span>
<span id="cb165-309"><a href="calves.html#cb165-309"></a><span class="co"># </span></span>
<span id="cb165-310"><a href="calves.html#cb165-310"></a><span class="co"># </span></span>
<span id="cb165-311"><a href="calves.html#cb165-311"></a><span class="co"># </span></span>
<span id="cb165-312"><a href="calves.html#cb165-312"></a><span class="co"># #COnfidence intervals</span></span>
<span id="cb165-313"><a href="calves.html#cb165-313"></a><span class="co"># </span></span>
<span id="cb165-314"><a href="calves.html#cb165-314"></a><span class="co"># ab &lt;- sort(sampleA$meanA)</span></span>
<span id="cb165-315"><a href="calves.html#cb165-315"></a><span class="co"># nab &lt;- length(ab)</span></span>
<span id="cb165-316"><a href="calves.html#cb165-316"></a><span class="co"># #low = 25/1000</span></span>
<span id="cb165-317"><a href="calves.html#cb165-317"></a><span class="co"># ab2.5 &lt;- ab[25]</span></span>
<span id="cb165-318"><a href="calves.html#cb165-318"></a><span class="co"># #high = 975/1000</span></span>
<span id="cb165-319"><a href="calves.html#cb165-319"></a><span class="co"># ab0.97.5 &lt;- ab[975]</span></span>
<span id="cb165-320"><a href="calves.html#cb165-320"></a><span class="co"># </span></span>
<span id="cb165-321"><a href="calves.html#cb165-321"></a><span class="co"># ab &lt;- sort(sampleA$meanA)</span></span>
<span id="cb165-322"><a href="calves.html#cb165-322"></a><span class="co"># nab &lt;- length(ab)</span></span>
<span id="cb165-323"><a href="calves.html#cb165-323"></a><span class="co"># #low = 25/1000</span></span>
<span id="cb165-324"><a href="calves.html#cb165-324"></a><span class="co"># ab2.5 &lt;- ab[25]</span></span>
<span id="cb165-325"><a href="calves.html#cb165-325"></a><span class="co"># #high = 975/1000</span></span>
<span id="cb165-326"><a href="calves.html#cb165-326"></a><span class="co"># ab0.97.5 &lt;- ab[975]</span></span>
<span id="cb165-327"><a href="calves.html#cb165-327"></a><span class="co"># </span></span>
<span id="cb165-328"><a href="calves.html#cb165-328"></a><span class="co"># </span></span>
<span id="cb165-329"><a href="calves.html#cb165-329"></a><span class="co"># </span></span>
<span id="cb165-330"><a href="calves.html#cb165-330"></a><span class="co"># ## ----bootstrap plot2, fig.height=5, message=FALSE, warning=FALSE, include=FALSE----</span></span>
<span id="cb165-331"><a href="calves.html#cb165-331"></a><span class="co"># #plot the data over each other to look at change in density</span></span>
<span id="cb165-332"><a href="calves.html#cb165-332"></a><span class="co"># par(mfrow=c(1,1))</span></span>
<span id="cb165-333"><a href="calves.html#cb165-333"></a><span class="co"># #plot(density(sample3$mean3,bw = .15),lwd = 3,lyt = 5, main = &quot;&quot;, xlab = &quot;Calving interval&quot;, box = FALSE,axis = FALSE)</span></span>
<span id="cb165-334"><a href="calves.html#cb165-334"></a><span class="co"># </span></span>
<span id="cb165-335"><a href="calves.html#cb165-335"></a><span class="co"># plot(density(sample10$mean10,bw = .05),col =&quot;black&quot;, lty = 1, main = &quot;&quot;, lwd = 5,ylim = c(0,8),xlim = c(2,4.5), axes=FALSE,xlab = &quot;Calving interval&quot;)</span></span>
<span id="cb165-336"><a href="calves.html#cb165-336"></a><span class="co"># lines(density(sample100$mean100,bw = .05),col =&quot;black&quot;, lty = 2, lwd = 4)</span></span>
<span id="cb165-337"><a href="calves.html#cb165-337"></a><span class="co"># lines(density(sample500$mean500,bw = .05),col =&quot;black&quot;, lty = 3, lwd = 3)</span></span>
<span id="cb165-338"><a href="calves.html#cb165-338"></a><span class="co"># lines(density(sample1000$mean1000,bw = .05),col =&quot;black&quot;, lty = 4, lwd = 2)</span></span>
<span id="cb165-339"><a href="calves.html#cb165-339"></a><span class="co"># lines(density(sampleA$meanA,bw = .05),col =&quot;black&quot;, lty = 5, lwd = 1)</span></span>
<span id="cb165-340"><a href="calves.html#cb165-340"></a><span class="co"># legend(&#39;topright&#39;,title = &quot;Legend&quot;, c(&quot;n=10, cv=8.12 &quot;, &quot;n=100, cv=2.43&quot;, &quot;n=500, c.v=1.15&quot;, &quot;n=1000, cv=0.79&quot;, &quot;n=2000, cv=0.56&quot;),bty = &quot;n&quot;,</span></span>
<span id="cb165-341"><a href="calves.html#cb165-341"></a><span class="co">#   lty = c(1,2,3,4,5), lwd = c(5,4,3,2,1), cex=.75)</span></span>
<span id="cb165-342"><a href="calves.html#cb165-342"></a><span class="co"># axis(1,lwd=2)</span></span>
<span id="cb165-343"><a href="calves.html#cb165-343"></a><span class="co"># axis(2,lwd=2)</span></span>
<span id="cb165-344"><a href="calves.html#cb165-344"></a><span class="co"># </span></span>
<span id="cb165-345"><a href="calves.html#cb165-345"></a><span class="co"># </span></span>
<span id="cb165-346"><a href="calves.html#cb165-346"></a><span class="co"># </span></span>
<span id="cb165-347"><a href="calves.html#cb165-347"></a><span class="co"># ## ----final plot for publication1, echo=FALSE-----------------------------</span></span>
<span id="cb165-348"><a href="calves.html#cb165-348"></a><span class="co"># #final [plot]</span></span>
<span id="cb165-349"><a href="calves.html#cb165-349"></a><span class="co"># #size defined by NZJFMR</span></span>
<span id="cb165-350"><a href="calves.html#cb165-350"></a><span class="co"># #  195 mm (h) ? 148 mm (w).</span></span>
<span id="cb165-351"><a href="calves.html#cb165-351"></a><span class="co"># #ylab(expression(&quot;Total&quot;~&quot;number&quot;~&quot;of&quot;~&quot;observations&quot;~(italic(&quot;n&quot;)))) +</span></span>
<span id="cb165-352"><a href="calves.html#cb165-352"></a><span class="co"># </span></span>
<span id="cb165-353"><a href="calves.html#cb165-353"></a><span class="co"># plot(density(sample10$mean10,bw = .05),col =&quot;black&quot;, lty = 3, main = &quot;&quot;, lwd = 1,ylim = c(0,8),xlim = c(2.5,4.5), axes=FALSE, xlab = expression(&quot;Calving&quot;~&quot;interval&quot;~(italic(&quot;years&quot;))))</span></span>
<span id="cb165-354"><a href="calves.html#cb165-354"></a><span class="co"># lines(density(sample100$mean100,bw = .05),col =&quot;black&quot;, lty = 4, lwd = 1)</span></span>
<span id="cb165-355"><a href="calves.html#cb165-355"></a><span class="co"># lines(density(sample500$mean500,bw = .05),col =&quot;black&quot;, lty = 5, lwd = 1)</span></span>
<span id="cb165-356"><a href="calves.html#cb165-356"></a><span class="co"># lines(density(sample1000$mean1000,bw = .05),col =&quot;black&quot;, lty = 2, lwd = 1)</span></span>
<span id="cb165-357"><a href="calves.html#cb165-357"></a><span class="co"># lines(density(sampleA$meanA,bw = .05),col =&quot;black&quot;, lty = 1, lwd = 2)</span></span>
<span id="cb165-358"><a href="calves.html#cb165-358"></a><span class="co"># legend(y = 8, x = 3.9,title = expression(bold(&quot;Sample size (n)&quot;)), c(expression(italic(&quot;n&quot;)~&quot;=&quot;~&quot;10&quot;), expression(italic(&quot;n&quot;)~&quot;=&quot;~&quot;100&quot;), expression(italic(&quot;n&quot;)~&quot;=&quot;~&quot;500&quot;), expression(italic(&quot;n&quot;)~&quot;=&quot;~&quot;1000&quot;), expression(italic(&quot;n&quot;)~&quot;=&quot;~&quot;2000&quot;)),bty = &quot;n&quot;,</span></span>
<span id="cb165-359"><a href="calves.html#cb165-359"></a><span class="co">#   lty = c(3,4,5,2,1), lwd = c(1,1,1,1,2), cex=1)</span></span>
<span id="cb165-360"><a href="calves.html#cb165-360"></a><span class="co">#  axis(1,lwd=2)</span></span>
<span id="cb165-361"><a href="calves.html#cb165-361"></a><span class="co"># axis(2,lwd=2)</span></span>
<span id="cb165-362"><a href="calves.html#cb165-362"></a><span class="co"># </span></span>
<span id="cb165-363"><a href="calves.html#cb165-363"></a><span class="co"># # PLOT CODE FOR PUBLICATION</span></span>
<span id="cb165-364"><a href="calves.html#cb165-364"></a><span class="co"># # png(&quot;C:/Users/s435389/R_packages/Davidson_2017_SRWrepro/Figures/Figure_3_NZSRW_calving_interval_2017_lowres.png&quot;, width = 14.8, height = 14.8, units = &#39;cm&#39;, res = 400)</span></span>
<span id="cb165-365"><a href="calves.html#cb165-365"></a><span class="co"># # dev.off()</span></span>
<span id="cb165-366"><a href="calves.html#cb165-366"></a><span class="co"># #</span></span>
<span id="cb165-367"><a href="calves.html#cb165-367"></a><span class="co"># #</span></span>
<span id="cb165-368"><a href="calves.html#cb165-368"></a><span class="co"># # png(&quot;C:/Users/s435389/R_packages/Davidson_2017_SRWrepro/Figures/Figure_3_NZSRW_calving_interval_2017_highres.png&quot;, width = 14.8, height = 14.8, units = &#39;cm&#39;, res = 1200)</span></span>
<span id="cb165-369"><a href="calves.html#cb165-369"></a><span class="co"># #</span></span>
<span id="cb165-370"><a href="calves.html#cb165-370"></a><span class="co"># # plot(density(sample10$mean10,bw = .05),col =&quot;black&quot;, lty = 3, main = &quot;&quot;, lwd = 1,ylim = c(0,8),xlim = c(2.5,4.5), axes=FALSE,xlab = expression(&quot;Calving&quot;~&quot;interval&quot;~(italic(&quot;years&quot;))))</span></span>
<span id="cb165-371"><a href="calves.html#cb165-371"></a><span class="co"># # lines(density(sample100$mean100,bw = .05),col =&quot;black&quot;, lty = 4, lwd = 1)</span></span>
<span id="cb165-372"><a href="calves.html#cb165-372"></a><span class="co"># # lines(density(sample500$mean500,bw = .05),col =&quot;black&quot;, lty = 2, lwd = 1)</span></span>
<span id="cb165-373"><a href="calves.html#cb165-373"></a><span class="co"># # lines(density(sample1000$mean1000,bw = .05),col =&quot;black&quot;, lty = 5, lwd = 1)</span></span>
<span id="cb165-374"><a href="calves.html#cb165-374"></a><span class="co"># # lines(density(sampleA$meanA,bw = .05),col =&quot;black&quot;, lty = 1, lwd = 2)</span></span>
<span id="cb165-375"><a href="calves.html#cb165-375"></a><span class="co"># # legend(y = 8, x = 3.9,title = expression(bold(&quot;Sample size (n)&quot;)), c(expression(italic(&quot;n&quot;)~&quot;=&quot;~&quot;10&quot;), expression(italic(&quot;n&quot;)~&quot;=&quot;~&quot;100&quot;), expression(italic(&quot;n&quot;)~&quot;=&quot;~&quot;500&quot;), expression(italic(&quot;n&quot;)~&quot;=&quot;~&quot;1000&quot;), expression(italic(&quot;n&quot;)~&quot;=&quot;~&quot;2000&quot;)),bty = &quot;n&quot;,</span></span>
<span id="cb165-376"><a href="calves.html#cb165-376"></a><span class="co"># #   lty = c(3,4,2,5,1), lwd = c(1,1,1,1,2), cex=1)</span></span>
<span id="cb165-377"><a href="calves.html#cb165-377"></a><span class="co"># # axis(1,lwd=2)</span></span>
<span id="cb165-378"><a href="calves.html#cb165-378"></a><span class="co"># # axis(2,lwd=2)</span></span>
<span id="cb165-379"><a href="calves.html#cb165-379"></a><span class="co"># #</span></span>
<span id="cb165-380"><a href="calves.html#cb165-380"></a><span class="co"># # dev.off()</span></span>
<span id="cb165-381"><a href="calves.html#cb165-381"></a><span class="co"># </span></span>
<span id="cb165-382"><a href="calves.html#cb165-382"></a><span class="co"># </span></span>
<span id="cb165-383"><a href="calves.html#cb165-383"></a><span class="co"># ## ----referee_comment_1, echo=TRUE----------------------------------------</span></span>
<span id="cb165-384"><a href="calves.html#cb165-384"></a><span class="co"># #observed sample</span></span>
<span id="cb165-385"><a href="calves.html#cb165-385"></a><span class="co"># rev.one &lt;- bdata$RealCI[1:45]</span></span>
<span id="cb165-386"><a href="calves.html#cb165-386"></a><span class="co"># </span></span>
<span id="cb165-387"><a href="calves.html#cb165-387"></a><span class="co"># #sample 45 times</span></span>
<span id="cb165-388"><a href="calves.html#cb165-388"></a><span class="co"># sample.true &lt;- year2013$interval</span></span>
<span id="cb165-389"><a href="calves.html#cb165-389"></a><span class="co"># </span></span>
<span id="cb165-390"><a href="calves.html#cb165-390"></a><span class="co"># #power analysis</span></span>
<span id="cb165-391"><a href="calves.html#cb165-391"></a><span class="co"># pwr.test.results &lt;- power.t.test(n = 45,# sample size</span></span>
<span id="cb165-392"><a href="calves.html#cb165-392"></a><span class="co">#              delta = seq(0,0.99,0.001),  #difference between means</span></span>
<span id="cb165-393"><a href="calves.html#cb165-393"></a><span class="co">#              sd = sd(sample.true),      #observed variation</span></span>
<span id="cb165-394"><a href="calves.html#cb165-394"></a><span class="co">#              alternative = &quot;one.sided&quot;, #observed test type</span></span>
<span id="cb165-395"><a href="calves.html#cb165-395"></a><span class="co">#              sig.level = 0.05)          #significance level</span></span>
<span id="cb165-396"><a href="calves.html#cb165-396"></a><span class="co"># </span></span>
<span id="cb165-397"><a href="calves.html#cb165-397"></a><span class="co"># #additional packages are avaliable for more complex analysis</span></span>
<span id="cb165-398"><a href="calves.html#cb165-398"></a><span class="co"># #but have not done this as don&#39;t think it is needed</span></span>
<span id="cb165-399"><a href="calves.html#cb165-399"></a><span class="co"># </span></span>
<span id="cb165-400"><a href="calves.html#cb165-400"></a><span class="co"># </span></span>
<span id="cb165-401"><a href="calves.html#cb165-401"></a><span class="co"># </span></span>
<span id="cb165-402"><a href="calves.html#cb165-402"></a><span class="co"># ## ----referee_comment_1_plot, echo=FALSE, message=FALSE, warning=FALSE----</span></span>
<span id="cb165-403"><a href="calves.html#cb165-403"></a><span class="co"># #sort data into ggplot format</span></span>
<span id="cb165-404"><a href="calves.html#cb165-404"></a><span class="co"># pwr.analysis &lt;- as.data.frame(cbind(</span></span>
<span id="cb165-405"><a href="calves.html#cb165-405"></a><span class="co">#                               pwr.test.results$power,</span></span>
<span id="cb165-406"><a href="calves.html#cb165-406"></a><span class="co">#                               pwr.test.results$delta))</span></span>
<span id="cb165-407"><a href="calves.html#cb165-407"></a><span class="co"># </span></span>
<span id="cb165-408"><a href="calves.html#cb165-408"></a><span class="co"># colnames(pwr.analysis) &lt;- c(&quot;Power&quot;,&quot;Mean.difference&quot;)</span></span>
<span id="cb165-409"><a href="calves.html#cb165-409"></a><span class="co"># </span></span>
<span id="cb165-410"><a href="calves.html#cb165-410"></a><span class="co"># #sort data into ggplot format</span></span>
<span id="cb165-411"><a href="calves.html#cb165-411"></a><span class="co"># pwr.analysis.1 &lt;- pwr.analysis %&gt;%</span></span>
<span id="cb165-412"><a href="calves.html#cb165-412"></a><span class="co">#   mutate(Alpha = 1- Power,</span></span>
<span id="cb165-413"><a href="calves.html#cb165-413"></a><span class="co">#          Mean.estimate = 3.31 + Mean.difference)</span></span>
<span id="cb165-414"><a href="calves.html#cb165-414"></a><span class="co"># # %&gt;%</span></span>
<span id="cb165-415"><a href="calves.html#cb165-415"></a><span class="co"># #   select(Alpha,Mean.estimate)</span></span>
<span id="cb165-416"><a href="calves.html#cb165-416"></a><span class="co"># </span></span>
<span id="cb165-417"><a href="calves.html#cb165-417"></a><span class="co"># #work out where the cut-off is</span></span>
<span id="cb165-418"><a href="calves.html#cb165-418"></a><span class="co"># a &lt;- filter(pwr.analysis.1, Alpha &lt; 0.05)</span></span>
<span id="cb165-419"><a href="calves.html#cb165-419"></a><span class="co"># a[1,]</span></span>
<span id="cb165-420"><a href="calves.html#cb165-420"></a><span class="co"># </span></span>
<span id="cb165-421"><a href="calves.html#cb165-421"></a><span class="co"># #plot data</span></span>
<span id="cb165-422"><a href="calves.html#cb165-422"></a><span class="co"># ggplot(data = pwr.analysis.1, aes(x = Mean.estimate, y = Alpha)) +</span></span>
<span id="cb165-423"><a href="calves.html#cb165-423"></a><span class="co">#   geom_line(size = 1.5) +</span></span>
<span id="cb165-424"><a href="calves.html#cb165-424"></a><span class="co">#   geom_vline(xintercept = 3.903, col = &quot;blue&quot;) +</span></span>
<span id="cb165-425"><a href="calves.html#cb165-425"></a><span class="co">#   geom_hline(yintercept = 0.05) +</span></span>
<span id="cb165-426"><a href="calves.html#cb165-426"></a><span class="co">#   theme(axis.line = element_line(colour = &#39;black&#39;, size = 0.65),</span></span>
<span id="cb165-427"><a href="calves.html#cb165-427"></a><span class="co">#           axis.ticks = element_line(colour = &quot;black&quot;, size = 0.65),</span></span>
<span id="cb165-428"><a href="calves.html#cb165-428"></a><span class="co">#           panel.border = element_blank(),</span></span>
<span id="cb165-429"><a href="calves.html#cb165-429"></a><span class="co">#           panel.grid.major = element_blank(),</span></span>
<span id="cb165-430"><a href="calves.html#cb165-430"></a><span class="co">#           panel.grid.minor = element_blank(),</span></span>
<span id="cb165-431"><a href="calves.html#cb165-431"></a><span class="co">#           legend.key = element_blank(),</span></span>
<span id="cb165-432"><a href="calves.html#cb165-432"></a><span class="co">#           strip.background = element_rect(fill = &quot;white&quot;, colour = &quot;black&quot;, size = 1),</span></span>
<span id="cb165-433"><a href="calves.html#cb165-433"></a><span class="co">#           panel.background = element_rect(fill = &quot;white&quot;,</span></span>
<span id="cb165-434"><a href="calves.html#cb165-434"></a><span class="co">#             colour = NA),</span></span>
<span id="cb165-435"><a href="calves.html#cb165-435"></a><span class="co">#           axis.text = element_text(size = rel(0.8),</span></span>
<span id="cb165-436"><a href="calves.html#cb165-436"></a><span class="co">#             colour = &quot;black&quot;)) +</span></span>
<span id="cb165-437"><a href="calves.html#cb165-437"></a><span class="co">#   ggtitle(&quot;Raw data result plot (n = 45)&quot;)</span></span>
<span id="cb165-438"><a href="calves.html#cb165-438"></a><span class="co"># </span></span>
<span id="cb165-439"><a href="calves.html#cb165-439"></a><span class="co"># </span></span>
<span id="cb165-440"><a href="calves.html#cb165-440"></a><span class="co"># </span></span>
<span id="cb165-441"><a href="calves.html#cb165-441"></a><span class="co"># </span></span>
<span id="cb165-442"><a href="calves.html#cb165-442"></a><span class="co"># </span></span>
<span id="cb165-443"><a href="calves.html#cb165-443"></a><span class="co"># ## ----referee_comment_2_plot, echo=FALSE, message=FALSE, warning=FALSE----</span></span>
<span id="cb165-444"><a href="calves.html#cb165-444"></a><span class="co"># #observed sample</span></span>
<span id="cb165-445"><a href="calves.html#cb165-445"></a><span class="co"># rev.one &lt;- bdata$RealCI[1:45]</span></span>
<span id="cb165-446"><a href="calves.html#cb165-446"></a><span class="co"># </span></span>
<span id="cb165-447"><a href="calves.html#cb165-447"></a><span class="co"># #sample 45 times</span></span>
<span id="cb165-448"><a href="calves.html#cb165-448"></a><span class="co"># sample.true &lt;- year2013$interval</span></span>
<span id="cb165-449"><a href="calves.html#cb165-449"></a><span class="co"># </span></span>
<span id="cb165-450"><a href="calves.html#cb165-450"></a><span class="co"># #difference</span></span>
<span id="cb165-451"><a href="calves.html#cb165-451"></a><span class="co"># diff &lt;- 3.63-3.31  #observed mean of australian population</span></span>
<span id="cb165-452"><a href="calves.html#cb165-452"></a><span class="co"># </span></span>
<span id="cb165-453"><a href="calves.html#cb165-453"></a><span class="co"># #power analysis</span></span>
<span id="cb165-454"><a href="calves.html#cb165-454"></a><span class="co"># pwr.test.results &lt;- power.t.test(n = seq(1,200,1),# sample size</span></span>
<span id="cb165-455"><a href="calves.html#cb165-455"></a><span class="co">#              delta = diff,  #difference between means</span></span>
<span id="cb165-456"><a href="calves.html#cb165-456"></a><span class="co">#              sd = sd(sample.true),      #observed variation</span></span>
<span id="cb165-457"><a href="calves.html#cb165-457"></a><span class="co">#              alternative = &quot;one.sided&quot;, #observed test type</span></span>
<span id="cb165-458"><a href="calves.html#cb165-458"></a><span class="co">#              sig.level = 0.05)          #significance level</span></span>
<span id="cb165-459"><a href="calves.html#cb165-459"></a><span class="co"># </span></span>
<span id="cb165-460"><a href="calves.html#cb165-460"></a><span class="co"># #additional packages are avaliable for more complex analysis</span></span>
<span id="cb165-461"><a href="calves.html#cb165-461"></a><span class="co"># #but have not done this as don&#39;t think it is needed</span></span>
<span id="cb165-462"><a href="calves.html#cb165-462"></a><span class="co"># </span></span>
<span id="cb165-463"><a href="calves.html#cb165-463"></a><span class="co"># #sort data into ggplot format</span></span>
<span id="cb165-464"><a href="calves.html#cb165-464"></a><span class="co"># pwr.analysis &lt;- as.data.frame(cbind(</span></span>
<span id="cb165-465"><a href="calves.html#cb165-465"></a><span class="co">#                               pwr.test.results$power,</span></span>
<span id="cb165-466"><a href="calves.html#cb165-466"></a><span class="co">#                               pwr.test.results$n))</span></span>
<span id="cb165-467"><a href="calves.html#cb165-467"></a><span class="co"># </span></span>
<span id="cb165-468"><a href="calves.html#cb165-468"></a><span class="co"># colnames(pwr.analysis) &lt;- c(&quot;Power&quot;,&quot;Sample.size&quot;)</span></span>
<span id="cb165-469"><a href="calves.html#cb165-469"></a><span class="co"># </span></span>
<span id="cb165-470"><a href="calves.html#cb165-470"></a><span class="co"># #sort data into ggplot format</span></span>
<span id="cb165-471"><a href="calves.html#cb165-471"></a><span class="co"># pwr.analysis.1 &lt;- pwr.analysis %&gt;%</span></span>
<span id="cb165-472"><a href="calves.html#cb165-472"></a><span class="co">#   mutate(Alpha = 1- Power)</span></span>
<span id="cb165-473"><a href="calves.html#cb165-473"></a><span class="co"># # %&gt;%</span></span>
<span id="cb165-474"><a href="calves.html#cb165-474"></a><span class="co"># #   select(Alpha,Mean.estimate)</span></span>
<span id="cb165-475"><a href="calves.html#cb165-475"></a><span class="co"># </span></span>
<span id="cb165-476"><a href="calves.html#cb165-476"></a><span class="co"># #work out where the cut-off is</span></span>
<span id="cb165-477"><a href="calves.html#cb165-477"></a><span class="co"># a &lt;- filter(pwr.analysis.1, Alpha &lt; 0.05)</span></span>
<span id="cb165-478"><a href="calves.html#cb165-478"></a><span class="co"># a[1,]</span></span>
<span id="cb165-479"><a href="calves.html#cb165-479"></a><span class="co"># </span></span>
<span id="cb165-480"><a href="calves.html#cb165-480"></a><span class="co"># #plot data</span></span>
<span id="cb165-481"><a href="calves.html#cb165-481"></a><span class="co"># ggplot(data = pwr.analysis.1, aes(x = Sample.size, y = Alpha)) +</span></span>
<span id="cb165-482"><a href="calves.html#cb165-482"></a><span class="co">#   geom_line(size = 1.5) +</span></span>
<span id="cb165-483"><a href="calves.html#cb165-483"></a><span class="co">#   geom_vline(xintercept = 45, col = &quot;red&quot;) +</span></span>
<span id="cb165-484"><a href="calves.html#cb165-484"></a><span class="co">#   geom_vline(xintercept = 153, col = &quot;blue&quot;) +</span></span>
<span id="cb165-485"><a href="calves.html#cb165-485"></a><span class="co">#   geom_hline(yintercept = 0.05) +</span></span>
<span id="cb165-486"><a href="calves.html#cb165-486"></a><span class="co">#   scale_y_continuous(limits = c(0,1)) +</span></span>
<span id="cb165-487"><a href="calves.html#cb165-487"></a><span class="co">#   theme(axis.line = element_line(colour = &#39;black&#39;, size = 0.65),</span></span>
<span id="cb165-488"><a href="calves.html#cb165-488"></a><span class="co">#           axis.ticks = element_line(colour = &quot;black&quot;, size = 0.65),</span></span>
<span id="cb165-489"><a href="calves.html#cb165-489"></a><span class="co">#           panel.border = element_blank(),</span></span>
<span id="cb165-490"><a href="calves.html#cb165-490"></a><span class="co">#           panel.grid.major = element_blank(),</span></span>
<span id="cb165-491"><a href="calves.html#cb165-491"></a><span class="co">#           panel.grid.minor = element_blank(),</span></span>
<span id="cb165-492"><a href="calves.html#cb165-492"></a><span class="co">#           legend.key = element_blank(),</span></span>
<span id="cb165-493"><a href="calves.html#cb165-493"></a><span class="co">#           strip.background = element_rect(fill = &quot;white&quot;, colour = &quot;black&quot;, size = 1),</span></span>
<span id="cb165-494"><a href="calves.html#cb165-494"></a><span class="co">#           panel.background = element_rect(fill = &quot;white&quot;,</span></span>
<span id="cb165-495"><a href="calves.html#cb165-495"></a><span class="co">#             colour = NA),</span></span>
<span id="cb165-496"><a href="calves.html#cb165-496"></a><span class="co">#           axis.text = element_text(size = rel(0.8),</span></span>
<span id="cb165-497"><a href="calves.html#cb165-497"></a><span class="co">#             colour = &quot;black&quot;)) +</span></span>
<span id="cb165-498"><a href="calves.html#cb165-498"></a><span class="co">#    ggtitle(&quot;Observed difference between Australian and NZ mean&quot;)</span></span>
<span id="cb165-499"><a href="calves.html#cb165-499"></a><span class="co"># </span></span>
<span id="cb165-500"><a href="calves.html#cb165-500"></a><span class="co"># </span></span>
<span id="cb165-501"><a href="calves.html#cb165-501"></a><span class="co"># </span></span>
<span id="cb165-502"><a href="calves.html#cb165-502"></a><span class="co"># ## ----missed individuals 1, echo=FALSE------------------------------------</span></span>
<span id="cb165-503"><a href="calves.html#cb165-503"></a><span class="co"># dat &lt;- read.csv(&quot;C:/Users/s435389/R_packages/Davidson_2017_SRWrepro/Data/raw_observations_2012.csv&quot;)</span></span>
<span id="cb165-504"><a href="calves.html#cb165-504"></a><span class="co"># #data structure</span></span>
<span id="cb165-505"><a href="calves.html#cb165-505"></a><span class="co"># glimpse(dat)</span></span>
<span id="cb165-506"><a href="calves.html#cb165-506"></a><span class="co"># head(dat)</span></span>
<span id="cb165-507"><a href="calves.html#cb165-507"></a><span class="co"># #And the second dataset</span></span>
<span id="cb165-508"><a href="calves.html#cb165-508"></a><span class="co"># dat1&lt;- read.csv(&quot;C:/Users/s435389/R_packages/Davidson_2017_SRWrepro/Data/RawCI.csv&quot;, header=T, quote=&quot;\&quot;&quot;)</span></span>
<span id="cb165-509"><a href="calves.html#cb165-509"></a><span class="co"># #data structure</span></span>
<span id="cb165-510"><a href="calves.html#cb165-510"></a><span class="co"># glimpse(dat1)</span></span>
<span id="cb165-511"><a href="calves.html#cb165-511"></a><span class="co"># </span></span>
<span id="cb165-512"><a href="calves.html#cb165-512"></a><span class="co"># </span></span>
<span id="cb165-513"><a href="calves.html#cb165-513"></a><span class="co"># ## ----missed individuals 2, echo=FALSE, message=FALSE, warning=FALSE------</span></span>
<span id="cb165-514"><a href="calves.html#cb165-514"></a><span class="co"># ##I can then modify this data to</span></span>
<span id="cb165-515"><a href="calves.html#cb165-515"></a><span class="co"># #restructure dataset of capture to long dataset</span></span>
<span id="cb165-516"><a href="calves.html#cb165-516"></a><span class="co"># dat3 &lt;- dplyr::select(dat, ID, X2006:X2012)%&gt;%</span></span>
<span id="cb165-517"><a href="calves.html#cb165-517"></a><span class="co">#                gather(year, count,X2006:X2012)</span></span>
<span id="cb165-518"><a href="calves.html#cb165-518"></a><span class="co"># </span></span>
<span id="cb165-519"><a href="calves.html#cb165-519"></a><span class="co"># #add data on calves</span></span>
<span id="cb165-520"><a href="calves.html#cb165-520"></a><span class="co"># dat4 &lt;- full_join(dat3,dat1, by = &quot;ID&quot;)</span></span>
<span id="cb165-521"><a href="calves.html#cb165-521"></a><span class="co"># dat5 &lt;- dplyr::select(dat4,ID,year,count,Yr.first.seen,Calves,Calves.1,Calves.2)</span></span>
<span id="cb165-522"><a href="calves.html#cb165-522"></a><span class="co"># </span></span>
<span id="cb165-523"><a href="calves.html#cb165-523"></a><span class="co"># dat6 &lt;- filter(dat5,count &gt;0)</span></span>
<span id="cb165-524"><a href="calves.html#cb165-524"></a><span class="co"># glimpse(dat6)</span></span>
<span id="cb165-525"><a href="calves.html#cb165-525"></a><span class="co"># </span></span>
<span id="cb165-526"><a href="calves.html#cb165-526"></a><span class="co"># dat7 &lt;- mutate(dat6, year = ifelse(year == &quot;X2006&quot;,&quot;2006&quot;, year),</span></span>
<span id="cb165-527"><a href="calves.html#cb165-527"></a><span class="co">#             year = ifelse(year == &quot;X2007&quot;,&quot;2007&quot;, year),</span></span>
<span id="cb165-528"><a href="calves.html#cb165-528"></a><span class="co">#             year = ifelse(year == &quot;X2008&quot;,&quot;2008&quot;, year),</span></span>
<span id="cb165-529"><a href="calves.html#cb165-529"></a><span class="co">#             year = ifelse(year == &quot;X2009&quot;,&quot;2009&quot;, year),</span></span>
<span id="cb165-530"><a href="calves.html#cb165-530"></a><span class="co">#             year = ifelse(year == &quot;X2010&quot;,&quot;2010&quot;, year),</span></span>
<span id="cb165-531"><a href="calves.html#cb165-531"></a><span class="co">#             year = ifelse(year == &quot;X2011&quot;,&quot;2011&quot;, year),</span></span>
<span id="cb165-532"><a href="calves.html#cb165-532"></a><span class="co">#             year = ifelse(year == &quot;X2012&quot;,&quot;2012&quot;, year))</span></span>
<span id="cb165-533"><a href="calves.html#cb165-533"></a><span class="co"># </span></span>
<span id="cb165-534"><a href="calves.html#cb165-534"></a><span class="co"># a &lt;- group_by(dat7, ID, Yr.first.seen) %&gt;%</span></span>
<span id="cb165-535"><a href="calves.html#cb165-535"></a><span class="co">#   mutate(mother = ifelse(Yr.first.seen &gt; 0, 1, 0)) %&gt;%</span></span>
<span id="cb165-536"><a href="calves.html#cb165-536"></a><span class="co">#   filter(mother == 1) %&gt;%</span></span>
<span id="cb165-537"><a href="calves.html#cb165-537"></a><span class="co">#   ungroup() %&gt;%</span></span>
<span id="cb165-538"><a href="calves.html#cb165-538"></a><span class="co">#   dplyr::select(ID,year,Calves,Calves.1) %&gt;%</span></span>
<span id="cb165-539"><a href="calves.html#cb165-539"></a><span class="co">#   filter(Calves.1&lt;2013) %&gt;%</span></span>
<span id="cb165-540"><a href="calves.html#cb165-540"></a><span class="co">#   filter(!year == Calves) %&gt;%</span></span>
<span id="cb165-541"><a href="calves.html#cb165-541"></a><span class="co"># filter(!year ==Calves.1)</span></span>
<span id="cb165-542"><a href="calves.html#cb165-542"></a><span class="co"># </span></span>
<span id="cb165-543"><a href="calves.html#cb165-543"></a><span class="co"># a</span></span>
<span id="cb165-544"><a href="calves.html#cb165-544"></a><span class="co"># </span></span>
<span id="cb165-545"><a href="calves.html#cb165-545"></a><span class="co"># </span></span>
<span id="cb165-546"><a href="calves.html#cb165-546"></a><span class="co"># ## ----referee_comment3, echo=TRUE, message=FALSE, warning=FALSE-----------</span></span>
<span id="cb165-547"><a href="calves.html#cb165-547"></a><span class="co"># greater.than.2 &lt;- sample.true[sample.true&gt;2]</span></span>
<span id="cb165-548"><a href="calves.html#cb165-548"></a><span class="co"># </span></span>
<span id="cb165-549"><a href="calves.html#cb165-549"></a><span class="co"># #greater.than.2</span></span>
<span id="cb165-550"><a href="calves.html#cb165-550"></a><span class="co"># mean.2&lt;-sum(greater.than.2)/length(greater.than.2)</span></span>
<span id="cb165-551"><a href="calves.html#cb165-551"></a><span class="co"># s.2&lt;-sd(greater.than.2)</span></span>
<span id="cb165-552"><a href="calves.html#cb165-552"></a><span class="co"># SE.2&lt;-s2013/(sqrt(length(greater.than.2)))</span></span>
<span id="cb165-553"><a href="calves.html#cb165-553"></a><span class="co"># n.2&lt;-length(greater.than.2)</span></span>
<span id="cb165-554"><a href="calves.html#cb165-554"></a><span class="co"># low.qt.2&lt;- mean.2-(qt(0.975,length(greater.than.2))*SE.2)</span></span>
<span id="cb165-555"><a href="calves.html#cb165-555"></a><span class="co"># high.qt.2 &lt;- mean.2+(qt(0.975,length(greater.than.2))*SE.2)</span></span>
<span id="cb165-556"><a href="calves.html#cb165-556"></a><span class="co"># </span></span>
<span id="cb165-557"><a href="calves.html#cb165-557"></a><span class="co"># #add it to the table from bradford data</span></span>
<span id="cb165-558"><a href="calves.html#cb165-558"></a><span class="co"># Sumtable[4,] &lt;- c(&quot;miss2year&quot;,n.2,mean.2,low.qt.2,</span></span>
<span id="cb165-559"><a href="calves.html#cb165-559"></a><span class="co">#                   high.qt.2,sd(greater.than.2))</span></span>
<span id="cb165-560"><a href="calves.html#cb165-560"></a><span class="co"># </span></span>
<span id="cb165-561"><a href="calves.html#cb165-561"></a><span class="co"># </span></span>
<span id="cb165-562"><a href="calves.html#cb165-562"></a><span class="co"># </span></span>
<span id="cb165-563"><a href="calves.html#cb165-563"></a><span class="co"># ## ----different missing intervals 1, echo=TRUE----------------------------</span></span>
<span id="cb165-564"><a href="calves.html#cb165-564"></a><span class="co"># ########################### 2.2%</span></span>
<span id="cb165-565"><a href="calves.html#cb165-565"></a><span class="co"># #parameters</span></span>
<span id="cb165-566"><a href="calves.html#cb165-566"></a><span class="co"># boots &lt;- 1000</span></span>
<span id="cb165-567"><a href="calves.html#cb165-567"></a><span class="co"># n &lt;- c(1:1000)</span></span>
<span id="cb165-568"><a href="calves.html#cb165-568"></a><span class="co"># </span></span>
<span id="cb165-569"><a href="calves.html#cb165-569"></a><span class="co"># ###round all percentages upwards</span></span>
<span id="cb165-570"><a href="calves.html#cb165-570"></a><span class="co"># detect1 &lt;- 44  # (45*1.02) - 45 = 0.9</span></span>
<span id="cb165-571"><a href="calves.html#cb165-571"></a><span class="co"># detect2 &lt;- 42   #  (45*1.05) - 45 = 2.25</span></span>
<span id="cb165-572"><a href="calves.html#cb165-572"></a><span class="co"># detect3 &lt;- 40  # (45*1.10) - 45 = 4.5</span></span>
<span id="cb165-573"><a href="calves.html#cb165-573"></a><span class="co"># </span></span>
<span id="cb165-574"><a href="calves.html#cb165-574"></a><span class="co"># sample2 &lt;-rep(NA, 1000)</span></span>
<span id="cb165-575"><a href="calves.html#cb165-575"></a><span class="co"># sample5 &lt;-rep(NA, 1000)</span></span>
<span id="cb165-576"><a href="calves.html#cb165-576"></a><span class="co"># sample10 &lt;-rep(NA, 1000)</span></span>
<span id="cb165-577"><a href="calves.html#cb165-577"></a><span class="co"># </span></span>
<span id="cb165-578"><a href="calves.html#cb165-578"></a><span class="co"># for (i in 1:boots) {</span></span>
<span id="cb165-579"><a href="calves.html#cb165-579"></a><span class="co">#                     sample2[i]&lt;-mean(sample(year2013$interval,detect1,replace=T))</span></span>
<span id="cb165-580"><a href="calves.html#cb165-580"></a><span class="co">#                     sample5[i]&lt;-mean(sample(year2013$interval,detect2,replace=T))</span></span>
<span id="cb165-581"><a href="calves.html#cb165-581"></a><span class="co">#                     sample10[i]&lt;-mean(sample(year2013$interval,detect3,replace=T))</span></span>
<span id="cb165-582"><a href="calves.html#cb165-582"></a><span class="co">#                         }  #i</span></span>
<span id="cb165-583"><a href="calves.html#cb165-583"></a><span class="co"># </span></span>
<span id="cb165-584"><a href="calves.html#cb165-584"></a><span class="co"># ######################estimates##############</span></span>
<span id="cb165-585"><a href="calves.html#cb165-585"></a><span class="co"># sample2 &lt;- sort(sample2)</span></span>
<span id="cb165-586"><a href="calves.html#cb165-586"></a><span class="co"># #low = 25/1000</span></span>
<span id="cb165-587"><a href="calves.html#cb165-587"></a><span class="co"># sample2.2.5 &lt;- sample2[25]</span></span>
<span id="cb165-588"><a href="calves.html#cb165-588"></a><span class="co"># #median</span></span>
<span id="cb165-589"><a href="calves.html#cb165-589"></a><span class="co"># sample2.50 &lt;- sample2[500]</span></span>
<span id="cb165-590"><a href="calves.html#cb165-590"></a><span class="co"># #high = 975/1000</span></span>
<span id="cb165-591"><a href="calves.html#cb165-591"></a><span class="co"># sample2.975 &lt;- sample2[975]</span></span>
<span id="cb165-592"><a href="calves.html#cb165-592"></a><span class="co"># </span></span>
<span id="cb165-593"><a href="calves.html#cb165-593"></a><span class="co"># sample5 &lt;- sort(sample5)</span></span>
<span id="cb165-594"><a href="calves.html#cb165-594"></a><span class="co"># #low = 25/1000</span></span>
<span id="cb165-595"><a href="calves.html#cb165-595"></a><span class="co"># sample5.2.5 &lt;- sample5[25]</span></span>
<span id="cb165-596"><a href="calves.html#cb165-596"></a><span class="co"># #median</span></span>
<span id="cb165-597"><a href="calves.html#cb165-597"></a><span class="co"># sample5.50 &lt;- sample5[500]</span></span>
<span id="cb165-598"><a href="calves.html#cb165-598"></a><span class="co"># #high = 975/1000</span></span>
<span id="cb165-599"><a href="calves.html#cb165-599"></a><span class="co"># sample5.975 &lt;- sample5[975]</span></span>
<span id="cb165-600"><a href="calves.html#cb165-600"></a><span class="co"># </span></span>
<span id="cb165-601"><a href="calves.html#cb165-601"></a><span class="co"># sample10 &lt;- sort(sample10)</span></span>
<span id="cb165-602"><a href="calves.html#cb165-602"></a><span class="co"># #low = 25/1000</span></span>
<span id="cb165-603"><a href="calves.html#cb165-603"></a><span class="co"># sample10.2.5 &lt;- sample10[25]</span></span>
<span id="cb165-604"><a href="calves.html#cb165-604"></a><span class="co"># #median</span></span>
<span id="cb165-605"><a href="calves.html#cb165-605"></a><span class="co"># sample10.50 &lt;- sample10[500]</span></span>
<span id="cb165-606"><a href="calves.html#cb165-606"></a><span class="co"># #high = 975/1000</span></span>
<span id="cb165-607"><a href="calves.html#cb165-607"></a><span class="co"># sample10.975 &lt;- sample10[975]</span></span>
<span id="cb165-608"><a href="calves.html#cb165-608"></a><span class="co"># </span></span>
<span id="cb165-609"><a href="calves.html#cb165-609"></a><span class="co"># </span></span>
<span id="cb165-610"><a href="calves.html#cb165-610"></a><span class="co"># #add it to the table from bradford data</span></span>
<span id="cb165-611"><a href="calves.html#cb165-611"></a><span class="co"># Sumtable[5,] &lt;- c(&quot;detect1&quot;,detect1,sample2.50,sample2.2.5,sample2.975,NA)</span></span>
<span id="cb165-612"><a href="calves.html#cb165-612"></a><span class="co"># Sumtable[6,] &lt;- c(&quot;detect2&quot;,detect2,sample5.50,sample5.2.5,sample5.975,NA)</span></span>
<span id="cb165-613"><a href="calves.html#cb165-613"></a><span class="co"># Sumtable[7,] &lt;- c(&quot;detect5&quot;,detect3,sample10.50,sample10.2.5,sample10.975,NA)</span></span>
<span id="cb165-614"><a href="calves.html#cb165-614"></a><span class="co"># </span></span>
<span id="cb165-615"><a href="calves.html#cb165-615"></a><span class="co"># </span></span>
<span id="cb165-616"><a href="calves.html#cb165-616"></a><span class="co"># ## ----detection sim.2-----------------------------------------------------</span></span>
<span id="cb165-617"><a href="calves.html#cb165-617"></a><span class="co"># </span></span>
<span id="cb165-618"><a href="calves.html#cb165-618"></a><span class="co"># #be very careful as Dat is just IDS and no id of females with calves</span></span>
<span id="cb165-619"><a href="calves.html#cb165-619"></a><span class="co"># #BUT Data is identified females...</span></span>
<span id="cb165-620"><a href="calves.html#cb165-620"></a><span class="co"># length(Data$ID)</span></span>
<span id="cb165-621"><a href="calves.html#cb165-621"></a><span class="co"># length(dat$ID)</span></span>
<span id="cb165-622"><a href="calves.html#cb165-622"></a><span class="co"># </span></span>
<span id="cb165-623"><a href="calves.html#cb165-623"></a><span class="co"># </span></span>
<span id="cb165-624"><a href="calves.html#cb165-624"></a><span class="co"># </span></span>
<span id="cb165-625"><a href="calves.html#cb165-625"></a><span class="co"># glimpse(Data)</span></span>
<span id="cb165-626"><a href="calves.html#cb165-626"></a><span class="co"># dat.detect &lt;- dplyr::select(Data,ID,Calves,Calves.1, Calves.2) %&gt;%</span></span>
<span id="cb165-627"><a href="calves.html#cb165-627"></a><span class="co">#                   mutate(Calves = factor(Calves),</span></span>
<span id="cb165-628"><a href="calves.html#cb165-628"></a><span class="co">#                          Calves.1 = factor(Calves.1),</span></span>
<span id="cb165-629"><a href="calves.html#cb165-629"></a><span class="co">#                          Calves.2 = factor(Calves.2))</span></span>
<span id="cb165-630"><a href="calves.html#cb165-630"></a><span class="co"># </span></span>
<span id="cb165-631"><a href="calves.html#cb165-631"></a><span class="co"># a &lt;- as.data.frame.matrix(table(Data$ID,Data$Calves))</span></span>
<span id="cb165-632"><a href="calves.html#cb165-632"></a><span class="co"># head(a)</span></span>
<span id="cb165-633"><a href="calves.html#cb165-633"></a><span class="co"># a[,7] &lt;-row.names(a)</span></span>
<span id="cb165-634"><a href="calves.html#cb165-634"></a><span class="co"># colnames(a)[1] &lt;- &quot;y2006&quot;</span></span>
<span id="cb165-635"><a href="calves.html#cb165-635"></a><span class="co"># colnames(a)[2] &lt;- &quot;y2007&quot;</span></span>
<span id="cb165-636"><a href="calves.html#cb165-636"></a><span class="co"># colnames(a)[3] &lt;- &quot;y2008&quot;</span></span>
<span id="cb165-637"><a href="calves.html#cb165-637"></a><span class="co"># colnames(a)[4] &lt;- &quot;y2009&quot;</span></span>
<span id="cb165-638"><a href="calves.html#cb165-638"></a><span class="co"># colnames(a)[5] &lt;- &quot;y2010&quot;</span></span>
<span id="cb165-639"><a href="calves.html#cb165-639"></a><span class="co"># colnames(a)[6] &lt;- &quot;y2011&quot;</span></span>
<span id="cb165-640"><a href="calves.html#cb165-640"></a><span class="co"># colnames(a)[7] &lt;- &quot;ID&quot;</span></span>
<span id="cb165-641"><a href="calves.html#cb165-641"></a><span class="co"># a[,8] &lt;- 0</span></span>
<span id="cb165-642"><a href="calves.html#cb165-642"></a><span class="co"># colnames(a)[8] &lt;- &quot;y2012&quot;</span></span>
<span id="cb165-643"><a href="calves.html#cb165-643"></a><span class="co"># a[,9] &lt;- 0</span></span>
<span id="cb165-644"><a href="calves.html#cb165-644"></a><span class="co"># colnames(a)[9] &lt;- &quot;y2013&quot;</span></span>
<span id="cb165-645"><a href="calves.html#cb165-645"></a><span class="co"># a &lt;- dplyr::select(a,ID,y2006,y2007,y2008, y2009, y2010, y2011, y2012, y2013)</span></span>
<span id="cb165-646"><a href="calves.html#cb165-646"></a><span class="co"># </span></span>
<span id="cb165-647"><a href="calves.html#cb165-647"></a><span class="co"># </span></span>
<span id="cb165-648"><a href="calves.html#cb165-648"></a><span class="co"># b &lt;- as.data.frame.matrix(table(Data$ID,Data$Calves.1))</span></span>
<span id="cb165-649"><a href="calves.html#cb165-649"></a><span class="co"># head(b)</span></span>
<span id="cb165-650"><a href="calves.html#cb165-650"></a><span class="co"># b[,5] &lt;-row.names(b)</span></span>
<span id="cb165-651"><a href="calves.html#cb165-651"></a><span class="co"># colnames(b)[5] &lt;- &quot;ID&quot;</span></span>
<span id="cb165-652"><a href="calves.html#cb165-652"></a><span class="co"># b[,6] &lt;- 0</span></span>
<span id="cb165-653"><a href="calves.html#cb165-653"></a><span class="co"># colnames(b)[6] &lt;- &quot;y2006&quot;</span></span>
<span id="cb165-654"><a href="calves.html#cb165-654"></a><span class="co"># b[,7] &lt;- 0</span></span>
<span id="cb165-655"><a href="calves.html#cb165-655"></a><span class="co"># colnames(b)[7] &lt;- &quot;y2007&quot;</span></span>
<span id="cb165-656"><a href="calves.html#cb165-656"></a><span class="co"># b[,8] &lt;- 0</span></span>
<span id="cb165-657"><a href="calves.html#cb165-657"></a><span class="co"># colnames(b)[8] &lt;- &quot;y2008&quot;</span></span>
<span id="cb165-658"><a href="calves.html#cb165-658"></a><span class="co"># b[,9] &lt;- 0</span></span>
<span id="cb165-659"><a href="calves.html#cb165-659"></a><span class="co"># colnames(b)[9] &lt;- &quot;y2009&quot;</span></span>
<span id="cb165-660"><a href="calves.html#cb165-660"></a><span class="co"># colnames(b)[1] &lt;- &quot;y2010&quot;</span></span>
<span id="cb165-661"><a href="calves.html#cb165-661"></a><span class="co"># colnames(b)[2] &lt;- &quot;y2011&quot;</span></span>
<span id="cb165-662"><a href="calves.html#cb165-662"></a><span class="co"># colnames(b)[3] &lt;- &quot;y2012&quot;</span></span>
<span id="cb165-663"><a href="calves.html#cb165-663"></a><span class="co"># colnames(b)[4] &lt;- &quot;y2013&quot;</span></span>
<span id="cb165-664"><a href="calves.html#cb165-664"></a><span class="co"># b &lt;- dplyr::select(b,ID,y2006,y2007,y2008, y2009, y2010, y2011, y2012, y2013)</span></span>
<span id="cb165-665"><a href="calves.html#cb165-665"></a><span class="co"># </span></span>
<span id="cb165-666"><a href="calves.html#cb165-666"></a><span class="co"># </span></span>
<span id="cb165-667"><a href="calves.html#cb165-667"></a><span class="co"># c &lt;- as.data.frame.matrix(table(Data$ID,Data$Calves.2))</span></span>
<span id="cb165-668"><a href="calves.html#cb165-668"></a><span class="co"># head(c)</span></span>
<span id="cb165-669"><a href="calves.html#cb165-669"></a><span class="co"># colnames(c)[1] &lt;- &quot;y2013&quot;</span></span>
<span id="cb165-670"><a href="calves.html#cb165-670"></a><span class="co"># c[,2] &lt;-row.names(c)</span></span>
<span id="cb165-671"><a href="calves.html#cb165-671"></a><span class="co"># colnames(c)[2] &lt;- &quot;ID&quot;</span></span>
<span id="cb165-672"><a href="calves.html#cb165-672"></a><span class="co"># c[,3] &lt;- 0</span></span>
<span id="cb165-673"><a href="calves.html#cb165-673"></a><span class="co"># colnames(c)[3] &lt;- &quot;y2006&quot;</span></span>
<span id="cb165-674"><a href="calves.html#cb165-674"></a><span class="co"># c[,4] &lt;- 0</span></span>
<span id="cb165-675"><a href="calves.html#cb165-675"></a><span class="co"># colnames(c)[4] &lt;- &quot;y2007&quot;</span></span>
<span id="cb165-676"><a href="calves.html#cb165-676"></a><span class="co"># c[,5] &lt;- 0</span></span>
<span id="cb165-677"><a href="calves.html#cb165-677"></a><span class="co"># colnames(c)[5] &lt;- &quot;y2008&quot;</span></span>
<span id="cb165-678"><a href="calves.html#cb165-678"></a><span class="co"># c[,6] &lt;- 0</span></span>
<span id="cb165-679"><a href="calves.html#cb165-679"></a><span class="co"># colnames(c)[6] &lt;- &quot;y2009&quot;</span></span>
<span id="cb165-680"><a href="calves.html#cb165-680"></a><span class="co"># c[,7] &lt;- 0</span></span>
<span id="cb165-681"><a href="calves.html#cb165-681"></a><span class="co"># colnames(c)[7] &lt;- &quot;y2010&quot;</span></span>
<span id="cb165-682"><a href="calves.html#cb165-682"></a><span class="co"># c[,8] &lt;- 0</span></span>
<span id="cb165-683"><a href="calves.html#cb165-683"></a><span class="co"># colnames(c)[8] &lt;- &quot;y2011&quot;</span></span>
<span id="cb165-684"><a href="calves.html#cb165-684"></a><span class="co"># c[,9] &lt;- 0</span></span>
<span id="cb165-685"><a href="calves.html#cb165-685"></a><span class="co"># colnames(c)[9] &lt;- &quot;y2012&quot;</span></span>
<span id="cb165-686"><a href="calves.html#cb165-686"></a><span class="co"># </span></span>
<span id="cb165-687"><a href="calves.html#cb165-687"></a><span class="co"># c &lt;- dplyr::select(c,ID,y2006,y2007,y2008, y2009, y2010, y2011, y2012,y2013)</span></span>
<span id="cb165-688"><a href="calves.html#cb165-688"></a><span class="co"># </span></span>
<span id="cb165-689"><a href="calves.html#cb165-689"></a><span class="co"># countdat &lt;- rbind(a,b,c)</span></span>
<span id="cb165-690"><a href="calves.html#cb165-690"></a><span class="co"># glimpse(countdat)</span></span>
<span id="cb165-691"><a href="calves.html#cb165-691"></a><span class="co"># head(full.dat)</span></span>
<span id="cb165-692"><a href="calves.html#cb165-692"></a><span class="co"># </span></span>
<span id="cb165-693"><a href="calves.html#cb165-693"></a><span class="co"># full.dat &lt;- group_by(countdat, ID) %&gt;%</span></span>
<span id="cb165-694"><a href="calves.html#cb165-694"></a><span class="co">#   summarise(y2006 = sum(y2006),</span></span>
<span id="cb165-695"><a href="calves.html#cb165-695"></a><span class="co">#             y2007 = sum(y2007),</span></span>
<span id="cb165-696"><a href="calves.html#cb165-696"></a><span class="co">#             y2008 = sum(y2008),</span></span>
<span id="cb165-697"><a href="calves.html#cb165-697"></a><span class="co">#             y2009 = sum(y2009),</span></span>
<span id="cb165-698"><a href="calves.html#cb165-698"></a><span class="co">#             y2010 = sum(y2010),</span></span>
<span id="cb165-699"><a href="calves.html#cb165-699"></a><span class="co">#             y2011 = sum(y2011),</span></span>
<span id="cb165-700"><a href="calves.html#cb165-700"></a><span class="co">#             y2012 = sum(y2012),</span></span>
<span id="cb165-701"><a href="calves.html#cb165-701"></a><span class="co">#             y2013 = sum(y2013))</span></span>
<span id="cb165-702"><a href="calves.html#cb165-702"></a><span class="co"># </span></span>
<span id="cb165-703"><a href="calves.html#cb165-703"></a><span class="co"># 2012-2006</span></span>
<span id="cb165-704"><a href="calves.html#cb165-704"></a><span class="co"># </span></span>
<span id="cb165-705"><a href="calves.html#cb165-705"></a><span class="co"># ##checking....</span></span>
<span id="cb165-706"><a href="calves.html#cb165-706"></a><span class="co"># </span></span>
<span id="cb165-707"><a href="calves.html#cb165-707"></a><span class="co"># sort(Data$ID)</span></span>
<span id="cb165-708"><a href="calves.html#cb165-708"></a><span class="co"># filter(Data, ID == &quot;AI06022&quot;)</span></span>
<span id="cb165-709"><a href="calves.html#cb165-709"></a><span class="co"># filter(Data, ID == &quot;AI08340&quot;)</span></span>
<span id="cb165-710"><a href="calves.html#cb165-710"></a><span class="co"># filter(Data, ID == &quot;AI08343&quot;)</span></span>
<span id="cb165-711"><a href="calves.html#cb165-711"></a><span class="co"># </span></span>
<span id="cb165-712"><a href="calves.html#cb165-712"></a><span class="co"># head(Data)</span></span>
<span id="cb165-713"><a href="calves.html#cb165-713"></a><span class="co"># </span></span>
<span id="cb165-714"><a href="calves.html#cb165-714"></a><span class="co"># </span></span>
<span id="cb165-715"><a href="calves.html#cb165-715"></a><span class="co"># # glimpse(c)</span></span>
<span id="cb165-716"><a href="calves.html#cb165-716"></a><span class="co"># # Data$Calves.1,</span></span>
<span id="cb165-717"><a href="calves.html#cb165-717"></a><span class="co"># # # Spread and gather are complements</span></span>
<span id="cb165-718"><a href="calves.html#cb165-718"></a><span class="co"># # df &lt;- data.frame(x = c(&quot;a&quot;, &quot;b&quot;), y = c(3, 4), z = c(5, 6))</span></span>
<span id="cb165-719"><a href="calves.html#cb165-719"></a><span class="co"># # df %&gt;% spread(x, y) %&gt;% gather(x, y, a:b, na.rm = TRUE)</span></span>
<span id="cb165-720"><a href="calves.html#cb165-720"></a><span class="co"># </span></span>
<span id="cb165-721"><a href="calves.html#cb165-721"></a><span class="co"># </span></span>
<span id="cb165-722"><a href="calves.html#cb165-722"></a><span class="co"># </span></span>
<span id="cb165-723"><a href="calves.html#cb165-723"></a><span class="co"># </span></span>
<span id="cb165-724"><a href="calves.html#cb165-724"></a><span class="co"># ## ----different missing intervals 2---------------------------------------</span></span>
<span id="cb165-725"><a href="calves.html#cb165-725"></a><span class="co"># longer5.6 &lt;- c(sample.true,5,6,6)</span></span>
<span id="cb165-726"><a href="calves.html#cb165-726"></a><span class="co"># </span></span>
<span id="cb165-727"><a href="calves.html#cb165-727"></a><span class="co"># #greater.than.2</span></span>
<span id="cb165-728"><a href="calves.html#cb165-728"></a><span class="co"># mean.56&lt;-sum(longer5.6)/length(longer5.6)</span></span>
<span id="cb165-729"><a href="calves.html#cb165-729"></a><span class="co"># s.56&lt;-sd(longer5.6)</span></span>
<span id="cb165-730"><a href="calves.html#cb165-730"></a><span class="co"># SE.56&lt;-s.56/(sqrt(length(longer5.6)))</span></span>
<span id="cb165-731"><a href="calves.html#cb165-731"></a><span class="co"># n.56&lt;-(length(longer5.6))</span></span>
<span id="cb165-732"><a href="calves.html#cb165-732"></a><span class="co"># low.qt.56&lt;- mean.56-(qt(0.975,length(longer5.6))*SE.56)</span></span>
<span id="cb165-733"><a href="calves.html#cb165-733"></a><span class="co"># high.qt.56 &lt;- mean.56+(qt(0.975,length(longer5.6))*SE.56)</span></span>
<span id="cb165-734"><a href="calves.html#cb165-734"></a><span class="co"># </span></span>
<span id="cb165-735"><a href="calves.html#cb165-735"></a><span class="co"># #add it to the table from bradford data</span></span>
<span id="cb165-736"><a href="calves.html#cb165-736"></a><span class="co"># Sumtable[8,] &lt;- c(&quot;longer.56&quot;,n.56,mean.56,low.qt.56,high.qt.56,sd(longer5.6))</span></span>
<span id="cb165-737"><a href="calves.html#cb165-737"></a><span class="co"># </span></span>
<span id="cb165-738"><a href="calves.html#cb165-738"></a><span class="co"># ###sort out numbering in dataframe</span></span>
<span id="cb165-739"><a href="calves.html#cb165-739"></a><span class="co"># Sumtable &lt;-  as.data.frame(Sumtable)</span></span>
<span id="cb165-740"><a href="calves.html#cb165-740"></a><span class="co"># </span></span>
<span id="cb165-741"><a href="calves.html#cb165-741"></a><span class="co">#  Sumtable$n &lt;- as.numeric(as.character(Sumtable$n))</span></span>
<span id="cb165-742"><a href="calves.html#cb165-742"></a><span class="co">#  Sumtable$mY &lt;- as.numeric(as.character(Sumtable$mY))</span></span>
<span id="cb165-743"><a href="calves.html#cb165-743"></a><span class="co">#  Sumtable$low.qt &lt;- as.numeric(as.character(Sumtable$low.qt))</span></span>
<span id="cb165-744"><a href="calves.html#cb165-744"></a><span class="co">#  Sumtable$high.qt &lt;- as.numeric(as.character(Sumtable$high.qt))</span></span>
<span id="cb165-745"><a href="calves.html#cb165-745"></a><span class="co">#  Sumtable$sd &lt;- as.numeric(as.character(Sumtable$sd))</span></span>
<span id="cb165-746"><a href="calves.html#cb165-746"></a><span class="co">#  Sumtable$interval &lt;- as.character(Sumtable$interval)</span></span>
<span id="cb165-747"><a href="calves.html#cb165-747"></a><span class="co"># </span></span>
<span id="cb165-748"><a href="calves.html#cb165-748"></a><span class="co"># </span></span>
<span id="cb165-749"><a href="calves.html#cb165-749"></a><span class="co"># ## ----missing_data_table 2, echo=FALSE------------------------------------</span></span>
<span id="cb165-750"><a href="calves.html#cb165-750"></a><span class="co"># library(knitr)</span></span>
<span id="cb165-751"><a href="calves.html#cb165-751"></a><span class="co"># </span></span>
<span id="cb165-752"><a href="calves.html#cb165-752"></a><span class="co"># kable(Sumtable, format = &quot;markdown&quot;,col.names = c(&quot;Interval&quot;,&quot;Sample size&quot;, &quot;Mean&quot;, &quot;Lower limit&quot;, &quot;Higher limit&quot;, &quot;SD&quot;))</span></span>
<span id="cb165-753"><a href="calves.html#cb165-753"></a><span class="co"># </span></span>
<span id="cb165-754"><a href="calves.html#cb165-754"></a><span class="co"># </span></span>
<span id="cb165-755"><a href="calves.html#cb165-755"></a><span class="co"># </span></span>
<span id="cb165-756"><a href="calves.html#cb165-756"></a><span class="co"># ## ----referee_comment3_plot, echo=FALSE-----------------------------------</span></span>
<span id="cb165-757"><a href="calves.html#cb165-757"></a><span class="co"># ggplot(Sumtable, aes(y = mY, x = interval)) +</span></span>
<span id="cb165-758"><a href="calves.html#cb165-758"></a><span class="co">#   geom_point(size = 5) +</span></span>
<span id="cb165-759"><a href="calves.html#cb165-759"></a><span class="co">#   geom_errorbar(aes(ymin = low.qt, ymax = high.qt), width = 0.05,size = 1, alpha = 0.5) +</span></span>
<span id="cb165-760"><a href="calves.html#cb165-760"></a><span class="co">#   scale_y_continuous(breaks = round(seq(2.3, 5, by = 0.2),1)) +</span></span>
<span id="cb165-761"><a href="calves.html#cb165-761"></a><span class="co">#   labs(y = &quot;Mean calving interval&quot;,x = &quot;Calving interval modification&quot; ) +</span></span>
<span id="cb165-762"><a href="calves.html#cb165-762"></a><span class="co">#   geom_point(size = 3) +</span></span>
<span id="cb165-763"><a href="calves.html#cb165-763"></a><span class="co">#   theme_classic() +</span></span>
<span id="cb165-764"><a href="calves.html#cb165-764"></a><span class="co">#   theme_hc() +</span></span>
<span id="cb165-765"><a href="calves.html#cb165-765"></a><span class="co">#   theme(legend.position=&quot;none&quot;)</span></span></code></pre></div>
<hr />
</div>
<div id="exercise-4-1" class="section level2">
<h2><span class="header-section-number">2.1</span> Exercise 4</h2>
<p>In these exercises, you will be adapting the code written in this chapter to investigate slightly different questions. You should create a new R script <code>Ex4.R</code> in your working directory for these exercises so your chapter code is left unchanged. Exercise 4A is based solely on the required material and Exercises 4B - 4F are based on the example cases. You should work through each example before attempting each of the later exercises.</p>
<p><em>The solutions to this exercise are found at the end of this book (<a href="#ex4a-answers">here</a>). You are <strong>strongly recommended</strong> to make a good attempt at completing this exercise on your own and only look at the solutions when you are truly stumped.</em></p>
<div id="exercise-4a-required-material-only-1" class="section level3 unnumbered">
<h3>Exercise 4A: Required Material Only</h3>
<p>These questions are based on the material in Sections <a href="ch4.html#randomness">1.1</a> - <a href="ch4.html#mc-summaries">1.5</a> only.</p>
<ol style="list-style-type: decimal">
<li>Simulate flipping an unfair coin (probability of heads = 0.6) 100 times using <code>rbinom()</code>. Count the number of heads and tails.</li>
<li>Simulate flipping the same unfair coin 100 times, but using <code>sample()</code> instead. Determine what fraction of the flips resulted in heads.</li>
<li>Simulate rolling a fair 6-sided die 100 times using <code>sample()</code>. Determine what fraction of the rolls resulted in an even number.</li>
<li>Simulate rolling the same die 100 times, but use the function <code>rmultinom()</code> instead. Look at the help file for details on how to use this function. Determine what fraction of the rolls resulted in an odd number.</li>
</ol>
<p><a href="#ex4a-answers">Solutions</a></p>
</div>
<div id="exercise-4b-test-rnorm-1" class="section level3 unnumbered">
<h3>Exercise 4B: Test <code>rnorm</code></h3>
<p>These questions will require you to adapt the code written in Section <a href="ch4.html#rnorm-ex">1.6.1</a></p>
<ol style="list-style-type: decimal">
<li>Adapt this example to investigate another univariate probability distribution, like <code>-lnorm()</code>, <code>-pois()</code>, or <code>-beta()</code>. See the help files (e.g., <code>?rpois</code>) for details on how to use each function.</li>
</ol>
<p><a href="#ex4b-answers">Solutions</a></p>
</div>
<div id="exercise-4c-stochastic-power-analysis-1" class="section level3 unnumbered">
<h3>Exercise 4C: Stochastic Power Analysis</h3>
<p>These questions will require you to adapt the code written in Section <a href="ch4.html#power-ex">1.6.2</a></p>
<ol style="list-style-type: decimal">
<li>What sample size <code>n</code> do you need to have a power of 0.8 of detecting a significant difference between the two tagging methods?</li>
<li>How do the inferences from the power analysis change if you are interested in <code>p_new = 0.4</code> instead of <code>p_new = 0.25</code>? Do you need to tag more or fewer fish in this case?</li>
<li>Your analysis takes a bit of time to run so you are interested in tracking its progress. Add a progress message to your nested <code>for()</code> loop that will print the sample size currently being analyzed:</li>
</ol>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="calves.html#cb166-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb166-2"><a href="calves.html#cb166-2"></a>  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\r</span><span class="st">&quot;</span>, <span class="st">&quot;Sample Size = &quot;</span>, n_try[n])</span>
<span id="cb166-3"><a href="calves.html#cb166-3"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>I) {</span>
<span id="cb166-4"><a href="calves.html#cb166-4"></a>    ...</span>
<span id="cb166-5"><a href="calves.html#cb166-5"></a>  }</span>
<span id="cb166-6"><a href="calves.html#cb166-6"></a>}</span></code></pre></div>
<p><a href="#ex4c-answers">Solutions</a></p>
</div>
<div id="exercise-4d-harvest-policy-analysis-1" class="section level3 unnumbered">
<h3>Exercise 4D: Harvest Policy Analysis</h3>
<p>These questions will require you to adapt the code written in Section <a href="ch4.html#harv-ex">1.6.3</a></p>
<ol style="list-style-type: decimal">
<li>Add an argument to <code>ricker_sim()</code> that will give the user an option to create a plot that shows the time series of recruitment, harvest, and escapement all on the same plot. Set the default to be to not plot the result, in case you forget to turn it off before performing the Monte Carlo analysis.</li>
<li>Add an <em>error handler</em> to <code>ricker_sim()</code> that will cause the function to return an error <code>if()</code> the names of the vector passed to the <code>param</code> argument arent what the function is expecting. You can use <code>stop("Error Message Goes Here")</code> to have your function stop and return an error.</li>
<li>How do the results of the trade-off analysis differ if the process error was larger (a larger value of <span class="math inline">\(\sigma\)</span>)?</li>
<li>Add implementation error to the harvest policy. That is, if the target exploitation rate is <span class="math inline">\(U\)</span>, make the real exploitation rate in year <span class="math inline">\(y\)</span> be: <span class="math inline">\(U_y \sim Beta(a,b)\)</span>, where <span class="math inline">\(a = 100U\)</span> and <span class="math inline">\(b = 100(1-U)\)</span>. You can make there be more implementation error by inserting a smaller number other than 100 here. How does this affect the trade-off analysis?</li>
</ol>
<p><a href="#ex4d-answers">Solutions</a></p>
</div>
<div id="exercise-4e-the-bootstrap-1" class="section level3 unnumbered">
<h3>Exercise 4E: The Bootstrap</h3>
<p>These questions will require you to adapt the code written in Section <a href="ch4.html#boot-test-ex">1.7.1</a></p>
<ol style="list-style-type: decimal">
<li>Replicate the bootstrap analysis, but adapt it for the linear regression example in Section <a href="#regression"><strong>??</strong></a>. Stop at the step where you summarize the 95% interval range.</li>
<li>Compare the 95% bootstrap confidence intervals to the intervals you get by running the <code>predict()</code> function on the original data set with the argument <code>interval = "confidence"</code>.</li>
</ol>
<p><a href="#ex4e-answers">Solutions</a></p>
</div>
<div id="exercise-4f-permutation-tests-1" class="section level3 unnumbered">
<h3>Exercise 4F: Permutation Tests</h3>
<p>These questions will require you to adapt the code written in Section <a href="ch4.html#perm-test-ex">1.7.2</a></p>
<ol style="list-style-type: decimal">
<li>Adapt the code to perform a permutation test for the difference in each of the zooplankton densities between treatments. Dont forget to fix the missing value in the <code>chao</code> variable. See <a href="#ex1b">Exercise 2</a> for more details on this.</li>
<li>Adapt the code to perform a permutation test for another data set used in this book where there are observations of both a categorical variable and a continuous variable. The data sets <code>sockeye.csv</code>, <code>growth.csv</code>, or <code>creel.csv</code> should be good starting points.</li>
<li>Add a calculation of the p-value for a one-tailed test (i.e., that the difference in means is greater or less than zero). Steps 1 - 4 are the same: all you need is <code>Dnull</code> and <code>Dobs</code>. Dont be afraid to Google this if you are confused.</li>
</ol>
<p><a href="#ex4f-answers">Solutions</a></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch4.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch6.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["A beginners guide to population dynamics.docx"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
