<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Base R Plotting Basics | Introduction to R for Natural Resource Scientists</title>
  <meta name="description" content="This is a first course in R programming for natural resource scientists. It was developed and has been primarily instructed at Auburn University." />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Base R Plotting Basics | Introduction to R for Natural Resource Scientists" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a first course in R programming for natural resource scientists. It was developed and has been primarily instructed at Auburn University." />
  <meta name="github-repo" content="bstaton1/au-r-workshop" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Base R Plotting Basics | Introduction to R for Natural Resource Scientists" />
  
  <meta name="twitter:description" content="This is a first course in R programming for natural resource scientists. It was developed and has been primarily instructed at Auburn University." />
  

<meta name="author" content="Ben Staton" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch1.html"/>
<link rel="next" href="ch3.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.2/leaflet.js"></script>
<script src="libs/leaflet-providers-1.1.17/leaflet-providers.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.2/leaflet-providers-plugin.js"></script>
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.css" rel="stylesheet" />
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.Default.css" rel="stylesheet" />
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Intro to R for Nat. Res. Sci.</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-is-covered"><i class="fa fa-check"></i>What is Covered?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#comp-prep"><i class="fa fa-check"></i>Prepare Your Computer</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#exercises"><i class="fa fa-check"></i>Exercises</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#notation"><i class="fa fa-check"></i>Text Conventions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#keyboard-shortcuts"><i class="fa fa-check"></i>Keyboard Shortcuts</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#development-of-this-book"><i class="fa fa-check"></i>Development of this Book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the Author</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="ch1.html"><a href="ch1.html"><i class="fa fa-check"></i><b>1</b> Introduction to the R Environment</a><ul>
<li class="chapter" data-level="" data-path="ch1.html"><a href="ch1.html#chapter-overview"><i class="fa fa-check"></i>Chapter Overview</a></li>
<li class="chapter" data-level="" data-path="ch1.html"><a href="ch1.html#before-you-begin"><i class="fa fa-check"></i>Before You Begin</a></li>
<li class="chapter" data-level="1.1" data-path="ch1.html"><a href="ch1.html#the-r-studio-interface"><i class="fa fa-check"></i><b>1.1</b> The R Studio Interface</a><ul>
<li class="chapter" data-level="1.1.1" data-path="ch1.html"><a href="ch1.html#write-some-simple-code"><i class="fa fa-check"></i><b>1.1.1</b> Write Some Simple Code</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="ch1.html"><a href="ch1.html#scripts"><i class="fa fa-check"></i><b>1.2</b> Saving Your Code: Scripts</a></li>
<li class="chapter" data-level="1.3" data-path="ch1.html"><a href="ch1.html#working-dir"><i class="fa fa-check"></i><b>1.3</b> The Working Directory</a></li>
<li class="chapter" data-level="1.4" data-path="ch1.html"><a href="ch1.html#r-object-types"><i class="fa fa-check"></i><b>1.4</b> R Object Types</a><ul>
<li class="chapter" data-level="1.4.1" data-path="ch1.html"><a href="ch1.html#functions"><i class="fa fa-check"></i><b>1.4.1</b> Functions</a></li>
<li class="chapter" data-level="1.4.2" data-path="ch1.html"><a href="ch1.html#vectors"><i class="fa fa-check"></i><b>1.4.2</b> Vectors</a></li>
<li class="chapter" data-level="1.4.3" data-path="ch1.html"><a href="ch1.html#matrices"><i class="fa fa-check"></i><b>1.4.3</b> Matrices</a></li>
<li class="chapter" data-level="1.4.4" data-path="ch1.html"><a href="ch1.html#data-frames"><i class="fa fa-check"></i><b>1.4.4</b> Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="ch1.html"><a href="ch1.html#factors"><i class="fa fa-check"></i><b>1.5</b> Factors</a></li>
<li class="chapter" data-level="1.6" data-path="ch1.html"><a href="ch1.html#vector-math"><i class="fa fa-check"></i><b>1.6</b> Vector Math</a></li>
<li class="chapter" data-level="1.7" data-path="ch1.html"><a href="ch1.html#sub"><i class="fa fa-check"></i><b>1.7</b> Data Subsets/Queries</a></li>
<li class="chapter" data-level="" data-path="ch1.html"><a href="ch1.html#exercise-1a"><i class="fa fa-check"></i>Exercise 1A</a></li>
<li class="chapter" data-level="1.8" data-path="ch1.html"><a href="ch1.html#read"><i class="fa fa-check"></i><b>1.8</b> Read External Data Files</a></li>
<li class="chapter" data-level="1.9" data-path="ch1.html"><a href="ch1.html#data-summaries"><i class="fa fa-check"></i><b>1.9</b> Explore the Data Set</a></li>
<li class="chapter" data-level="1.10" data-path="ch1.html"><a href="ch1.html#logicalboolean-operators"><i class="fa fa-check"></i><b>1.10</b> Logical/Boolean Operators</a></li>
<li class="chapter" data-level="1.11" data-path="ch1.html"><a href="ch1.html#logsub"><i class="fa fa-check"></i><b>1.11</b> Logical Subsetting</a></li>
<li class="chapter" data-level="1.12" data-path="ch1.html"><a href="ch1.html#if-else-and-ifelse"><i class="fa fa-check"></i><b>1.12</b> <code>if()</code>, <code>else</code>, and <code>ifelse()</code></a></li>
<li class="chapter" data-level="1.13" data-path="ch1.html"><a href="ch1.html#writing-output-files"><i class="fa fa-check"></i><b>1.13</b> Writing Output Files</a><ul>
<li class="chapter" data-level="1.13.1" data-path="ch1.html"><a href="ch1.html#csv-files"><i class="fa fa-check"></i><b>1.13.1</b> <code>.csv</code> Files</a></li>
<li class="chapter" data-level="1.13.2" data-path="ch1.html"><a href="ch1.html#saving-r-objects"><i class="fa fa-check"></i><b>1.13.2</b> Saving R Objects</a></li>
</ul></li>
<li class="chapter" data-level="1.14" data-path="ch1.html"><a href="ch1.html#user-funcs"><i class="fa fa-check"></i><b>1.14</b> User-Defined Functions</a></li>
<li class="chapter" data-level="" data-path="ch1.html"><a href="ch1.html#ex1b"><i class="fa fa-check"></i>Exercise 1B</a><ul>
<li class="chapter" data-level="" data-path="ch1.html"><a href="ch1.html#exercise-1b-bonus"><i class="fa fa-check"></i>Exercise 1B Bonus</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ch2.html"><a href="ch2.html"><i class="fa fa-check"></i><b>2</b> Base R Plotting Basics</a><ul>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#chapter-overview-1"><i class="fa fa-check"></i>Chapter Overview</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#before-you-begin-1"><i class="fa fa-check"></i>Before You Begin</a></li>
<li class="chapter" data-level="2.1" data-path="ch2.html"><a href="ch2.html#r-plotting-lingo"><i class="fa fa-check"></i><b>2.1</b> R Plotting Lingo</a></li>
<li class="chapter" data-level="2.2" data-path="ch2.html"><a href="ch2.html#lower-level-plotting-functions"><i class="fa fa-check"></i><b>2.2</b> Lower Level Plotting Functions</a></li>
<li class="chapter" data-level="2.3" data-path="ch2.html"><a href="ch2.html#other-high-level-plotting-functions"><i class="fa fa-check"></i><b>2.3</b> Other High-Level Plotting Functions</a><ul>
<li class="chapter" data-level="2.3.1" data-path="ch2.html"><a href="ch2.html#the-bar-graph"><i class="fa fa-check"></i><b>2.3.1</b> The Bar Graph</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="ch2.html"><a href="ch2.html#box-whisker"><i class="fa fa-check"></i><b>2.4</b> Box-and-Whisker Plots</a></li>
<li class="chapter" data-level="2.5" data-path="ch2.html"><a href="ch2.html#histograms"><i class="fa fa-check"></i><b>2.5</b> Histograms</a></li>
<li class="chapter" data-level="2.6" data-path="ch2.html"><a href="ch2.html#the-par-function"><i class="fa fa-check"></i><b>2.6</b> The <code>par()</code> Function</a></li>
<li class="chapter" data-level="2.7" data-path="ch2.html"><a href="ch2.html#new-temporary-devices"><i class="fa fa-check"></i><b>2.7</b> New Temporary Devices</a></li>
<li class="chapter" data-level="2.8" data-path="ch2.html"><a href="ch2.html#multi-panel-plots"><i class="fa fa-check"></i><b>2.8</b> Multi-panel Plots</a></li>
<li class="chapter" data-level="2.9" data-path="ch2.html"><a href="ch2.html#legends"><i class="fa fa-check"></i><b>2.9</b> Legends</a></li>
<li class="chapter" data-level="2.10" data-path="ch2.html"><a href="ch2.html#exporting-plots"><i class="fa fa-check"></i><b>2.10</b> Exporting Plots</a><ul>
<li class="chapter" data-level="2.10.1" data-path="ch2.html"><a href="ch2.html#click-save"><i class="fa fa-check"></i><b>2.10.1</b> Click Save</a></li>
<li class="chapter" data-level="2.10.2" data-path="ch2.html"><a href="ch2.html#file-devices"><i class="fa fa-check"></i><b>2.10.2</b> Use a function to place plot in a new file</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="ch2.html"><a href="ch2.html#error-bars"><i class="fa fa-check"></i><b>2.11</b> Bonus Topic: Error Bars</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#ex2"><i class="fa fa-check"></i>Exercise 2</a><ul>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#exercise-2-bonus"><i class="fa fa-check"></i>EXERCISE 2 BONUS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ch3.html"><a href="ch3.html"><i class="fa fa-check"></i><b>3</b> Basic Statistics</a><ul>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#chapter-overview-2"><i class="fa fa-check"></i>Chapter Overview</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#before-you-begin-2"><i class="fa fa-check"></i>Before You Begin</a></li>
<li class="chapter" data-level="3.1" data-path="ch3.html"><a href="ch3.html#lm"><i class="fa fa-check"></i><b>3.1</b> The General Linear Model</a><ul>
<li class="chapter" data-level="3.1.1" data-path="ch3.html"><a href="ch3.html#regression"><i class="fa fa-check"></i><b>3.1.1</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="3.1.2" data-path="ch3.html"><a href="ch3.html#anova"><i class="fa fa-check"></i><b>3.1.2</b> ANOVA: Categorical predictors</a></li>
<li class="chapter" data-level="3.1.3" data-path="ch3.html"><a href="ch3.html#ancova-continuous-and-categorical-predictors"><i class="fa fa-check"></i><b>3.1.3</b> ANCOVA: Continuous and categorical predictors</a></li>
<li class="chapter" data-level="3.1.4" data-path="ch3.html"><a href="ch3.html#interactions"><i class="fa fa-check"></i><b>3.1.4</b> Interactions</a></li>
<li class="chapter" data-level="3.1.5" data-path="ch3.html"><a href="ch3.html#aic-model-selection"><i class="fa fa-check"></i><b>3.1.5</b> AIC Model Selection</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="ch3.html"><a href="ch3.html#glms"><i class="fa fa-check"></i><b>3.2</b> The Generalized Linear Model</a><ul>
<li class="chapter" data-level="3.2.1" data-path="ch3.html"><a href="ch3.html#logis-regression"><i class="fa fa-check"></i><b>3.2.1</b> Logistic Regression</a></li>
<li class="chapter" data-level="3.2.2" data-path="ch3.html"><a href="ch3.html#aic-model-selection-1"><i class="fa fa-check"></i><b>3.2.2</b> AIC Model Selection</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ch3.html"><a href="ch3.html#dists"><i class="fa fa-check"></i><b>3.3</b> Probability Distributions</a></li>
<li class="chapter" data-level="3.4" data-path="ch3.html"><a href="ch3.html#nls"><i class="fa fa-check"></i><b>3.4</b> Bonus Topic: Non-linear Regression</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a><ul>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#exercise-3-bonus"><i class="fa fa-check"></i>Exercise 3 Bonus</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ch4.html"><a href="ch4.html"><i class="fa fa-check"></i><b>4</b> Monte Carlo Methods</a><ul>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#chapter-overview-3"><i class="fa fa-check"></i>Chapter Overview</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#before-you-begin-3"><i class="fa fa-check"></i>Before You Begin</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#layout-of-this-chapter"><i class="fa fa-check"></i>Layout of This Chapter</a></li>
<li class="chapter" data-level="4.1" data-path="ch4.html"><a href="ch4.html#randomness"><i class="fa fa-check"></i><b>4.1</b> Introducing Randomness</a><ul>
<li class="chapter" data-level="4.1.1" data-path="ch4.html"><a href="ch4.html#random-deviates"><i class="fa fa-check"></i><b>4.1.1</b> Random deviates</a></li>
<li class="chapter" data-level="4.1.2" data-path="ch4.html"><a href="ch4.html#resampling"><i class="fa fa-check"></i><b>4.1.2</b> Resampling</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="ch4.html"><a href="ch4.html#reproducing-randomness"><i class="fa fa-check"></i><b>4.2</b> Reproducing Randomness</a></li>
<li class="chapter" data-level="4.3" data-path="ch4.html"><a href="ch4.html#replication"><i class="fa fa-check"></i><b>4.3</b> Replication</a><ul>
<li class="chapter" data-level="4.3.1" data-path="ch4.html"><a href="ch4.html#replicate"><i class="fa fa-check"></i><b>4.3.1</b> <code>replicate()</code></a></li>
<li class="chapter" data-level="4.3.2" data-path="ch4.html"><a href="ch4.html#for-loops"><i class="fa fa-check"></i><b>4.3.2</b> The <code>for()</code> loop</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ch4.html"><a href="ch4.html#adv-funcs"><i class="fa fa-check"></i><b>4.4</b> Function Writing</a></li>
<li class="chapter" data-level="4.5" data-path="ch4.html"><a href="ch4.html#mc-summaries"><i class="fa fa-check"></i><b>4.5</b> Summarization</a><ul>
<li class="chapter" data-level="4.5.1" data-path="ch4.html"><a href="ch4.html#central-tendency"><i class="fa fa-check"></i><b>4.5.1</b> Central Tendency</a></li>
<li class="chapter" data-level="4.5.2" data-path="ch4.html"><a href="ch4.html#variability"><i class="fa fa-check"></i><b>4.5.2</b> Variability</a></li>
<li class="chapter" data-level="4.5.3" data-path="ch4.html"><a href="ch4.html#frequencies"><i class="fa fa-check"></i><b>4.5.3</b> Frequencies</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="ch4.html"><a href="ch4.html#sim-examples"><i class="fa fa-check"></i><b>4.6</b> Simulation-Based Examples</a><ul>
<li class="chapter" data-level="4.6.1" data-path="ch4.html"><a href="ch4.html#rnorm-ex"><i class="fa fa-check"></i><b>4.6.1</b> Test <code>rnorm</code></a></li>
<li class="chapter" data-level="4.6.2" data-path="ch4.html"><a href="ch4.html#power-ex"><i class="fa fa-check"></i><b>4.6.2</b> Stochastic Power Analysis</a></li>
<li class="chapter" data-level="4.6.3" data-path="ch4.html"><a href="ch4.html#harv-ex"><i class="fa fa-check"></i><b>4.6.3</b> Harvest Policy Analysis</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="ch4.html"><a href="ch4.html#resample-examples"><i class="fa fa-check"></i><b>4.7</b> Resampling-Based Examples</a><ul>
<li class="chapter" data-level="4.7.1" data-path="ch4.html"><a href="ch4.html#boot-test-ex"><i class="fa fa-check"></i><b>4.7.1</b> The Bootstrap</a></li>
<li class="chapter" data-level="4.7.2" data-path="ch4.html"><a href="ch4.html#perm-test-ex"><i class="fa fa-check"></i><b>4.7.2</b> Permutation Test</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="ch4.html"><a href="ch4.html#exercise-4"><i class="fa fa-check"></i><b>4.8</b> Exercise 4</a><ul>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#exercise-4a-required-material-only"><i class="fa fa-check"></i>Exercise 4A: Required Material Only</a></li>
<li><a href="ch4.html#exercise-4b-test-rnorm">Exercise 4B: Test <code>rnorm</code></a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#exercise-4c-stochastic-power-analysis"><i class="fa fa-check"></i>Exercise 4C: Stochastic Power Analysis</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#exercise-4d-harvest-policy-analysis"><i class="fa fa-check"></i>Exercise 4D: Harvest Policy Analysis</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#exercise-4e-the-bootstrap"><i class="fa fa-check"></i>Exercise 4E: The Bootstrap</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#exercise-4f-permutation-tests"><i class="fa fa-check"></i>Exercise 4F: Permutation Tests</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ch5.html"><a href="ch5.html"><i class="fa fa-check"></i><b>5</b> Large Data Manipulation</a><ul>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#chapter-overview-4"><i class="fa fa-check"></i>Chapter Overview</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#before-you-begin-4"><i class="fa fa-check"></i>Before You Begin</a></li>
<li class="chapter" data-level="5.1" data-path="ch5.html"><a href="ch5.html#aquiring-and-loading-packages"><i class="fa fa-check"></i><b>5.1</b> Aquiring and Loading Packages</a></li>
<li class="chapter" data-level="5.2" data-path="ch5.html"><a href="ch5.html#the-data"><i class="fa fa-check"></i><b>5.2</b> The Data</a></li>
<li class="chapter" data-level="5.3" data-path="ch5.html"><a href="ch5.html#change-format-using-melt"><i class="fa fa-check"></i><b>5.3</b> Change format using <code>melt()</code></a></li>
<li class="chapter" data-level="5.4" data-path="ch5.html"><a href="ch5.html#join-data-sets-with-merge"><i class="fa fa-check"></i><b>5.4</b> Join Data Sets with <code>merge()</code></a></li>
<li class="chapter" data-level="5.5" data-path="ch5.html"><a href="ch5.html#lagged-vectors"><i class="fa fa-check"></i><b>5.5</b> Lagged vectors</a></li>
<li class="chapter" data-level="5.6" data-path="ch5.html"><a href="ch5.html#adding-columns-with-mutate"><i class="fa fa-check"></i><b>5.6</b> Adding columns with <code>mutate()</code></a></li>
<li class="chapter" data-level="5.7" data-path="ch5.html"><a href="ch5.html#apply-to-all-years"><i class="fa fa-check"></i><b>5.7</b> Apply to all years</a></li>
<li class="chapter" data-level="5.8" data-path="ch5.html"><a href="ch5.html#calculate-daily-means-with-summarize"><i class="fa fa-check"></i><b>5.8</b> Calculate Daily Means with <code>summarize()</code></a></li>
<li class="chapter" data-level="5.9" data-path="ch5.html"><a href="ch5.html#more-summarize"><i class="fa fa-check"></i><b>5.9</b> More <code>summarize()</code></a></li>
<li class="chapter" data-level="5.10" data-path="ch5.html"><a href="ch5.html#fit-the-model"><i class="fa fa-check"></i><b>5.10</b> Fit the Model</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#exercise-5"><i class="fa fa-check"></i>Exercise 5</a><ul>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#exercise-5-bonus"><i class="fa fa-check"></i>Exercise 5 Bonus</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ch6.html"><a href="ch6.html"><i class="fa fa-check"></i><b>6</b> Mapping and Spatial Analysis</a><ul>
<li class="chapter" data-level="6.1" data-path="ch6.html"><a href="ch6.html#ch6overview"><i class="fa fa-check"></i><b>6.1</b> Chapter Overview</a></li>
<li class="chapter" data-level="6.2" data-path="ch6.html"><a href="ch6.html#ch6beforeyoubegin"><i class="fa fa-check"></i><b>6.2</b> Before You Begin</a></li>
<li class="chapter" data-level="6.3" data-path="ch6.html"><a href="ch6.html#intro"><i class="fa fa-check"></i><b>6.3</b> Geospatial Data</a></li>
<li class="chapter" data-level="6.4" data-path="ch6.html"><a href="ch6.html#Import"><i class="fa fa-check"></i><b>6.4</b> Importing Geospatial Data</a><ul>
<li class="chapter" data-level="6.4.1" data-path="ch6.html"><a href="ch6.html#csv-files-1"><i class="fa fa-check"></i><b>6.4.1</b> <code>.csv</code> files</a></li>
<li class="chapter" data-level="6.4.2" data-path="ch6.html"><a href="ch6.html#shp-files"><i class="fa fa-check"></i><b>6.4.2</b> <code>.shp</code> files</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="ch6.html"><a href="ch6.html#SpatPlot"><i class="fa fa-check"></i><b>6.5</b> Plotting</a><ul>
<li class="chapter" data-level="6.5.1" data-path="ch6.html"><a href="ch6.html#zoom"><i class="fa fa-check"></i><b>6.5.1</b> Zooming</a></li>
<li class="chapter" data-level="6.5.2" data-path="ch6.html"><a href="ch6.html#plot-selections"><i class="fa fa-check"></i><b>6.5.2</b> Plotting Selections</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="ch6.html"><a href="ch6.html#ManipSpat"><i class="fa fa-check"></i><b>6.6</b> Manipulating Spatial Data</a><ul>
<li class="chapter" data-level="6.6.1" data-path="ch6.html"><a href="ch6.html#crs"><i class="fa fa-check"></i><b>6.6.1</b> Changing the CRS</a></li>
<li class="chapter" data-level="6.6.2" data-path="ch6.html"><a href="ch6.html#clip"><i class="fa fa-check"></i><b>6.6.2</b> Clipping</a></li>
<li class="chapter" data-level="6.6.3" data-path="ch6.html"><a href="ch6.html#add-attr"><i class="fa fa-check"></i><b>6.6.3</b> Adding Attributes</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="ch6.html"><a href="ch6.html#Anal"><i class="fa fa-check"></i><b>6.7</b> Analysis</a><ul>
<li class="chapter" data-level="6.7.1" data-path="ch6.html"><a href="ch6.html#hr-Anal"><i class="fa fa-check"></i><b>6.7.1</b> Home Range Analysis</a></li>
<li class="chapter" data-level="6.7.2" data-path="ch6.html"><a href="ch6.html#finding-intersections-between-two-layers"><i class="fa fa-check"></i><b>6.7.2</b> Finding Intersections Between Two Layers</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="ch6.html"><a href="ch6.html#base-maps"><i class="fa fa-check"></i><b>6.8</b> Creating a Presentable Map</a></li>
<li class="chapter" data-level="6.9" data-path="ch6.html"><a href="ch6.html#other-r-mapping-packages"><i class="fa fa-check"></i><b>6.9</b> Other R Mapping Packages</a><ul>
<li class="chapter" data-level="6.9.1" data-path="ch6.html"><a href="ch6.html#ggmap"><i class="fa fa-check"></i><b>6.9.1</b> <code>{ggmap}</code></a></li>
<li class="chapter" data-level="6.9.2" data-path="ch6.html"><a href="ch6.html#leaflet"><i class="fa fa-check"></i><b>6.9.2</b> <code>{leaflet}</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#ex6"><i class="fa fa-check"></i>Exercise 6</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#exercise-6-bonus"><i class="fa fa-check"></i>Exercise 6 Bonus</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-solutions.html"><a href="exercise-solutions.html"><i class="fa fa-check"></i>Exercise Solutions</a><ul>
<li class="chapter" data-level="" data-path="exercise-solutions.html"><a href="exercise-solutions.html#ex2-answers"><i class="fa fa-check"></i>Exercise 1 Solutions</a><ul>
<li class="chapter" data-level="" data-path="exercise-solutions.html"><a href="exercise-solutions.html#ex1a-answers"><i class="fa fa-check"></i>Exercise 1A Solutions</a></li>
<li class="chapter" data-level="" data-path="exercise-solutions.html"><a href="exercise-solutions.html#ex1b-answers"><i class="fa fa-check"></i>Exercise 1B Solutions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-solutions.html"><a href="exercise-solutions.html#ex2-answers"><i class="fa fa-check"></i>Exercise 2 Solutions</a></li>
<li class="chapter" data-level="" data-path="exercise-solutions.html"><a href="exercise-solutions.html#ex3-answers"><i class="fa fa-check"></i>Exercise 3 Solutions</a></li>
<li class="chapter" data-level="" data-path="exercise-solutions.html"><a href="exercise-solutions.html#ex4-answers"><i class="fa fa-check"></i>Exercise 4 Solutions</a><ul>
<li class="chapter" data-level="" data-path="exercise-solutions.html"><a href="exercise-solutions.html#ex4a-answers"><i class="fa fa-check"></i>Exercise 4A Solutions</a></li>
<li class="chapter" data-level="" data-path="exercise-solutions.html"><a href="exercise-solutions.html#ex4b-answers"><i class="fa fa-check"></i>Exercise 4B Solutions</a></li>
<li class="chapter" data-level="" data-path="exercise-solutions.html"><a href="exercise-solutions.html#ex4c-answers"><i class="fa fa-check"></i>Exercise 4C Solutions</a></li>
<li class="chapter" data-level="" data-path="exercise-solutions.html"><a href="exercise-solutions.html#ex4d-answers"><i class="fa fa-check"></i>Exercise 4D Solutions</a></li>
<li class="chapter" data-level="" data-path="exercise-solutions.html"><a href="exercise-solutions.html#ex4e-answers"><i class="fa fa-check"></i>Exercise 4E Solutions</a></li>
<li class="chapter" data-level="" data-path="exercise-solutions.html"><a href="exercise-solutions.html#ex4f-answers"><i class="fa fa-check"></i>Exercise 4F Solutions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-solutions.html"><a href="exercise-solutions.html#ex5-answers"><i class="fa fa-check"></i>Exercise 5 Solutions</a></li>
<li class="chapter" data-level="" data-path="exercise-solutions.html"><a href="exercise-solutions.html#ex6-answers"><i class="fa fa-check"></i>Exercise 6 Solutions</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/davan690/au-r-workshop" target="blank">Get the Data</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to R for Natural Resource Scientists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch2" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Base R Plotting Basics</h1>
<div id="chapter-overview-1" class="section level2 unnumbered">
<h2>Chapter Overview</h2>
<p>In this chapter, you will get familiar with the basics of using R for making plots and figures. You will learn:</p>
<ul>
<li>how to make various plots including:
<ul>
<li>scatterplots</li>
<li>line plots</li>
<li>bar plots</li>
<li>box-and-whisker plots</li>
<li>histograms</li>
</ul></li>
<li>the basics of how to change plot features like:
<ul>
<li>the text displayed on axes labels</li>
<li>the size and type of point symbols</li>
<li>the color of features</li>
</ul></li>
<li>the basics of multi-panel plotting</li>
<li>the basics of the <code>par()</code> function</li>
<li>how to save your plot to an external file</li>
</ul>
<p>R’s base <code>{graphics}</code> plotting package is incredibly versatile, and as you will see, it doesn’t take much to get started making professional-looking graphs. It is worth mentioning that there are other R packages<a href="exercise-solutions.html#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a> for plotting that have nice features. The R packages <code>{ggplot2}</code> <span class="citation">(Wickham and Chang <a href="#ref-R-ggplot2" role="doc-biblioref">2016</a>)</span> and <code>{lattice}</code> <span class="citation">(Sarkar <a href="#ref-R-lattice" role="doc-biblioref">2017</a>)</span> are good examples. However, they can be more complex to learn at first than the base R plotting capabilities and look a bit different.</p>
<p><strong>IMPORTANT NOTE</strong>: If you did not attend the sessions corresponding to Chapter <a href="ch1.html#ch1">1</a>, you are recommended to walk through the material found in that chapter before proceeding to this material. Also note that if you are confused about a topic, you can use <strong>CTRL + F</strong> to find previous cases where that topic has been discussed in this book.</p>
</div>
<div id="before-you-begin-1" class="section level2 unnumbered">
<h2>Before You Begin</h2>
<p>You should create a new directory and R script for your work in this Chapter. Create a new R script called <code>Ch2.R</code> and save it in the directory <code>C:/Users/YOU/Documents/R-Book/Chapter2</code>. Set your working directory to that location. Revisit Sections <a href="ch1.html#scripts">1.2</a> and <a href="ch1.html#working-dir">1.3</a> for more details on these steps.</p>
</div>
<div id="r-plotting-lingo" class="section level2">
<h2><span class="header-section-number">2.1</span> R Plotting Lingo</h2>
<p>Learning some terminology will help you get used to the base R graphics system:</p>
<ul>
<li>A <strong>high-level plotting function</strong> is one that is used to make a new graph. Examples of higher level plotting functions are the general <code>plot()</code> and the <code>barplot()</code> functions. When-a high level plotting function is executed, the currently-displayed plot (if any) is written over.</li>
<li>A <strong>low-level plotting function</strong> is one that is used to modify a plot that has already been created. You must already have made a plot using a high-level plotting function before you use low-level plotting functions. Examples include <code>text()</code>, <code>points()</code>, and <code>lines()</code>. When a low-level plotting function is executed, the output is simply added to an existing plot.</li>
<li>The <strong>graphics device</strong> is the area in which a plot is displayed. RStudio has a built in graphics device in its interface (lower right by default in the “Plots” tab), or you can create a new device. R will plot on the active device, which is the most recently created device. There can only be one active device at a time.</li>
</ul>
<p>Here is an example of a basic R plot:</p>
<p><img src="au-r-workshop_files/figure-html/unnamed-chunk-76-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>There are a few components:</p>
<ul>
<li>The <strong>plotting region</strong>: all data information is displayed here.</li>
<li>The <strong>margin</strong>: where axis labels, tick marks, and main plot titles are located</li>
<li>The <strong>outer margin</strong>: by default, there is no outer margin. You can add one if you want to add text here or make more room around the edges.</li>
</ul>
<p>You can change just about everything there is about this plot to suit your tastes. Duplicate this plot, but make the x-axis, y-axis, and main titles something other than the placeholders shown here:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="ch2.html#cb158-1"></a><span class="co"># plot dummy data</span></span>
<span id="cb158-2"><a href="ch2.html#cb158-2"></a>x =<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">10</span></span>
<span id="cb158-3"><a href="ch2.html#cb158-3"></a>y =<span class="st"> </span>x<span class="op">^</span><span class="dv">2</span></span>
<span id="cb158-4"><a href="ch2.html#cb158-4"></a><span class="kw">plot</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y,</span>
<span id="cb158-5"><a href="ch2.html#cb158-5"></a>     <span class="dt">xlab =</span> <span class="st">&quot;x-axis label goes here&quot;</span>, </span>
<span id="cb158-6"><a href="ch2.html#cb158-6"></a>     <span class="dt">ylab =</span> <span class="st">&quot;y-axis label goes here&quot;</span>,</span>
<span id="cb158-7"><a href="ch2.html#cb158-7"></a>     <span class="dt">main =</span> <span class="st">&quot;Main Plot Title Goes Here&quot;</span>)</span></code></pre></div>
<p>Note that the first two arguments, <code>x</code> and <code>y</code>, specify the coordinates of the points (i.e., the first point is placed at coordinates <code>x[1]</code>,<code>y[1]</code>). <code>plot()</code> has <em>tons</em> of arguments (or <em>graphical parameters</em> as the help file found using <code>?plot</code> or <code>?par</code> calls them) that change how the plot looks. Note that when you want something displayed verbatim on the plotting device, you must wrap that code in <code>" "</code>, i.e., the arguments <code>xlab</code>, <code>ylab</code>, and <code>main</code> all receive a character vector of length 1 as input.</p>
<p>Table <a href="ch2.html#tab:plot-arg-table-html">2.1</a> shows information on just a handful of the plotting settings to get you started.</p>
<table>
<caption>
<span id="tab:plot-arg-table-html">Table 2.1: </span>Several of the key arguments to high- and low-level plotting functions
</caption>
<thead>
<tr>
<th style="text-align:left;">
Arg.
</th>
<th style="text-align:left;">
Usage
</th>
<th style="text-align:left;">
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<code>xlab</code>
</td>
<td style="text-align:left;">
<code>xlab = 'X-AXIS'</code>
</td>
<td style="text-align:left;">
changes the x-axis label text
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>ylab</code>
</td>
<td style="text-align:left;">
<code>ylab = 'Y-AXIS'</code>
</td>
<td style="text-align:left;">
changes the y-axis label text
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>main</code>
</td>
<td style="text-align:left;">
<code>main = 'TITLE'</code>
</td>
<td style="text-align:left;">
changes the main title text
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>cex</code>
</td>
<td style="text-align:left;">
<code>cex = 1.5</code>
</td>
<td style="text-align:left;">
changes the size of symbols in the plotting region<a href="exercise-solutions.html#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>pch</code>
</td>
<td style="text-align:left;">
<code>pch = 17</code>
</td>
<td style="text-align:left;">
changes the symbol type<a href="exercise-solutions.html#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>xlim</code>
</td>
<td style="text-align:left;">
<code>xlim = range(x)</code>
</td>
<td style="text-align:left;">
changes the endpoints (limits) of the x-axis<a href="exercise-solutions.html#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>ylim</code>
</td>
<td style="text-align:left;">
<code>ylim = c(0,1)</code>
</td>
<td style="text-align:left;">
same as <code>xlim</code>, but for the y-axis
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>type</code>
</td>
<td style="text-align:left;">
<code>type = 'l'</code>
</td>
<td style="text-align:left;">
changes the way points are connected by lines<a href="exercise-solutions.html#fn16" class="footnote-ref" id="fnref16"><sup>16</sup></a>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>lty</code>
</td>
<td style="text-align:left;">
<code>lty = 2</code>
</td>
<td style="text-align:left;">
changes the line type<a href="exercise-solutions.html#fn17" class="footnote-ref" id="fnref17"><sup>17</sup></a>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>lwd</code>
</td>
<td style="text-align:left;">
<code>lwd = 2</code>
</td>
<td style="text-align:left;">
changes the line width<a href="exercise-solutions.html#fn18" class="footnote-ref" id="fnref18"><sup>18</sup></a>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>col</code>
</td>
<td style="text-align:left;">
<code>col = 'blue'</code>
</td>
<td style="text-align:left;">
changes the color of plotted objects<a href="exercise-solutions.html#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a>
</td>
</tr>
</tbody>
</table>
<p>You are advised to try at least some of the arguments in Table <a href="ch2.html#tab:plot-arg-table-html">2.1</a> out for yourself with your <code>plot(x, y)</code> code from above - notice how every time you run <code>plot()</code>, a whole new plot is created, not just the thing you changed. There are definitely other options: check out <code>?plot</code> or <code>?par</code> for more details.</p>
</div>
<div id="lower-level-plotting-functions" class="section level2">
<h2><span class="header-section-number">2.2</span> Lower Level Plotting Functions</h2>
<p>Now that you have a base plot designed to your liking, you might want to add some additional “layers” to it to represent more data or other kind of information like an additional label or text. Add some more points to your plot by putting this line right beneath your <code>plot(x,y)</code> code and run just the <code>points()</code> line (make sure your device is showing a plot first):</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="ch2.html#cb159-1"></a><span class="co"># rev() reverses a vector: so the old x[1] is x[11] now</span></span>
<span id="cb159-2"><a href="ch2.html#cb159-2"></a><span class="kw">points</span>(<span class="dt">x =</span> <span class="kw">rev</span>(x), <span class="dt">y =</span> y, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>)</span></code></pre></div>
<p><img src="au-r-workshop_files/figure-html/unnamed-chunk-79-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Here, <code>points()</code> acted like a low-level plotting function because it added points to a plot you already made. Many of the arguments shown in Table <a href="ch2.html#tab:plot-arg-table-html">2.1</a> can be used in both high-level and low-level plotting functions (notice how <code>col</code> and <code>pch</code> were used in <code>points()</code>). Just like <code>points()</code>, there is also <code>lines()</code>:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="ch2.html#cb160-1"></a><span class="kw">lines</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> x, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="au-r-workshop_files/figure-html/unnamed-chunk-81-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>You can add text to the plotting region:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="ch2.html#cb161-1"></a><span class="kw">text</span>(<span class="dt">x =</span> <span class="dv">5</span>, <span class="dt">y =</span> <span class="dv">80</span>, <span class="st">&quot;This is Text&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">font =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="au-r-workshop_files/figure-html/unnamed-chunk-83-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The text is centered on the coordinates you provide. You can also provide vectors of coordinates and text to write different things at once.</p>
<p>The easiest way to add a straight line to a plot is with <code>abline()</code>. By default it takes two arguments: <code>a</code> and <code>b</code> which are the y-intercept and slope, respectively, e.g., <code>abline(0,1)</code> will draw a 1:1 line, as will <code>abline(c(0,1))</code>. You can also do <code>abline(h = 5)</code> to draw a horizontal line at 5 or <code>abline(v = 5)</code> to draw a vertical line at <code>5</code>.</p>
<p>You can see that the text is centered on the coordinates <code>x = 5</code> and <code>y = 80</code> using <code>abline()</code>:</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="ch2.html#cb162-1"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">80</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</span>
<span id="cb162-2"><a href="ch2.html#cb162-2"></a><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">5</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</span></code></pre></div>
<p><img src="au-r-workshop_files/figure-html/unnamed-chunk-85-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>If you accidentally add a plot element that you don’t want using a low-level plotting function, the only way to remove it is by re-running the high-level plotting function to start a new plot and adding only the objects you want. Try removing the “This is Text” text and the straight lines you drew with <code>abline()</code> from the plot displayed in your device.</p>
</div>
<div id="other-high-level-plotting-functions" class="section level2">
<h2><span class="header-section-number">2.3</span> Other High-Level Plotting Functions</h2>
<p>You have just seen the basics of making two-dimensional scatter plots and line plots. You will now explore other types of graphs you can make.</p>
<div id="the-bar-graph" class="section level3">
<h3><span class="header-section-number">2.3.1</span> The Bar Graph</h3>
<p>Another very common graph is a bar graph. R has a <code>barplot()</code> function, and again, it has lots of arguments. Here you will just make two common variations: single bars per group and multiple bars per group. Create a vector and plot it:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="ch2.html#cb163-1"></a>x1 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>)</span>
<span id="cb163-2"><a href="ch2.html#cb163-2"></a><span class="kw">barplot</span>(x1)</span></code></pre></div>
<p><img src="au-r-workshop_files/figure-html/unnamed-chunk-87-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Notice that there are no group names on the bars (if <code>x1</code> had names, there would be). You can add names by using the argument <code>names.arg</code>:</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="ch2.html#cb164-1"></a><span class="kw">barplot</span>(x1, <span class="dt">names.arg =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>))</span></code></pre></div>
<p>Add some more information by including two bars per group. Create another vector and combine it with the old data:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="ch2.html#cb165-1"></a>x2 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>)</span>
<span id="cb165-2"><a href="ch2.html#cb165-2"></a>x3 =<span class="st"> </span><span class="kw">rbind</span>(x1, x2)</span>
<span id="cb165-3"><a href="ch2.html#cb165-3"></a><span class="kw">barplot</span>(x3, <span class="dt">names.arg =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>), <span class="dt">beside =</span> T)</span></code></pre></div>
<p><img src="au-r-workshop_files/figure-html/unnamed-chunk-90-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>To add multiple bars per group, R needs a matrix like you just made. The <strong>columns</strong> store the heights of the bars that will be placed together in a group. Including the <code>beside = T</code> argument tells R to plot all groups as different bars as opposed to using a stacked bar graph.</p>
<p>Oftentimes, you will want to add error bars to a bar graph like this. To avoid digressing too much here, creating error bars is covered as a bonus topic (Section <a href="ch2.html#error-bars">2.11</a>).</p>
</div>
</div>
<div id="box-whisker" class="section level2">
<h2><span class="header-section-number">2.4</span> Box-and-Whisker Plots</h2>
<p>Box-and-whisker plots are a great way to visualize the spread of your data. All you need to make a box-and-whisker plot is a grouping variable (a factor, revisit Section <a href="ch1.html#factors">1.5</a> if you don’t remember what these are) and some continuous (i.e., numeric) data for each level of the factor. You will be using the <code>creel.csv</code> data set (see the <a href="index.html#data-sets">instructions</a> on acquiring and placing the data files in the appropriate location).</p>
<p>Read the data in and print a summary:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="ch2.html#cb166-1"></a>dat =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;../Data/creel.csv&quot;</span>)</span>
<span id="cb166-2"><a href="ch2.html#cb166-2"></a><span class="kw">summary</span>(dat)</span></code></pre></div>
<pre><code>##            fishery        hours       
##  Harvest       :100   Min.   :-1.150  
##  Non.Tournament:100   1st Qu.: 9.936  
##  Tournament    :100   Median :20.758  
##                       Mean   :26.050  
##                       3rd Qu.:43.896  
##                       Max.   :62.649</code></pre>
<p>This data set contains some simulated (i.e., fake) continuous and categorical data that represent 300 anglers who were creel surveyed<a href="exercise-solutions.html#fn20" class="footnote-ref" id="fnref20"><sup>20</sup></a>. In the data set, there are three categories (levels to the factor <code>fishery</code>) and the continuous variable is how many hours each angler fished this year. If you supply the generic <code>plot()</code> function with a continuous response (<code>y</code>) variable and a categorical predictor (<code>x</code>) variable, it will automatically assume you want to make a box-and-whisker plot:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="ch2.html#cb168-1"></a><span class="kw">plot</span>(<span class="dt">x =</span> dat<span class="op">$</span>fishery, <span class="dt">y =</span> dat<span class="op">$</span>hours)</span></code></pre></div>
<p><img src="au-r-workshop_files/figure-html/unnamed-chunk-94-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>In the box-and-whisker plot above, the heavy line is the median, the ends of the boxes are the 25<sup>th</sup> and 75<sup>th</sup> percentiles and the “whiskers” are the 2.5<sup>th</sup> and 97.5<sup>th</sup> percentiles. Any points that are outliers (i.e., fall outside of the whiskers) will be shown as points<a href="exercise-solutions.html#fn21" class="footnote-ref" id="fnref21"><sup>21</sup></a>.</p>
<p>It is worth introducing a shorthand syntax of typing the same command:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="ch2.html#cb169-1"></a><span class="kw">plot</span>(hours <span class="op">~</span><span class="st"> </span>fishery, <span class="dt">data =</span> dat)</span></code></pre></div>
<p>Instead of saying <code>plot(x = x.var, y = y.var)</code>, this expression says <code>plot(y.var ~ x.var)</code>. The <code>~</code> reads “as a function of”. By specifying the <code>data</code> argument, you no longer need to indicate where the variables <code>hours</code> and <code>fishery</code> are found. Many R functions have a <code>data</code> argument that works this same way. It is sometimes preferable to plot variables with this syntax because it is often less code and is also the format of R’s statistical equations<a href="exercise-solutions.html#fn22" class="footnote-ref" id="fnref22"><sup>22</sup></a>.</p>
</div>
<div id="histograms" class="section level2">
<h2><span class="header-section-number">2.5</span> Histograms</h2>
<p>Another way to show the distribution of a variable is with histograms. These figures show the relative frequencies of observations in different discrete bins. Make a histogram for the hours the surveyed tournament anglers fished this year:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="ch2.html#cb170-1"></a><span class="kw">hist</span>(dat<span class="op">$</span>hours[dat<span class="op">$</span>fishery <span class="op">==</span><span class="st"> &quot;Tournament&quot;</span>])</span></code></pre></div>
<p><img src="au-r-workshop_files/figure-html/unnamed-chunk-97-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Notice the subset that extracts hours fished for tournament anglers only before plotting.</p>
<p><code>hist()</code> automatically selects the number of bins based on the range and resolution of the data. You can specify how many evenly-sized bins you want to plot:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="ch2.html#cb171-1"></a><span class="co"># extract the hours for tournament anglers</span></span>
<span id="cb171-2"><a href="ch2.html#cb171-2"></a>t_hrs =<span class="st"> </span>dat<span class="op">$</span>hours[dat<span class="op">$</span>fishery <span class="op">==</span><span class="st"> &quot;Tournament&quot;</span>]</span>
<span id="cb171-3"><a href="ch2.html#cb171-3"></a></span>
<span id="cb171-4"><a href="ch2.html#cb171-4"></a><span class="co"># create the bin endpoints</span></span>
<span id="cb171-5"><a href="ch2.html#cb171-5"></a>nbins =<span class="st"> </span><span class="dv">20</span></span>
<span id="cb171-6"><a href="ch2.html#cb171-6"></a>breaks =<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="kw">min</span>(t_hrs), <span class="dt">to =</span> <span class="kw">max</span>(t_hrs), <span class="dt">length =</span> nbins <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb171-7"><a href="ch2.html#cb171-7"></a><span class="kw">hist</span>(t_hrs, <span class="dt">breaks =</span> breaks, <span class="dt">main =</span> <span class="st">&quot;Tournament&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</span></code></pre></div>
<p><img src="au-r-workshop_files/figure-html/unnamed-chunk-99-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="the-par-function" class="section level2">
<h2><span class="header-section-number">2.6</span> The <code>par()</code> Function</h2>
<p>If it bothers you that the axes are “floating”, you can fix this using this command:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="ch2.html#cb172-1"></a><span class="kw">par</span>(<span class="dt">xaxs =</span> <span class="st">&quot;i&quot;</span>, <span class="dt">yaxs =</span> <span class="st">&quot;i&quot;</span>, <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb172-2"><a href="ch2.html#cb172-2"></a><span class="kw">hist</span>(t_hrs, <span class="dt">breaks =</span> breaks, <span class="dt">main =</span> <span class="st">&quot;Tournament&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</span></code></pre></div>
<p><img src="au-r-workshop_files/figure-html/unnamed-chunk-100-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Here, you changed the graphical parameters of the graphics device by using the <code>par()</code> function. Once you change the settings in <code>par()</code>, they will remain that way until you start a new device.</p>
<p>The <code>par()</code> function is central to fine-tuning your graphics. Here, the <code>xaxs = "i"</code> and <code>yaxs = "i"</code> arguments essentially removed the buffer between the data and the axes. <code>par()</code> has options to change the size of the margins, add outer margins, change colors, etc. Some of the graphical parameters that can be passed to high- and low-level plotting functions (like those in Table <a href="ch2.html#tab:plot-arg-table-html">2.1</a>) can also be passed <code>par()</code>. Check out the help file (<code>?par</code>) to see everything it can do. If you want to start over with fresh <code>par()</code> settings, start a new device.</p>
<p>The <code>mar</code> argument controls how many lines of margin text are on each side of the plotting region: <code>mar[1]</code> is the bottom margin, <code>mar[2]</code> is left, <code>mar[3]</code> is top, and <code>mar[4]</code> is right. There is also <code>par(oma = c())</code> for outer margins. You can specify these in inch units instead of margin lines using the <code>mai</code> or <code>omi</code> arguments.</p>
</div>
<div id="new-temporary-devices" class="section level2">
<h2><span class="header-section-number">2.7</span> New Temporary Devices</h2>
<p>If you are using RStudio, then likely all of the plots you have made thus far have shown up in the lower right-hand corner or your RStudio window. You have been using RStudio’s built-in plotting device. If you want to open a new plotting device (maybe to put it on a separate monitor), you can use the following commands, depending on your operating system:</p>
<ul>
<li><strong>Windows Users</strong> – just run <code>windows()</code> to open up a new plotting device. It will become the active device.</li>
<li><strong>Mac Users</strong> – similarly, you can run <code>quartz()</code> to open a new device.</li>
<li><strong>Linux Users</strong> – similarly, just run <code>x11()</code>.</li>
</ul>
</div>
<div id="multi-panel-plots" class="section level2">
<h2><span class="header-section-number">2.8</span> Multi-panel Plots</h2>
<p>Sometimes you want to display more than one plot at a time. You can make a multi-panel plot which allows for multiple plotting regions to show up simultaneously within the same plotting device. First, you need to change the layout of the plotting region. The easiest way to set up the device for multi-panel plotting is by using the <code>mfrow</code> argument in the <code>par()</code> function.</p>
<p>Below, the code says “set up the graphical parameters so that there is 1 row and 3 columns of plotting regions within the device”. Every time you make a new plot, it will go in the next available plotting region (regions fill from left to right, and from top to bottom; use <code>mfcol</code> if you wish to fill columns before rows). Make 3 histograms, each that represents a different sector of the fishery:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="ch2.html#cb173-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb173-2"><a href="ch2.html#cb173-2"></a><span class="kw">sapply</span>(<span class="kw">levels</span>(dat<span class="op">$</span>fishery), <span class="cf">function</span>(f) {</span>
<span id="cb173-3"><a href="ch2.html#cb173-3"></a>  <span class="kw">hist</span>(dat<span class="op">$</span>hours[dat<span class="op">$</span>fishery <span class="op">==</span><span class="st"> </span>f], <span class="dt">main =</span> f, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb173-4"><a href="ch2.html#cb173-4"></a>})</span>
<span id="cb173-5"><a href="ch2.html#cb173-5"></a><span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">outer =</span> T, <span class="dt">line =</span> <span class="fl">1.5</span>, <span class="st">&quot;Frequency&quot;</span>, <span class="dt">cex =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="au-r-workshop_files/figure-html/unnamed-chunk-101-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Here, <code>sapply()</code> applied a user-defined function that plots a histogram for a given fishery type to each of the fishery types separately<a href="exercise-solutions.html#fn23" class="footnote-ref" id="fnref23"><sup>23</sup></a>, which allowed you to only need to type the <code>hist()</code> code once. Notice the <code>par(oma)</code> setting to add outer margins on the left and the <code>mtext()</code> function to add a common y-axis label to all the figures.</p>
<p>There are other ways to make multi-panel plots, however, they are beyond the scope of this introductory material. See <code>?layout</code> for details. With this function you can change the size of certain plots and make them have different shapes (i.e., some squares, some rectangles, etc.), but it takes some pretty involved (though not impossible, by any means) specification of how you want the device to be split up into regions.</p>
</div>
<div id="legends" class="section level2">
<h2><span class="header-section-number">2.9</span> Legends</h2>
<p>Oftentimes you will want to add a legend to a plot to help people interpret what it is showing. You can add legends to R plots using the low-level plotting function <code>legend()</code>. Add a legend to the bar plot you made earlier with two groups. First, re-make the plot by running the high-level <code>barplot()</code> function, but change the colors of the bars to be shades of blue and red. Once you have the plot made, add the legend:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="ch2.html#cb174-1"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb174-2"><a href="ch2.html#cb174-2"></a><span class="kw">barplot</span>(x3, <span class="dt">beside =</span> T, </span>
<span id="cb174-3"><a href="ch2.html#cb174-3"></a>        <span class="dt">names.arg =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>),</span>
<span id="cb174-4"><a href="ch2.html#cb174-4"></a>        <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;skyblue2&quot;</span>, <span class="st">&quot;tomato2&quot;</span>))</span>
<span id="cb174-5"><a href="ch2.html#cb174-5"></a><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Group 1&quot;</span>, <span class="st">&quot;Group 2&quot;</span>),</span>
<span id="cb174-6"><a href="ch2.html#cb174-6"></a>       <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;skyblue2&quot;</span>, <span class="st">&quot;tomato2&quot;</span>))</span></code></pre></div>
<p><img src="au-r-workshop_files/figure-html/unnamed-chunk-102-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The box can be removed using the <code>bty = "n"</code> argument and the size can be changed using <code>cex</code>. The position can be specified either with words (like above) or by using x-y coordinates.</p>
<p>Here is a more complex example:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="ch2.html#cb175-1"></a><span class="co"># 1) extract and sort the hours for two fisheries from fewest to most hours fished</span></span>
<span id="cb175-2"><a href="ch2.html#cb175-2"></a>t_hrs =<span class="st"> </span><span class="kw">sort</span>(dat<span class="op">$</span>hours[dat<span class="op">$</span>fishery <span class="op">==</span><span class="st"> &quot;Tournament&quot;</span>])</span>
<span id="cb175-3"><a href="ch2.html#cb175-3"></a>n_hrs =<span class="st"> </span><span class="kw">sort</span>(dat<span class="op">$</span>hours[dat<span class="op">$</span>fishery <span class="op">==</span><span class="st"> &quot;Non.Tournament&quot;</span>])</span>
<span id="cb175-4"><a href="ch2.html#cb175-4"></a></span>
<span id="cb175-5"><a href="ch2.html#cb175-5"></a><span class="co"># 2) make the plot: plot for t_hrs only, but ensure xlim covers both groups</span></span>
<span id="cb175-6"><a href="ch2.html#cb175-6"></a><span class="co"># set the margins: </span></span>
<span id="cb175-7"><a href="ch2.html#cb175-7"></a>  <span class="co"># 4 lines of margin space on bottom and left,</span></span>
<span id="cb175-8"><a href="ch2.html#cb175-8"></a>  <span class="co"># 1 on top and right</span></span>
<span id="cb175-9"><a href="ch2.html#cb175-9"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))  </span>
<span id="cb175-10"><a href="ch2.html#cb175-10"></a><span class="kw">plot</span>(<span class="dt">x =</span> t_hrs, <span class="dt">y =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(t_hrs),</span>
<span id="cb175-11"><a href="ch2.html#cb175-11"></a>     <span class="dt">type =</span> <span class="st">&quot;o&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">xlim =</span> <span class="kw">range</span>(<span class="kw">c</span>(t_hrs, n_hrs)),</span>
<span id="cb175-12"><a href="ch2.html#cb175-12"></a>     <span class="dt">xlab =</span> <span class="st">&quot;Hours Fished/Year&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Rank within Fishery Samples&quot;</span>,</span>
<span id="cb175-13"><a href="ch2.html#cb175-13"></a>     <span class="dt">las =</span> <span class="dv">1</span>)  <span class="co"># las = 1 says &quot;turn the y-axis tick labels to be horizontal&quot;</span></span>
<span id="cb175-14"><a href="ch2.html#cb175-14"></a><span class="co"># 3) add info for the other fishery</span></span>
<span id="cb175-15"><a href="ch2.html#cb175-15"></a><span class="kw">points</span>(<span class="dt">x =</span> n_hrs, <span class="dt">y =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n_hrs), <span class="dt">type =</span> <span class="st">&quot;o&quot;</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">pch =</span> <span class="dv">16</span>)</span>
<span id="cb175-16"><a href="ch2.html#cb175-16"></a><span class="co"># 4) add the legend</span></span>
<span id="cb175-17"><a href="ch2.html#cb175-17"></a><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Tournament&quot;</span>, <span class="st">&quot;Non-Tournament&quot;</span>), </span>
<span id="cb175-18"><a href="ch2.html#cb175-18"></a>       <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>), <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">16</span>), <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="au-r-workshop_files/figure-html/unnamed-chunk-103-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Notice that you need to be careful about the order of how you specify which <code>lty</code> and <code>pch</code> settings match up with the elements of the <code>legend</code> argument. In the <code>plot()</code> code, you specified that the <code>lty = 2</code> but didn’t specify what <code>pch</code> should be (it defaults to <code>1</code>). So when you put the “Tournament” group first in the <code>legend</code> argument vector, you must be sure to use the corresponding plotting codes. The first element of the <code>lty</code> argument matches up with the first element of <code>legend</code>, and so on. Note the other new plotting trick used in the code above: the rotation of y-axis tick mark labels using <code>las = 1</code>.</p>
</div>
<div id="exporting-plots" class="section level2">
<h2><span class="header-section-number">2.10</span> Exporting Plots</h2>
<p>There are two main ways to save static permanent copies of your R plots. The first is a quick-and-dirty point-and-click method that saves the plots in low-resolution. Because you have to point and click, this cannot be automated. The second method produces cleaner-looking high-resolution plots with code that can be embedded in your script, ensuring the same exact plot will be created each time the code is executed.</p>
<div id="click-save" class="section level3">
<h3><span class="header-section-number">2.10.1</span> Click Save</h3>
<ul>
<li>If your plot is in the RStudio built-in graphics device: Right above the plot, click <em>Export &gt; Save as Image</em>. Change the name, dimensions and file type.</li>
<li>If your plot is in a plotting device window (opened with <code>windows()</code> or <code>quartz()</code>: Simply go to <em>File &gt; Save</em>.</li>
</ul>
<p>All plots will be saved in the working directory by default. You can also just copy the plot to your clipboard (<em>File &gt; Copy to the clipboard &gt; bitmap</em>) and paste it where you want. You should save one of the plots you made in this Chapter using this approach.</p>
</div>
<div id="file-devices" class="section level3">
<h3><span class="header-section-number">2.10.2</span> Use a function to place plot in a new file</h3>
<p>If you are producing plots for a final report or publication, you want the output to be as clean-looking as possible and you want them to be fully reproducible so when something changes with your data or analysis in review, you can reproduce the same figure with the new results. You can save high-resolution plots using the following steps:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="ch2.html#cb176-1"></a><span class="co"># step 1: Make a pixels per inch object</span></span>
<span id="cb176-2"><a href="ch2.html#cb176-2"></a>ppi =<span class="st"> </span><span class="dv">600</span></span>
<span id="cb176-3"><a href="ch2.html#cb176-3"></a></span>
<span id="cb176-4"><a href="ch2.html#cb176-4"></a><span class="co"># step 2: Call the figure file creation function</span></span>
<span id="cb176-5"><a href="ch2.html#cb176-5"></a><span class="kw">png</span>(<span class="st">&quot;TestFigure.png&quot;</span>, <span class="dt">h =</span> <span class="dv">8</span> <span class="op">*</span><span class="st"> </span>ppi, <span class="dt">w =</span> <span class="dv">8</span> <span class="op">*</span><span class="st"> </span>ppi, <span class="dt">res =</span> ppi)</span>
<span id="cb176-6"><a href="ch2.html#cb176-6"></a></span>
<span id="cb176-7"><a href="ch2.html#cb176-7"></a><span class="co"># step 3: Run the plot </span></span>
<span id="cb176-8"><a href="ch2.html#cb176-8"></a><span class="co"># put all of your plotting code here (without windows())</span></span>
<span id="cb176-9"><a href="ch2.html#cb176-9"></a></span>
<span id="cb176-10"><a href="ch2.html#cb176-10"></a><span class="co"># step 4: Close the device</span></span>
<span id="cb176-11"><a href="ch2.html#cb176-11"></a><span class="kw">dev.off</span>()</span></code></pre></div>
<p>A file will be saved in your working directory containing the plot made by the code in step 3 above. The <code>ppi</code> object is pixels-per-inch. When you specify <code>h = 8 * ppi</code>, you are saying “make a plot with height equal to 8 inches”. There are similar functions to make PDFs, tiff files, jpegs, etc. If you use <code>pdf()</code>, simply specify <code>h</code> and <code>w</code> without the <code>ppi</code> and no <code>res</code> argument. You should save one of the plots you made in this Chapter using this approach.</p>
</div>
</div>
<div id="error-bars" class="section level2">
<h2><span class="header-section-number">2.11</span> Bonus Topic: Error Bars</h2>
<p>Rarely should you ever present estimates without some measure of uncertainty. The most common way for visualizing the uncertainty in an estimate is by using error bars, which can be added to an R plot using the lower-level function <code>arrows()</code>. To use <code>arrows()</code>, you need:</p>
<ul>
<li>Vectors of the <code>x</code> and <code>y</code> coordinates of the lower bound of the error bars</li>
<li>Vectors of the <code>x</code> and <code>y</code> coordinates of the upper bound of the error bars</li>
</ul>
<p>The syntax for <code>arrows()</code> is as follows: <code>arrows(x0, y0, x1, y1, ...)</code>, where <code>x0</code> and <code>y0</code> are the coordinates you are drawing “from” (e.g., lower limits) and the <code>x1</code> and <code>y1</code> are the coordinates you are drawing “to” (e.g., upper limits). The <code>...</code> represents other arguments to change how the error bars look. Calculate the means of the hours fished in each fishery sector and plot them. (If you don’t remember how <code>tapply()</code> works, revisit Section <a href="ch1.html#data-summaries">1.9</a>).</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="ch2.html#cb177-1"></a>x_bar =<span class="st"> </span><span class="kw">tapply</span>(dat<span class="op">$</span>hours, dat<span class="op">$</span>fishery, mean)</span>
<span id="cb177-2"><a href="ch2.html#cb177-2"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb177-3"><a href="ch2.html#cb177-3"></a><span class="kw">barplot</span>(x_bar)</span></code></pre></div>
<p><img src="au-r-workshop_files/figure-html/unnamed-chunk-105-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Say you want to add error bars that represent 95% confidence intervals on the mean. You can create a 95% confidence interval using this basic formula:</p>
<p><span class="math display" id="eq:ci">\[\begin{equation}
  \bar{x} \pm 1.96 * SE(\bar{x}),
\tag{2.1}
\end{equation}\]</span></p>
<p>where</p>
<p><span class="math display" id="eq:ci-mean">\[\begin{equation}
  \bar{x}=\frac{1}{n}\sum_i^n{x_i},
\tag{2.2}
\end{equation}\]</span></p>
<p>and</p>
<p><span class="math display" id="eq:ci-se">\[\begin{equation}
  SE(\bar{x})=\frac{\sqrt{\frac{\sum_i^n{(x_i - \bar{x})^2}}{n-1}}}{\sqrt{n}}
\tag{2.3}
\end{equation}\]</span></p>
<p>Begin by creating a function to calculate the standard error (<span class="math inline">\(SE(\bar{x})\)</span>):</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="ch2.html#cb178-1"></a>calc_se =<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb178-2"><a href="ch2.html#cb178-2"></a>  <span class="kw">sqrt</span>(<span class="kw">sum</span>((x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">length</span>(x)<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">length</span>(x))</span>
<span id="cb178-3"><a href="ch2.html#cb178-3"></a>}</span></code></pre></div>
<p>Then calculate the standard errors for each fishery sector:</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="ch2.html#cb179-1"></a>se =<span class="st"> </span><span class="kw">tapply</span>(dat<span class="op">$</span>hours, dat<span class="op">$</span>fishery, calc_se)</span></code></pre></div>
<p>Then calculate the lower and upper limits of your error bars:</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="ch2.html#cb180-1"></a>lwr =<span class="st"> </span>x_bar <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>se</span>
<span id="cb180-2"><a href="ch2.html#cb180-2"></a>upr =<span class="st"> </span>x_bar <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>se</span></code></pre></div>
<p>Then draw them on using the <code>arrows()</code> function:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="ch2.html#cb181-1"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb181-2"><a href="ch2.html#cb181-2"></a>mp =<span class="st"> </span><span class="kw">barplot</span>(x_bar, <span class="dt">ylim =</span> <span class="kw">range</span>(<span class="kw">c</span>(<span class="dv">0</span>, upr)))</span>
<span id="cb181-3"><a href="ch2.html#cb181-3"></a><span class="kw">arrows</span>(<span class="dt">x0 =</span> mp, <span class="dt">y0 =</span> lwr, <span class="dt">x1 =</span> mp, <span class="dt">y1 =</span> upr, <span class="dt">length =</span> <span class="fl">0.1</span>, <span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">code =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="au-r-workshop_files/figure-html/unnamed-chunk-109-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Notice four things:</p>
<ol style="list-style-type: decimal">
<li>The use of <code>mp</code> to specify the <code>x</code> coordinates. If you do <code>mp = barplot(...)</code>, <code>mp</code> will contain the <code>x</code> coordinates of the midpoint of each bar.</li>
<li><code>x0</code> and <code>x1</code> are the same: you want to have vertical bars, so these must be the same while <code>y1</code> and <code>y2</code> differ.</li>
<li>The use of <code>ylim = range(c(0, upr))</code>: you want the y-axis to show the full range of all the error bars.</li>
<li>The three arguments at the end of <code>arrows()</code>:
<ul>
<li><code>length = 0.1</code>: the length of the arrow heads, fiddle with this until you like it.</li>
<li><code>angle = 90</code>: the angle of the arrow heads, you want 90 here for the error bars.</li>
<li><code>code = 3</code>: indicates that arrow heads should be drawn on both ends of the arrow.</li>
</ul></li>
</ol>
<hr />
</div>
<div id="ex2" class="section level2 unnumbered">
<h2>Exercise 2</h2>
<p>For this exercise, you will be making a few plots and changing how they look to suit your taste. You will use a real data set (<code>sockeye.csv</code>, see the <a href="index.html#data-sets">instructions</a> on how to acquire the data files) from a sockeye salmon (<em>Oncorhynchus nerka</em>) population from the Columbia/Snake River system, obtained from <span class="citation">Kline and Flagg (<a href="#ref-sockeye-cite" role="doc-biblioref">2014</a>)</span>. This population spawns in Redfish Lake in Idaho, which feeds into the Salmon River, which is a tributary of the Snake River. In order to reach the lake, the sockeye salmon must successfully pass through a total of eight dams that have fish passage mechanisms in place. The Redfish Lake population is one of the most endangered sockeye populations in the U.S. and travels farther (1,448 km), higher (1,996 m), and is the southernmost breeding population of all sockeye populations in the world <span class="citation">(Kline and Flagg <a href="#ref-sockeye-cite" role="doc-biblioref">2014</a>)</span>. Given this uniqueness, a captive breeding program was initiated in 1991 to conserve the genes from this population. These data came from both hatchery-raised and wild fish and include average female spawner weight (g), fecundity (number of eggs), egg size (eggs/g), and % survival to the eyed-egg stage.</p>
<p><em>The solutions to this exercise are found at the end of this book (<a href="exercise-solutions.html#ex2-answers">here</a>). You are <strong>strongly recommended</strong> to make a good attempt at completing this exercise on your own and only look at the solutions when you are truly stumped.</em></p>
<ol style="list-style-type: decimal">
<li>Create a new R script called <code>Ex2.R</code> and save it in the <code>Chapter2</code> directory. Read in the data set <code>sockeye.csv</code>. Produce a basic summary of the data and take note of the data classes, missing values (<code>NA</code>), and the relative ranges for each variable.</li>
<li>Make a histogram of fish weights for only hatchery-origin fish. Set <code>breaks = 10</code> so you can see the distribution more clearly.</li>
<li>Make a scatter plot of the fecundity of females as a function of their body weight for wild fish only. Use whichever plotting character (<code>pch</code>) and color (<code>col</code>) you want. Change the main title and axes labels to reflect what they mean. Change the x-axis limits to be 600 to 3000 and the y-axis limits to be 0 to 3500. (<em>Hint: The <code>NAs</code> will not cause a problem. R will only use points where there are paired records for both <code>x</code> and <code>y</code> and ignore otherwise</em>).</li>
<li>Add points for the same variables, but from hatchery fish. Use a different plotting character and a different color.</li>
<li>Add a legend to the plot to differentiate between the two types of fish.<br />
</li>
<li>Make a multi-panel plot in a new window with box-and-whisker plots that compare (1) spawner weight, (2) fecundity, and (3) egg size between hatchery and wild fish. (<em>Hint: each comparison will be on its own panel</em>). Change the titles of each plot to reflect what you are comparing.</li>
<li>Save the plot as a <code>.png</code> file in your working directory with a file name of your choosing.</li>
</ol>
<div id="exercise-2-bonus" class="section level3 unnumbered">
<h3>EXERCISE 2 BONUS</h3>
<ol style="list-style-type: decimal">
<li>Make a bar plot comparing the mean survival to eyed-egg stage for each type of fish (hatchery and wild). Add error bars that represent 95% confidence intervals.</li>
<li>Change the names of each bar, the main plot title, and the y-axis title.<br />
</li>
<li>Adjust the margins so there are 2 lines on the bottom, 5 on the left, 2 on the top, and 1 on the right.</li>
</ol>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-sockeye-cite">
<p>Kline, Paul A., and Thomas A. Flagg. 2014. “Putting the Red Back in Redfish Lake, 20 Years of Progress Toward Saving the Pacific Northwest’s Most Endangered Salmon Population.” <em>Fisheries</em> 39 (11): 488–500. <a href="https://doi.org/10.1080/03632415.2014.966087">https://doi.org/10.1080/03632415.2014.966087</a>.</p>
</div>
<div id="ref-R-lattice">
<p>Sarkar, Deepayan. 2017. <em>Lattice: Trellis Graphics for R</em>. <a href="https://CRAN.R-project.org/package=lattice">https://CRAN.R-project.org/package=lattice</a>.</p>
</div>
<div id="ref-R-ggplot2">
<p>Wickham, Hadley, and Winston Chang. 2016. <em>Ggplot2: Create Elegant Data Visualisations Using the Grammar of Graphics</em>. <a href="https://CRAN.R-project.org/package=ggplot2">https://CRAN.R-project.org/package=ggplot2</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch3.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["au-r-workshop.docx"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
